<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Поток с ограничениями</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 22:54<br>редактировано: 10 Jun 2008 22:55</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="flow_with_limits.html#" id="contents-hide">[скрыть]</a><a href="flow_with_limits.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Нахождение потока в графе, в котором у каждого ребра указано минимальное и максимальное значение потока</h1>

<p>Пусть дан граф G, в котором для каждого ребра помимо пропускной способности (максимального значения потока вдоль этого ребра) указано и минимальное значение потока, который должен проходить по этому ребру.</p>
<p>Здесь мы рассмотрим две задачи: 1) требуется найти произвольный поток, удовлетворяющий всем ограничениям, и 2) требуется найти минимальный поток, удовлетворяющий всем ограничениям.</p>
<h2>Решение задачи 1</h2>
<p>Обозначим через L<sub>i</sub> минимальную величину потока, которая может проходить по i-му ребру, а через R<sub>i</sub> - его максимальная величина.</p>
<p>Произведём в графе следующие <b>изменения</b>. Добавим новый исток S' и сток T'. Рассмотрим все рёбра, у которых L<sub>i</sub> отлично от нуля. Пусть i - номер такого ребра. Пусть концы этого ребра (ориентированного) - это вершины A<sub>i</sub> и B<sub>i</sub>. Добавим ребро (S', B<sub>i</sub>), у которого L = 0, R = L<sub>i</sub>, добавим ребро (A<sub>i</sub>, T'), у которого L = 0, R = L<sub>i</sub>, а у самого i-го ребра положим R<sub>i</sub> = R<sub>i</sub> - L<sub>i</sub>, а L<sub>i</sub> = 0. Наконец, добавим в граф ребро из T в S (старых стока и истока), у которого L = 0, R = INF.</p>
<p>После выполнения этих преобразований все рёбра графа будут иметь L<sub>i</sub> = 0, т.е. мы свели эту задачу к обычной задаче нахождения максимального потока (но уже в модифицированном графе с новыми истоком и стоком) (чтобы понять, почему именно максимального - читайте нижеследующее объяснение).</p>
<p>Корректность этих преобразований понять сложнее. Неформальное <b>объяснение</b> такое. Каждое ребро, у которого L<sub>i</sub> отлично от нуля, мы заменяем на два ребра: одно с пропускной способностью L<sub>i</sub>, а другое - с R<sub>i</sub>-L<sub>i</sub>. Нам требуется найти поток, который бы обязательно насытил первое ребро из этой пары (т.е. поток вдоль этого ребра должен быть равен L<sub>i</sub>); второе ребро нас волнует меньше - поток вдоль него может быть любым, лишь бы он не превосходил его пропускной способности. Итак, нам требуется найти такой поток, который бы обязательно насытил некоторое множество рёбер. Рассмотрим каждое такое ребро, и выполним такую операцию: подведём к его концу ребро из нового истока S', подведём ребро из его начала к стоку T', само ребро удалим, а из старого стока T к старому истоку S проведём ребро бесконечной пропускной способности. Этими действиями мы проимитируем тот факт, что это ребро насыщено - из ребра будет вытекать L<sub>i</sub> единиц потока (мы имитируем это с помощью нового истока, который подаёт на конец ребра нужное количество потока), а втекать в него будет опять же L<sub>i</sub> единиц потока (но вместо ребра этот поток попадёт в новый сток). Поток из нового истока протекает по одной части графа, дотекает до старого стока T, из него протекает в старый исток S, затем течёт по другой части графа, и наконец приходит к началу нашего ребра, и попадает в новый сток T'. Т.е., если мы найдём в этом модифицированном графе максимальный поток (и в сток попадёт нужное количество потока, т.е. сумма всех значений L<sub>i</sub> - иначе величина потока будет меньше, и ответа попросту не существует), то мы одновременно найдём поток в исходном графе, который будет удовлетворять все ограничениям минимума, и, разумеется, всем ограничениям максимума.</p>
<h2>Решение задачи 2</h2>
<p>Заметим, что по ребру из старого стока в старый исток с пропускной способностью INF протекает весь старый поток, т.е. пропускная способность этого ребра влияет на величину старого потока. При достаточно большой величине пропускной способности этого ребра (т.е. INF) старый поток ничем не ограничен. Если мы будем уменьшать пропускную способность, то и, начиная с некоторого момента, будет уменьшаться и величина старого потока. Но при слишком малом значении величина потока станет недостаточной, чтобы обеспечить выполнение ограничений (на минимальное значение потока вдоль рёбер). Очевидно, здесь можно применить <b>бинарный поиск по значению INF</b>, и найти такое её наименьшее значение, при котором все ограничения ещё будут удовлетворяться, но старый поток будет иметь минимальное значение.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>