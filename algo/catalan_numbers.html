<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Числа Каталана</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 11:16<br>редактировано: 2 May 2009 17:24</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="catalan_numbers.html#" id="contents-hide">[скрыть]</a><a href="catalan_numbers.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Числа Каталана</h1><p>Числа Каталана &mdash; числовая последовательность, встречающаяся в удивительном числе комбинаторных задач.<p>Эта последовательность названа в честь бельгийского математика Каталана (Catalan), жившего в 19 веке, хотя на самом деле она была известна ещё Эйлеру (Euler), жившему за век до Каталана.<p><h2 style="padding-top:40px;">Последовательность</h2><p>Первые несколько чисел Каталана <img class=tex src="../tex2png/cache/b5a58559e996da876bf010d9311f4ba0.png" alt="C_n"> (начиная с нулевого):<p class=formula><img class=tex src="../tex2png/cache/510d31f07f8c5da7234e27190c07e86a.png" alt=" 1,\ 1,\ 2,\ 5,\ 14,\ 42,\ 132,\ 429,\ 1430,\ \ldo[...]"></p><p>Числа Каталана встречаются в большом количестве задач комбинаторики. <b><img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-ое число Каталана</b> &mdash; это:<ul><li>Количество корректных скобочных последовательностей, состоящих из <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> открывающих и <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> закрывающих скобок.<li>Количество корневых бинарных деревьев с <img class=tex src="../tex2png/cache/a7f8de3dd9b0da0eb8ed96689169566e.png" alt="n+1"> листьями (вершины не пронумерованы).<li>Количество способов полностью разделить скобками <img class=tex src="../tex2png/cache/a7f8de3dd9b0da0eb8ed96689169566e.png" alt="n+1"> множитель.<li>Количество триангуляций выпуклого <img class=tex src="../tex2png/cache/522609455dd335d439d0ed81eb0fb3e2.png" alt="n+2">-угольника (т.е. количество разбиений многоугольника непересекающимися диагоналями на треугольники).<li>Количество способов соединить <img class=tex src="../tex2png/cache/02f3339bd527ea60f4b8a5fcb94023f1.png" alt="2n"> точек на окружности <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> непересекающимися хордами.<li>Количество неизоморфных полных бинарных деревьев с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> внутренними вершинами (т.е. имеющими хотя бы одного сына).<li>Количество монотонных путей из точки <img class=tex src="../tex2png/cache/87dba79bd9c5a311fe3dea3fd8e20560.png" alt="(0,0)"> в точку <img class=tex src="../tex2png/cache/882441a2d4a9b565f5e48eaac78c49f5.png" alt="(n,n)"> в квадратной решётке размером <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n">, не поднимающихся над главной диагональю.<li>Количество перестановок длины <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, которые можно отсортировать стеком (можно показать, что перестановка является сортируемой стеком тогда и только тогда, когда нет таких индексов <img class=tex src="../tex2png/cache/fdbd1ce1471fb5c025c56ee0fb31f29e.png" alt="i<j<k">, что <img class=tex src="../tex2png/cache/5b5f00288b4767276eab83287c9e9c38.png" alt="a_k<a_i<a_j">).<li>Количество непрерывных разбиений множества из <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> элементов (т.е. разбиений на непрерывные блоки).<li>Количество способов покрыть лесенку <img class=tex src="../tex2png/cache/703638b38b37c914ea52b0b834b8fb1a.png" alt="1 \ldots n"> с помощью <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> прямоугольников (имеется в виду фигура, состоящая из <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> столбцов, <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый из которых имеет высоту <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">).</ul><p><h2 style="padding-top:40px;">Вычисление</h2><p>Имеется две формулы для чисел Каталана: рекуррентная и аналитическая. Поскольку мы считаем, что все приведённые выше задачи эквивалентны, то для доказательства формул мы будем выбирать ту задачу, с помощью которой это сделать проще всего.<p><h3 style="padding-top:15px;">Рекуррентная формула</h3><p><p class=formula><img class=tex src="../tex2png/cache/fb1d27d3d7c54b06a1895e8be0103b1f.png" alt=" C_n = \sum_{k=0}^{n-1} C_k C_{n-1-k} "></p><p>Рекуррентную формулу легко вывести из задачи о правильных скобочных последовательностях.<p>Самой левой открывающей скобке l соответствует определённая закрывающая скобка r, которая разбивает формулу две части, каждая из которых в свою очередь является правильной скобочной последовательностью. Поэтому, если мы обозначим <img class=tex src="../tex2png/cache/2adde5c216a31f52826fbda1b547805a.png" alt="k = r-l-1">, то для любого фиксированного <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r"> будет ровно <img class=tex src="../tex2png/cache/4aa0ee28d71c3f889e8849e63201ab15.png" alt="C_k C_{n-1-k} "> способов. Суммируя это по всем допустимым <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">, мы и получаем рекуррентную зависимость на <img class=tex src="../tex2png/cache/b5a58559e996da876bf010d9311f4ba0.png" alt="C_n">.<p><h3 style="padding-top:15px;">Аналитическая формула</h3><p><p class=formula><img class=tex src="../tex2png/cache/10ec54fa210d7eb7fcf78a25824015c3.png" alt=" C_n = \frac{1}{n+1} C_{2n}^{n} "></p><p>(здесь через <img class=tex src="../tex2png/cache/c9a0f1213ba475c08fdecd5df29a7fdd.png" alt="C_n^k"> обозначен, как обычно, <a href="binomial_coeff.html">биномиальный коэффициент</a>).<p>Эту формулу проще всего вывести из задачи о монотонных путях. Общее количество монотонных путей в решётке размером <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n"> равно <img class=tex src="../tex2png/cache/1758f49e7c3a3dbb20bf43b15feac02b.png" alt="C_{2n}^{n}">. Теперь посчитаем количество монотонных путей, пересекающих диагональ. Рассмотрим какой-либо из таких путей, и найдём первое ребро, которое стоит выше диагонали. Отразим относительно диагонали весь путь, идущий после этого ребра. В результате получим монотонный путь в решётке <img class=tex src="../tex2png/cache/ff17cc1462e59236d0f91d22114add43.png" alt="(n-1) \times (n+1)">. Но, с другой стороны, любой монотонный путь в решётке <img class=tex src="../tex2png/cache/ff17cc1462e59236d0f91d22114add43.png" alt="(n-1) \times (n+1)"> обязательно пересекает диагональ, следовательно, он получен как раз таким способом из какого-либо (причём единственного) монотонного пути, пересекающего диагональ, в решётке <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n">. Монотонных путей в решётке <img class=tex src="../tex2png/cache/ff17cc1462e59236d0f91d22114add43.png" alt="(n-1) \times (n+1)"> имеется <img class=tex src="../tex2png/cache/1f124567c87f55fed1a5f0e9f4c262cc.png" alt="C_{2n}^{n-1}">. В результате получаем формулу:<p><p class=formula><img class=tex src="../tex2png/cache/c39feaac0041018524972b30bfd0b9ed.png" alt=" C_n = C_{2n}^{n} - C_{2n}^{n-1} = \frac{1}{n+1} C[...]"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>