<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Код Грея</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 18:05<br>редактировано: 24 Aug 2011 1:41</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="gray_code.html#" id="contents-hide">[скрыть]</a><a href="gray_code.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Код Грея </h1><p><p><h2 style="padding-top:40px;"> Определение </h2><p>Кодом Грея называется такая система нумерования неотрицательных чисел, когда коды двух соседних чисел отличаются ровно в одном бите.<p>Например, для чисел длины 3 бита имеем такую последовательность кодов Грея: <img class=tex src="../tex2png/cache/a1c68a593f3d379e318ff36ada9bc0fd.png" alt="000">, <img class=tex src="../tex2png/cache/96fe71a795b01a20a08b8955c68fb348.png" alt="001">, <img class=tex src="../tex2png/cache/3f4cc5b2ab8a61a594cd853c044f2d1d.png" alt="011">, <img class=tex src="../tex2png/cache/6bac1d5756b90f2cd03f7c4f275f43fe.png" alt="010">, <img class=tex src="../tex2png/cache/73d446d9962b8c5e209804dd31c552cf.png" alt="110">, <img class=tex src="../tex2png/cache/be8b914ccc515d56400b0ada2f4236d1.png" alt="111">, <img class=tex src="../tex2png/cache/3e9b2492899afa13e729ef0d82f9e857.png" alt="101">, <img class=tex src="../tex2png/cache/42eebf03554591becb9bdde682ba1fbf.png" alt="100">. Например, <img class=tex src="../tex2png/cache/583c2d4969260b697e57ece7a202954c.png" alt="G(4)=6">.<p>Этот код был изобретен Фрэнком Грэем (Frank Gray) в 1953 году.<p><p><h2 style="padding-top:40px;"> Нахождение кода Грея </h2><p>Рассмотрим биты числа <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> и биты числа <img class=tex src="../tex2png/cache/b51e8d81f1cb0aacb1766c0dc188fe92.png" alt="G(n)">. Заметим, что <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый бит <img class=tex src="../tex2png/cache/b51e8d81f1cb0aacb1766c0dc188fe92.png" alt="G(n)"> равен единице только в том случае, когда <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый бит <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> равен единице, а <img class=tex src="../tex2png/cache/4ec332d2c63d7695c3b676e8e6dd9881.png" alt="i+1">-ый бит равен нулю, или наоборот (<img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый бит равен нулю, а <img class=tex src="../tex2png/cache/4ec332d2c63d7695c3b676e8e6dd9881.png" alt="i+1">-ый равен единице). Таким образом, имеем: <img class=tex src="../tex2png/cache/1890ceadab7fa3179ac10d2c0f8fa7bd.png" alt="G(n) = n \oplus (n>>1)">:<p><pre class="notranslate cpp"><span class="kw4">int</span> g <span class="br0">&#40;</span><span class="kw4">int</span> n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">return</span> n <span class="sy3">^</span> <span class="br0">&#40;</span>n <span class="sy1">&gt;&gt;</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p><p><h2 style="padding-top:40px;"> Нахождение обратного кода Грея </h2><p>Требуется по коду Грея <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g"> восстановить исходное число <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">.<p>Будем идти от старших битов к младшим (пусть самый младший бит имеет номер 1, а самый старший &mdash; <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">). Получаем такие соотношения между битами <img class=tex src="../tex2png/cache/015908c458a90fd729e3b6a927029ce1.png" alt="n_i"> числа <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> и битами <img class=tex src="../tex2png/cache/01bfe703fcd356724c90c91209904c97.png" alt="g_i"> числа <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">:<p><p class=formula><img class=tex src="../tex2png/cache/8fa6aef599839a65ab32ae698a2c5e0f.png" alt=" n_k = g_k, "><br><img class=tex src="../tex2png/cache/b1231fc74ab970e41d2b449c020aefef.png" alt=" n_{k-1} = g_{k-1} \oplus n_k = g_k \oplus g_{k-1}[...]"><br><img class=tex src="../tex2png/cache/4c143efc3131772e7dd548990aa12ff7.png" alt=" n_{k-2} = g_{k-2} \oplus n_{k-1} = g_k \oplus g_{[...]"><br><img class=tex src="../tex2png/cache/0a8b5604183f3ae1d6ac500b3f6a5561.png" alt=" n_{k-3} = g_{k-3} \oplus n_{k-2} = g_k \oplus g_{[...]"><br><img class=tex src="../tex2png/cache/3ee865b5cc661e7f1c429bc56246d9cf.png" alt=" \ldots "></p><p>В виде программного кода это проще всего записать так:<p><pre class="notranslate cpp"><span class="kw4">int</span> rev_g <span class="br0">&#40;</span><span class="kw4">int</span> g<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">int</span> n <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw1">for</span> <span class="br0">&#40;</span><span class="sy4">;</span> g<span class="sy4">;</span> g<span class="sy1">&gt;&gt;=</span><span class="nu0">1</span><span class="br0">&#41;</span>
		n <span class="sy3">^</span><span class="sy1">=</span> g<span class="sy4">;</span>
	<span class="kw1">return</span> n<span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p><p><h2 style="padding-top:40px;"> Применения </h2><p>Коды Грея имеют несколько применений в различных областях, иногда достаточно неожиданных:<p><ul><p><li><img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-битный код Грея соответствует гамильтонову циклу по <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-мерному кубу.<p><li>В технике, коды Грея используются для <b>минимизации ошибок</b> при преобразовании аналоговых сигналов в цифровые (например, в датчиках). В частности, коды Грея и были открыты в связи с этим применением.<p><li>Коды Грея применяются в решении задачи о <b>Ханойских башнях</b>.<p>Пусть <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> &mdash; количество дисков. Начнём с кода Грея длины <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, состоящего из одних нулей (т.е. <img class=tex src="../tex2png/cache/95cf1ce796c642b37c2625a6aece607f.png" alt="G(0)">), и будем двигаться по кодам Грея (от <img class=tex src="../tex2png/cache/ced46a9a3ded554bdd8ba98725d3723d.png" alt="G(i)"> переходить к <img class=tex src="../tex2png/cache/6a0d439fc257f827ecc33336321703f2.png" alt="G(i+1)">). Поставим в соответствие каждому <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ому биту текущего кода Грея <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый диск (причём самому младшему биту соответствует наименьший по размеру диск, а самому старшему биту &mdash; наибольший). Поскольку на каждом шаге изменяется ровно один бит, то мы можем понимать изменение бита <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> как перемещение <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-го диска. Заметим, что для всех дисков, кроме наименьшего, на каждом шаге имеется ровно один вариант хода (за исключением стартовой и финальной позиций). Для наименьшего диска всегда имеется два варианта хода, однако имеется стратегия выбора хода, всегда приводящая к ответу: если <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> нечётно, то последовательность перемещений наименьшего диска имеет вид <img class=tex src="../tex2png/cache/e7627ae925f7e47200f11730751ab3b5.png" alt="f \rightarrow t \rightarrow r \rightarrow f \rightarrow t \rightarrow r \rightarrow \ldots"> (где <img class=tex src="../tex2png/cache/51571962341478345d68f00e6a1702dc.png" alt="f"> &mdash; стартовый стержень, <img class=tex src="../tex2png/cache/668c0ed766381807a81b9a534a4a70ce.png" alt="t"> &mdash; финальный стержень, <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r"> &mdash; оставшийся стержень), а если <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> чётно, то <img class=tex src="../tex2png/cache/5384331959d0904f865ea87364333dc5.png" alt="f \rightarrow r \rightarrow t \rightarrow f \rightarrow r \rightarrow t \rightarrow \ldots">.<p><li>Коды Грея также находят применение в теории <b>генетических алгоритмов</b>.<p></ul><p><p><h2 style="padding-top:40px;"> Задачи в online judges </h2><p>Список задач, которые можно сдать, используя коды Грея:<p><ul><p><li><a href="http://acm.sgu.ru/problem.php?contest=0&problem=249">SGU #249 <b>"Matrix"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: средняя]</a><p></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>