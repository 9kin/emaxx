<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Нахождение уравнения прямой для отрезка</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 10:14<br>редактировано: 24 Aug 2011 12:06</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="segment_to_line.html#" id="contents-hide">[скрыть]</a><a href="segment_to_line.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Нахождение уравнения прямой для отрезка </h1><p>Задача &mdash; по заданным координатам конца отрезка построить прямую, проходящую через него.<p>Мы считаем, что отрезок невырожден, т.е. имеет длину больше нуля (иначе, понятно, через него проходит бесконечно много различных прямых).<p><p><h2 style="padding-top:40px;"> Двумерный случай </h2><p>Пусть дан отрезок <img class=tex src="../tex2png/cache/6d9f9b0c0a3277928730ec4132c84109.png" alt="PQ">, т.е. известны координаты его концов <img class=tex src="../tex2png/cache/1cefa0f4337de77d4aa39863721c84ab.png" alt="P_x">, <img class=tex src="../tex2png/cache/f0b07189d3063831659527324a1ff95b.png" alt="P_y">, <img class=tex src="../tex2png/cache/d6d31cdf6667784e8669839fa70ebb3f.png" alt="Q_x">, <img class=tex src="../tex2png/cache/c844e852bf1e9c2dce421024fbad0608.png" alt="Q_y">.<p>Требуется построить <b>уравнение прямой на плоскости</b>, проходящей через этот отрезок, т.е. найти коэффициенты <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">, <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">, <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> в уравнении прямой:<p><p class=formula><img class=tex src="../tex2png/cache/e7908dd2ce7fe8da501cb5e015e08822.png" alt=" A x + B y + C = 0. "></p><p>Заметим, что искомых троек <img class=tex src="../tex2png/cache/78ea80d400cf2d32ab52dcab00c77883.png" alt="(A,B,C)">, проходящих через заданный отрезок, <b>бесконечно много</b>: можно умножить все три коэффициента на произвольное ненулевое число и получить ту же самую прямую. Следовательно, наша задача &mdash; найти одну из таких троек.<p>Нетрудно убедиться (подстановкой этих выражений и координат точек <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> и <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q"> в уравнение прямой), что подходит следующий набор коэффициентов:<p><p class=formula><img class=tex src="../tex2png/cache/da93baf6891079b8588541f287c1c702.png" alt=" A = P_y - Q_y, "><br><img class=tex src="../tex2png/cache/aebd2942d44adf2145a29acdbbf16a4b.png" alt=" B = Q_x - P_x, "><br><img class=tex src="../tex2png/cache/0ba9f1c726c00b153299217359bafc87.png" alt=" C = - A P_x - B P_y. "><p></p><p><h3 style="padding-top:15px;"> Целочисленный случай </h3><p>Важным преимуществом такого способа построения прямой является то, что если координаты концов были целочисленными, то и полученные коэффициенты также будут <b>целочисленными</b>. В некоторых случаях это позволяет производить геометрические операции, вообще не прибегая к вещественным числам.<p>Однако есть и небольшой недостаток: для одной и той же прямой могут получаться разные тройки коэффициентов. Чтобы избежать этого, но не уходить от целочисленных коэффициентов, можно применить следующий приём, часто называемый <b>нормированием</b>. Найдём <a href="euclid_algorithm.html">наибольший общий делитель</a> чисел <img class=tex src="../tex2png/cache/4341a635090cd6e8aef27f1db8e54bb7.png" alt="|A|">, <img class=tex src="../tex2png/cache/7415c4974c174eb66afe3056e0d057d1.png" alt="|B|">, <img class=tex src="../tex2png/cache/0f6eb858ee092e47cdbb969ab1eb1ad2.png" alt="|C|">, поделим на него все три коэффициента, а затем произведём нормировку знака: если <img class=tex src="../tex2png/cache/615f3079347e04a98b8144881577463d.png" alt="A<0"> или <img class=tex src="../tex2png/cache/ae42211d4bc094148cad0aa29d60a73a.png" alt="A=0, B<0">, то умножим все три коэффициента на <img class=tex src="../tex2png/cache/fc5f9135f75a6da19325dc3822484bbd.png" alt="-1">. В итоге мы придём к тому, что для одинаковых прямых будут получаться одинаковые тройки коэффициентов, что позволит легко проверять прямые на равенство.<p><p><h3 style="padding-top:15px;"> Вещественнозначный случай </h3><p>При работе с вещественными числами следует всегда помнить о погрешностях.<p>Коэффициенты <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> и <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> получаются у нас порядка исходных координат, коэффициент <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> &mdash; уже порядка квадрата от них. Это уже может быть достаточно большими числами, а, например, при <a href="lines_intersection.html">пересечении прямых</a> они станут ещё больше, что может привести к большим ошибкам округления уже при исходных координатах порядка <img class=tex src="../tex2png/cache/87cd2dd5e8aaf5f20684a6cbe15dab33.png" alt="10^3">.<p>Поэтому при работе с вещественными числами желательно производить так называемую <b>нормировку</b> прямой: а именно, делать коэффициенты такими, чтобы <img class=tex src="../tex2png/cache/dfd3971b6278ba0e0786d151fd027d49.png" alt="A^2 + B^2 = 1">. Для этого надо вычислить число <img class=tex src="../tex2png/cache/6008744c03ea12dc6aa14f3594eb9f61.png" alt="Z">:<p><p class=formula><img class=tex src="../tex2png/cache/34730d636d24e48bff486f9e918d7f15.png" alt=" Z = \sqrt{ A^2 + B^2 }, "></p><p>и разделить все три коэффициента <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">, <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">, <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> на него.<p>Тем самым, порядок коэффициентов <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> и <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> уже не будет зависеть от порядка входных координат, а коэффициент <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> будет того же порядка, что и входные координаты. На практике это приводит к значительному улучшению точности вычислений.<p>Наконец, упомянем о <b>сравнении</b> прямых &mdash; ведь после такой нормировки для одной и той же прямой могут получаться только две тройки коэффициентов: с точностью до умножения на <img class=tex src="../tex2png/cache/fc5f9135f75a6da19325dc3822484bbd.png" alt="-1">. Соответственно, если мы произведём дополнительную нормировку с учётом знака (если <img class=tex src="../tex2png/cache/35023361999a4ad302da0a0bdc611a58.png" alt="A<-\varepsilon"> или <img class=tex src="../tex2png/cache/147cd0d8a17d1584426e8a915a075da4.png" alt="|A|<\varepsilon, B<-\varepsilon">, то умножать на <img class=tex src="../tex2png/cache/fc5f9135f75a6da19325dc3822484bbd.png" alt="-1">), то получающиеся коэффициенты будут уникальными.<p><p><h2 style="padding-top:40px;"> Трёхмерный и многомерный случай </h2><p>Уже в трёхмерном случае <b>нет простого уравнения</b>, описывающего прямую (её можно задать как пересечение двух плоскостей, т.е. систему двух уравнений, но это неудобный способ).<p>Следовательно, в трёхмерном и многомерном случаях мы должны пользоваться <b>параметрическим способом задания прямой</b>, т.е. в виде точки <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> и вектора <img class=tex src="../tex2png/cache/9530057de1d317139fef00be858ff2f1.png" alt="v">:<p><p class=formula><img class=tex src="../tex2png/cache/d613a14a4aa8eff8964783d6abe67b67.png" alt=" p + v t, ~~~ t \in \cal{R}. "></p><p>Т.е. прямая &mdash; это все точки, которые можно получить из точки <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> прибавлением вектора <img class=tex src="../tex2png/cache/9530057de1d317139fef00be858ff2f1.png" alt="v"> с произвольным коэффициентом.<p><b>Построение</b> прямой в параметрическом виде по координатам концов отрезка &mdash; тривиально, мы просто берём один конец отрезка за точку <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p">, а вектор из первого до второго конца &mdash; за вектор <img class=tex src="../tex2png/cache/9530057de1d317139fef00be858ff2f1.png" alt="v">.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>