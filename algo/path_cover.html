<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Покрытие путями ориентированного ациклического графа</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 2 Mar 2009 17:45<br>редактировано: 31 Dec 2011 1:57</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="path_cover.html#" id="contents-hide">[скрыть]</a><a href="path_cover.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Покрытие путями ориентированного ациклического графа</h1><p>Дан ориентированный ациклический граф <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G">. Требуется покрыть его наименьшим числом путей, т.е. найти наименьшее по мощности множество непересекающихся по вершинам простых путей, таких, что каждая вершина принадлежит какому-либо пути.<p><p><h2 style="padding-top:40px;">Сведение к двудольному графу</h2><p>Пусть дан граф <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершинами. Построим соответствующий ему двудольный граф <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H"> стандартным образом, т.е.: в каждой доле графа <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H"> будет по <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершин, обозначим их через <img class=tex src="../tex2png/cache/ef875bf5bad8370d4f3bbe3c740d3dd3.png" alt="a_i"> и <img class=tex src="../tex2png/cache/0993821d823b5b792321f13c90efa683.png" alt="b_i"> соответственно. Тогда для каждого ребра <img class=tex src="../tex2png/cache/51cfd6978cf748de89f241c0db487087.png" alt="(i, j)"> исходного графа <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> проведём соответствующее ребро <img class=tex src="../tex2png/cache/837d27c5dc6714d21347e9804709220d.png" alt="(a_i, b_j)">.<p>Каждому ребру <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> соответствует одно ребро <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H">, и наоборот. Если мы рассмотрим в <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> любой путь <img class=tex src="../tex2png/cache/013747b2ee0d6b1d390802944ca77849.png" alt="P = (v_1, v_2, \ldots, v_k)">, то ему ставится в соответствие набор рёбер <img class=tex src="../tex2png/cache/ede65309f83ea7b1f8406260a69054d5.png" alt="(a_{v_1}, b_{v_2}), (a_{v_2}, b_{v_3}), ..., (a_{v_{k-1}}, b_{v_k}) ">.<p>Более просто для понимания будет, если мы добавим "обратные" рёбра, т.е. образуем граф <img class=tex src="../tex2png/cache/04ee2212ca394e0ea72a519431459992.png" alt="\overline H"> из графа <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H"> добавлением рёбер вида <img class=tex src="../tex2png/cache/a3543288f0c36b198e897ea3895d3388.png" alt="(b_i, a_i), i=1 \ldots N">. Тогда пути <img class=tex src="../tex2png/cache/013747b2ee0d6b1d390802944ca77849.png" alt="P = (v_1, v_2, \ldots, v_k)"> в графе <img class=tex src="../tex2png/cache/04ee2212ca394e0ea72a519431459992.png" alt="\overline H"> будет соответствовать путь <img class=tex src="../tex2png/cache/4f3e27e3fbb89bd84697c7d2eff1db2f.png" alt="\overline Q = (a_{v_1}, b_{v_2}, a_{v_2}, b_{v_3}, ..., a_{v_{k-1}}, b_{v_k})">.<p>Обратно, рассмотрим любой путь <img class=tex src="../tex2png/cache/d2b03776db0b01f0ce7da2d703f29d30.png" alt="\overline Q"> в графе <img class=tex src="../tex2png/cache/04ee2212ca394e0ea72a519431459992.png" alt="\overline H">, начинающийся в первой доле и заканчивающийся во второй доле. Очевидно, <img class=tex src="../tex2png/cache/d2b03776db0b01f0ce7da2d703f29d30.png" alt="\overline Q"> снова будет иметь вид <img class=tex src="../tex2png/cache/4f3e27e3fbb89bd84697c7d2eff1db2f.png" alt="\overline Q = (a_{v_1}, b_{v_2}, a_{v_2}, b_{v_3}, ..., a_{v_{k-1}}, b_{v_k})">, и ему можно поставить в соответствие в графе <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> путь <img class=tex src="../tex2png/cache/013747b2ee0d6b1d390802944ca77849.png" alt="P = (v_1, v_2, \ldots, v_k)">. Однако здесь есть одна тонкость: <img class=tex src="../tex2png/cache/f52a552b90a1d758e03e5ac6bbd074ef.png" alt="v_1"> могло совпадать с <img class=tex src="../tex2png/cache/b4225c2ca645950dfacd6022dffec530.png" alt="v_k">, поэтому путь <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> получился бы циклом. Однако по условию граф <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> ациклический, поэтому это вообще невозможно (это единственное место, где используется ацикличность графа <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G">; тем не менее, на циклические графы описываемый здесь метод вообще нельзя обобщить).<p>Итак, всякому простому пути в графе <img class=tex src="../tex2png/cache/04ee2212ca394e0ea72a519431459992.png" alt="\overline H">, начинающемуся в первой доле и заканчивающемуся во второй, можно поставить в соответствие простой путь в графе <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G">, и наоборот. Но заметим, что такой путь в графе <img class=tex src="../tex2png/cache/04ee2212ca394e0ea72a519431459992.png" alt="\overline H"> &mdash; это <b>паросочетание</b> в графе <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H">. Таким образом, любому пути из <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> можно поставить в соответствие паросочетание в графе <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H">, и наоборот. Более того, непересекающимся путям в <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> соответствуют непересекающиеся паросочетания в <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H">.<p>Последний шаг. Заметим, что чем больше путей есть в нашем наборе, тем меньше все эти пути содержат рёбер. А именно, если есть <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> непересекающихся путей, покрывающих все <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершин графа, то они вместе содержат <img class=tex src="../tex2png/cache/7c785c7d8ebef855158900d3d24ac911.png" alt="r = n - p"> рёбер. Итак, чтобы минимизировать число путей, мы должны <b>максимизировать число рёбер</b> в них.<p>Итак, мы свели задачу к нахождению максимального паросочетания в двудольном графе <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H">. После нахождения этого паросочетания (см. <a href="kuhn_matching.html">Алгоритм Куна</a>) мы должны преобразовать его в набор путей в <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> (это делается тривиальным алгоритмом, неоднозначностей здесь не возникает). Некоторые вершины могут остаться ненасыщенными паросочетанием, в таком случае в ответ надо добавить пути нулевой длины из каждой из этих вершин.<p><p><h2 style="padding-top:40px;">Взвешенный случай</h2><p>Взвешенный случай не сильно отличается от невзвешенного, просто в графе <img class=tex src="../tex2png/cache/6bdb95cd9c9cf2e6e2c25ed807acfc09.png" alt="H"> на рёбрах появляются веса, и требуется найти уже паросочетание наименьшего веса. Восстанавливая ответ аналогично невзвешенному случаю, мы получим покрытие графа наименьшим числом путей, а при равенстве &mdash; наименьшим по стоимости.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>