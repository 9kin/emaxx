<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Диофантовы уравнения с двумя неизвестными: AX+BY=C</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 18:15<br>редактировано: 26 Apr 2012 1:46</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="diofant_2_equation.html#" id="contents-hide">[скрыть]</a><a href="diofant_2_equation.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Линейные диофантовы уравнения с двумя переменными </h1><p>Диофантово уравнение с двумя неизвестными имеет вид:<p><p class=formula><img class=tex src="../tex2png/cache/3f188c0c486d5e7f3cce071d8e3ac4c3.png" alt=" a \cdot x + b \cdot y = c, "></p><p>где <img class=tex src="../tex2png/cache/ecf2de9b5d0f4a800ecb5a458e60f7a8.png" alt="a, b, c"> &mdash; заданные целые числа, <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> &mdash; неизвестные целые числа.<p>Ниже рассматриваются несколько классических задач на эти уравнения: нахождение любого решения, получение всех решений, нахождение количества решений и сами решения в определённом отрезке, нахождение решения с наименьшей суммой неизвестных.<p><p><p><h2 style="padding-top:40px;"> Вырожденный случай </h2><p>Один вырожденный случай мы сразу исключим из рассмотрения: когда <img class=tex src="../tex2png/cache/b7d53ecee07531afdbb467d99eed805b.png" alt="a = b = 0">. В этом случае, понятно, уравнение имеет либо бесконечно много произвольных решений, либо же не имеет решений вовсе (в зависимости от того, <img class=tex src="../tex2png/cache/b91434f7a607b0f069cd36685379d027.png" alt="c = 0"> или нет).<p><p><p><h2 style="padding-top:40px;"> Нахождение одного решения </h2><p>Найти одно из решений диофантова уравнения с двумя неизвестными можно с помощью <a href="extended_euclid_algorithm.html">Расширенного алгоритма Евклида</a>. Предположим сначала, что числа <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> неотрицательны.<p>Расширенный алгоритм Евклида по заданным неотрицательным числам <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> находит их наибольший общий делитель <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">, а также такие коэффициенты <img class=tex src="../tex2png/cache/3fa6b7f8d12bd85b46322195bf5066c5.png" alt="x_g"> и <img class=tex src="../tex2png/cache/5ce49488706477d963f96b13f83fe4e8.png" alt="y_g">, что:<p><p class=formula><img class=tex src="../tex2png/cache/a40e267887a65a53f9984f8a1e29b3be.png" alt=" a \cdot x_g + b \cdot y_g = g. "></p><p>Утверждается, что если <img class=tex src="../tex2png/cache/fdabaa70e1c423d289836bd4624e9e4e.png" alt="c"> делится на <img class=tex src="../tex2png/cache/8ed0a8651bb24ef918324f8ddbe88d50.png" alt="g = {\rm gcd} (a,b)">, то диофантово уравнение <img class=tex src="../tex2png/cache/7f2d30f2ef21f81962c63c8acd1864e6.png" alt="a \cdot x + b \cdot y = c"> имеет решение; в противном случае диофантово уравнение решений не имеет. Доказательство следует из очевидного факта, что линейная комбинация двух чисел по-прежнему должна делиться на их общий делитель.<p>Предположим, что <img class=tex src="../tex2png/cache/fdabaa70e1c423d289836bd4624e9e4e.png" alt="c"> делится на <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">, тогда, очевидно, выполняется:<p><p class=formula><img class=tex src="../tex2png/cache/534c3834efe73648a9f934f9bf2dcee2.png" alt=" a \cdot x_g \cdot (c/g) + b \cdot y_g \cdot (c/g)[...]"></p><p>т.е. одним из решений диофантова уравнения являются числа:<p><p class=formula><img class=tex src="../tex2png/cache/4f10f0407f6f1fb138f739d130b43e9e.png" alt=" \cases{
x_0 = x_g \cdot (c / g), \cr
y_0 = y_g [...]"></p><p>Мы описали решение в случае, когда числа <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> неотрицательны. Если же одно из них или они оба отрицательны, то можно поступить таким образом: взять их по модулю и применить к ним алгоритм Евклида, как было описано выше, а затем изменить знак найденных <img class=tex src="../tex2png/cache/469f2c65d8657af638ca2b52341a7edb.png" alt="x_0"> и <img class=tex src="../tex2png/cache/a6195bd4648f7e30c63de3740c75aa2c.png" alt="y_0"> в соответствии с настоящим знаком чисел <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> соответственно.<p>Реализация (напомним, здесь мы считаем, что входные данные <img class=tex src="../tex2png/cache/ee232aa89016bd4df2042f0e70e76731.png" alt="a=b=0"> недопустимы):<p><pre class="notranslate cpp"><span class="kw4">int</span> gcd <span class="br0">&#40;</span><span class="kw4">int</span> a, <span class="kw4">int</span> b, <span class="kw4">int</span> <span class="sy3">&amp;</span> x, <span class="kw4">int</span> <span class="sy3">&amp;</span> y<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>a <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
		x <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> y <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span>
		<span class="kw1">return</span> b<span class="sy4">;</span>
	<span class="br0">&#125;</span>
	<span class="kw4">int</span> x1, y1<span class="sy4">;</span>
	<span class="kw4">int</span> d <span class="sy1">=</span> gcd <span class="br0">&#40;</span>b<span class="sy2">%</span>a, a, x1, y1<span class="br0">&#41;</span><span class="sy4">;</span>
	x <span class="sy1">=</span> y1 <span class="sy2">-</span> <span class="br0">&#40;</span>b <span class="sy2">/</span> a<span class="br0">&#41;</span> <span class="sy2">*</span> x1<span class="sy4">;</span>
	y <span class="sy1">=</span> x1<span class="sy4">;</span>
	<span class="kw1">return</span> d<span class="sy4">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">bool</span> find_any_solution <span class="br0">&#40;</span><span class="kw4">int</span> a, <span class="kw4">int</span> b, <span class="kw4">int</span> c, <span class="kw4">int</span> <span class="sy3">&amp;</span> x0, <span class="kw4">int</span> <span class="sy3">&amp;</span> y0, <span class="kw4">int</span> <span class="sy3">&amp;</span> g<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	g <span class="sy1">=</span> gcd <span class="br0">&#40;</span><span class="kw3">abs</span><span class="br0">&#40;</span>a<span class="br0">&#41;</span>, <span class="kw3">abs</span><span class="br0">&#40;</span>b<span class="br0">&#41;</span>, x0, y0<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>c <span class="sy2">%</span> g <span class="sy3">!</span><span class="sy1">=</span> <span class="nu0">0</span><span class="br0">&#41;</span>
		<span class="kw1">return</span> <span class="kw2">false</span><span class="sy4">;</span>
	x0 <span class="sy2">*</span><span class="sy1">=</span> c <span class="sy2">/</span> g<span class="sy4">;</span>
	y0 <span class="sy2">*</span><span class="sy1">=</span> c <span class="sy2">/</span> g<span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>a <span class="sy1">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>   x0 <span class="sy2">*</span><span class="sy1">=</span> <span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>b <span class="sy1">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>   y0 <span class="sy2">*</span><span class="sy1">=</span> <span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
	<span class="kw1">return</span> <span class="kw2">true</span><span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p><p><p><h2 style="padding-top:40px;"> Получение всех решений </h2><p>Покажем, как получить все остальные решения (а их бесконечное множество) диофантова уравнения, зная одно из решений <img class=tex src="../tex2png/cache/802e57a22add7d3b409c069862e15e82.png" alt="(x_0,y_0)">.<p>Итак, пусть <img class=tex src="../tex2png/cache/e44cc1daab45a5e2de44eaf1a4bea36f.png" alt="g = {\rm gcd}(a,b)">, а числа <img class=tex src="../tex2png/cache/3c0e81abc8b75017c85a9291f19dd616.png" alt="x_0, y_0"> удовлетворяют условию:<p><p class=formula><img class=tex src="../tex2png/cache/04079e1647287b17d8d7d234c8b27016.png" alt=" a \cdot x_0 + b \cdot y_0 = c. "></p><p>Тогда заметим, что, прибавив к <img class=tex src="../tex2png/cache/469f2c65d8657af638ca2b52341a7edb.png" alt="x_0"> число <img class=tex src="../tex2png/cache/d496bc3de142a2d3101ddeaeef9358fa.png" alt="b/g"> и одновременно отняв <img class=tex src="../tex2png/cache/55ff3cc1971492f2dd61cc472f0064d4.png" alt="a/g"> от <img class=tex src="../tex2png/cache/a6195bd4648f7e30c63de3740c75aa2c.png" alt="y_0">, мы не нарушим равенства:<p><p class=formula><img class=tex src="../tex2png/cache/b0a7d742a734ec879b5065f251ac1a9e.png" alt=" a \cdot (x_0 + b/g) + b \cdot (y_0 - a/g) = a \cd[...]"></p><p>Очевидно, что этот процесс можно повторять сколько угодно, т.е. все числа вида:<p><p class=formula><img class=tex src="../tex2png/cache/48e3c72301aa9c838896cdb8827f676e.png" alt=" \cases{
x = x_0 + k \cdot b/g, \cr
y = y_0 - k [...]"></p><p>являются решениями диофантова уравнения.<p>Более того, только числа такого вида и являются решениями, т.е. мы описали множество всех решений диофантова уравнения (оно получилось бесконечным, если не наложено дополнительных условий).<p><p><p><h2 style="padding-top:40px;"> Нахождение количества решений и сами решения в заданном отрезке </h2><p>Пусть даны два отрезка <img class=tex src="../tex2png/cache/69a919b0438b5625a39a4cea3a6ff2c1.png" alt="[min_x;max_x]"> и <img class=tex src="../tex2png/cache/73accb23bb75d5e28568e4690536f8f7.png" alt="[min_y;max_y]">, и требуется найти количество решений <img class=tex src="../tex2png/cache/bceeeeebd9fec9d8ed4cd44b0d1a5b83.png" alt="(x,y)"> диофантова уравнения, лежащих в данных отрезках соответственно.<p>Заметим, что если одно из чисел <img class=tex src="../tex2png/cache/106e33258f8cdf301ce6ed887f9eb343.png" alt="a, b"> равно нулю, то задача имеет не больше одного решения, поэтому эти случаи мы в данном разделе исключаем из рассмотрения.<p>Сначала найдём решение с минимальным подходящим <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">, т.е. <img class=tex src="../tex2png/cache/d02052e44dabc8c43d734c95cef96123.png" alt="x \ge min_x">. Для этого сначала найдём любое решение диофантова уравнения (см. пункт 1). Затем получим из него решение с наименьшим <img class=tex src="../tex2png/cache/d02052e44dabc8c43d734c95cef96123.png" alt="x \ge min_x"> &mdash; для этого воспользуемся процедурой, описанной в предыдущем пункте, и будем уменьшать/увеличивать <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">, пока оно не окажется <img class=tex src="../tex2png/cache/06b0d7ac892ce9a3754e53bd9fed292b.png" alt="\ge min_x">, и при этом минимальным. Это можно сделать за <img class=tex src="../tex2png/cache/817532dd84d4eb666e5d80dc58098e94.png" alt="O(1)">, посчитав, с каким коэффициентом нужно применить это преобразование, чтобы получить минимальное число, большее либо равное <img class=tex src="../tex2png/cache/510eeb1f35e075036d96940e156549d4.png" alt="min_x">. Обозначим найденный <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> через <img class=tex src="../tex2png/cache/8627e93ee22abb48f7f209e7c9e72ce1.png" alt="lx1">.<p>Аналогичным образом можно найти и решение с максимальным подходящим <img class=tex src="../tex2png/cache/35f29c5602c9137609473d51ac62e514.png" alt="x=rx1">, т.е. <img class=tex src="../tex2png/cache/f6fd16d40574b0c60176d1c36a271183.png" alt="x \le max_x">.<p>Далее перейдём к удовлетворению ограничений на <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y">, т.е. к рассмотрению отрезка <img class=tex src="../tex2png/cache/73accb23bb75d5e28568e4690536f8f7.png" alt="[min_y;max_y]">. Способом, описанным выше, найдём решение с минимальным <img class=tex src="../tex2png/cache/704476195422d110e2ac083c899c65ad.png" alt="y \ge min_y">, а также решение с максимальным <img class=tex src="../tex2png/cache/09952a1c03c600a5afb620bc5e7f98a4.png" alt="y \le max_y">. Обозначим <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">-коэффициенты этих решений через <img class=tex src="../tex2png/cache/7c6b383266400733158c3f12d0e38455.png" alt="lx2"> и <img class=tex src="../tex2png/cache/0ffc7768184fbc888931b807879820a3.png" alt="rx2"> соответственно.<p>Пересечём отрезки <img class=tex src="../tex2png/cache/f6297d74e42b363d61b1fb87403361db.png" alt="[lx1;rx1]"> и <img class=tex src="../tex2png/cache/e06976e1abfae58c88b4ccd518d41331.png" alt="[lx2;rx2]">; обозначим получившийся отрезок через <img class=tex src="../tex2png/cache/c309f43324fc5524df97446c726e0dce.png" alt="[lx;rx]">. Утверждается, что любое решение, у которого <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">-коэффициент лежит в <img class=tex src="../tex2png/cache/c309f43324fc5524df97446c726e0dce.png" alt="[lx;rx]"> &mdash; любое такое решение является подходящим. (Это верно в силу построения этого отрезка: сначала мы отдельно удовлетворили ограничения на <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y">, получив два отрезка, а затем пересекли их, получив область, в которой удовлетворяются оба условия.)<p>Таким образом, количество решений будет равняться длине этого отрезка, делённой на <img class=tex src="../tex2png/cache/c2651ec9021694bcfa28fc27ec06097b.png" alt="|b|"> (поскольку <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">-коэффициент может изменяться только на <img class=tex src="../tex2png/cache/912786c8d846956a841e7732e6b6d684.png" alt="\pm b">), и плюс один.<p>Приведём реализацию (она получилась достаточно сложной, поскольку требуется аккуратно рассматривать случаи положительных и отрицательных коэффициентов <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b">):<p><pre class="notranslate cpp"><span class="kw4">void</span> shift_solution <span class="br0">&#40;</span><span class="kw4">int</span> <span class="sy3">&amp;</span> x, <span class="kw4">int</span> <span class="sy3">&amp;</span> y, <span class="kw4">int</span> a, <span class="kw4">int</span> b, <span class="kw4">int</span> cnt<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	x <span class="sy2">+</span><span class="sy1">=</span> cnt <span class="sy2">*</span> b<span class="sy4">;</span>
	y <span class="sy2">-</span><span class="sy1">=</span> cnt <span class="sy2">*</span> a<span class="sy4">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">int</span> find_all_solutions <span class="br0">&#40;</span><span class="kw4">int</span> a, <span class="kw4">int</span> b, <span class="kw4">int</span> c, <span class="kw4">int</span> minx, <span class="kw4">int</span> maxx, <span class="kw4">int</span> miny, <span class="kw4">int</span> maxy<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">int</span> x, y, g<span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy3">!</span> find_any_solution <span class="br0">&#40;</span>a, b, c, x, y, g<span class="br0">&#41;</span><span class="br0">&#41;</span>
		<span class="kw1">return</span> <span class="nu0">0</span><span class="sy4">;</span>
	a <span class="sy2">/</span><span class="sy1">=</span> g<span class="sy4">;</span>  b <span class="sy2">/</span><span class="sy1">=</span> g<span class="sy4">;</span>
&nbsp;
	<span class="kw4">int</span> sign_a <span class="sy1">=</span> a<span class="sy1">&gt;</span><span class="nu0">0</span> <span class="sy4">?</span> <span class="sy2">+</span><span class="nu0">1</span> <span class="sy4">:</span> <span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
	<span class="kw4">int</span> sign_b <span class="sy1">=</span> b<span class="sy1">&gt;</span><span class="nu0">0</span> <span class="sy4">?</span> <span class="sy2">+</span><span class="nu0">1</span> <span class="sy4">:</span> <span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span>
&nbsp;
	shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="br0">&#40;</span>minx <span class="sy2">-</span> x<span class="br0">&#41;</span> <span class="sy2">/</span> b<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>x <span class="sy1">&lt;</span> minx<span class="br0">&#41;</span>
		shift_solution <span class="br0">&#40;</span>x, y, a, b, sign_b<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>x <span class="sy1">&gt;</span> maxx<span class="br0">&#41;</span>
		<span class="kw1">return</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw4">int</span> lx1 <span class="sy1">=</span> x<span class="sy4">;</span>
&nbsp;
	shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="br0">&#40;</span>maxx <span class="sy2">-</span> x<span class="br0">&#41;</span> <span class="sy2">/</span> b<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>x <span class="sy1">&gt;</span> maxx<span class="br0">&#41;</span>
		shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="sy2">-</span>sign_b<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw4">int</span> rx1 <span class="sy1">=</span> x<span class="sy4">;</span>
&nbsp;
	shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="sy2">-</span> <span class="br0">&#40;</span>miny <span class="sy2">-</span> y<span class="br0">&#41;</span> <span class="sy2">/</span> a<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>y <span class="sy1">&lt;</span> miny<span class="br0">&#41;</span>
		shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="sy2">-</span>sign_a<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>y <span class="sy1">&gt;</span> maxy<span class="br0">&#41;</span>
		<span class="kw1">return</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw4">int</span> lx2 <span class="sy1">=</span> x<span class="sy4">;</span>
&nbsp;
	shift_solution <span class="br0">&#40;</span>x, y, a, b, <span class="sy2">-</span> <span class="br0">&#40;</span>maxy <span class="sy2">-</span> y<span class="br0">&#41;</span> <span class="sy2">/</span> a<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>y <span class="sy1">&gt;</span> maxy<span class="br0">&#41;</span>
		shift_solution <span class="br0">&#40;</span>x, y, a, b, sign_a<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw4">int</span> rx2 <span class="sy1">=</span> x<span class="sy4">;</span>
&nbsp;
	<span class="kw1">if</span> <span class="br0">&#40;</span>lx2 <span class="sy1">&gt;</span> rx2<span class="br0">&#41;</span>
		swap <span class="br0">&#40;</span>lx2, rx2<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw4">int</span> lx <span class="sy1">=</span> max <span class="br0">&#40;</span>lx1, lx2<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw4">int</span> rx <span class="sy1">=</span> min <span class="br0">&#40;</span>rx1, rx2<span class="br0">&#41;</span><span class="sy4">;</span>
&nbsp;
	<span class="kw1">return</span> <span class="br0">&#40;</span>rx <span class="sy2">-</span> lx<span class="br0">&#41;</span> <span class="sy2">/</span> <span class="kw3">abs</span><span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="sy2">+</span> <span class="nu0">1</span><span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p>Также нетрудно добавить к этой реализации вывод всех найденных решений: для этого достаточно перебрать <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> в отрезке <img class=tex src="../tex2png/cache/c309f43324fc5524df97446c726e0dce.png" alt="[lx;rx]"> с шагом <img class=tex src="../tex2png/cache/c2651ec9021694bcfa28fc27ec06097b.png" alt="|b|">, найдя для каждого из них соответствующий <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> непосредственно из уравнения <img class=tex src="../tex2png/cache/554d64ca626a41a4db134244792f9d2f.png" alt="ax+by=c">.<p><p><h2 style="padding-top:40px;"> Нахождение решения в заданном отрезке с наименьшей суммой x+y </h2><p>Здесь на <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и на <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> также должны быть наложены какие-либо ограничения, иначе ответом практически всегда будет минус бесконечность.<p>Идея решения такая же, как и в предыдущем пункте: сначала находим любое решение диофантова уравнения, а затем, применяя описанную в предыдущем пункте процедуру, придём к наилучшему решению.<p>Действительно, мы имеем право выполнить следующее преобразование (см. предыдущий пункт):<p><p class=formula><img class=tex src="../tex2png/cache/dd99b4c747a68e0a085c484025a639fc.png" alt=" \cases{
x^\prime = x + k \cdot (b/g), \cr
y^\pr[...]"></p><p>Заметим, что при этом сумма <img class=tex src="../tex2png/cache/7b70c5c3228ba1cb32db8dc2d89d3c89.png" alt="x+y"> меняется следующим образом:<p><p class=formula><img class=tex src="../tex2png/cache/c16b369b9f2403abe0782e5b8be8077e.png" alt="x^\prime + y^\prime = x + y + k \cdot (b/g - a/g) [...]"></p><p>Т.е. если <img class=tex src="../tex2png/cache/ec67d50251a936243867fd56c42fe43f.png" alt="a < b">, то нужно выбрать как можно меньшее значение <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">, если <img class=tex src="../tex2png/cache/d295eaa5d0ea5fdd85c835aa5938c087.png" alt="a > b">, то нужно выбрать как можно большее значение <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">.<p>Если <img class=tex src="../tex2png/cache/de2a7ad779332a5d15f605babe0d7a15.png" alt="a = b">, то мы никак не сможем улучшить решение, &mdash; все решения будут обладать одной и той же суммой.<p><p><p><h2 style="padding-top:40px;"> Задачи в online judges </h2><p>Список задач, которые можно сдать на тему диофантовых уравнений с двумя неизвестными:<p><ul><p><li><a href="http://acm.sgu.ru/problem.php?contest=0&problem=106">SGU #106 <b>"The Equation"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: средняя]</a><p></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>