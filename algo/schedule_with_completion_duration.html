<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Оптимальный выбор заданий при известных временах завершения и длительностях выполнения</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 11:22<br>редактировано: 6 Dec 2010 14:43</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="schedule_with_completion_duration.html#" id="contents-hide">[скрыть]</a><a href="schedule_with_completion_duration.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Оптимальный выбор заданий при известных временах завершения и длительностях выполнения</h1><p>Пусть дан набор заданий, у каждого задания известен момент времени, к которому это задание нужно завершить, и длительность выполнения этого задания. Процесс выполнения какого-либо задания нельзя прерывать до его завершения. Требуется составить такое расписание, чтобы выполнить наибольшее число заданий.<p><h2 style="padding-top:40px;">Решение</h2><p>Алгоритм решения &mdash; <b>жадный</b> (greedy). Отсортируем все задания по их крайнему сроку, и будем рассматривать их по очереди в порядке убывания крайнего срока. Также создадим очередь <img class=tex src="../tex2png/cache/733a381de525580104aa275afe299ec1.png" alt="q">, в которую мы будем постепенно помещать задания, и извлекать из очереди задание с наименьшим временем выполнения (например, можно использовать set или priority_queue). Изначально <img class=tex src="../tex2png/cache/733a381de525580104aa275afe299ec1.png" alt="q"> пустая.<p>Пусть мы рассматриваем <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ое задание. Сначала поместим его в <img class=tex src="../tex2png/cache/733a381de525580104aa275afe299ec1.png" alt="q">. Рассмотрим отрезок времени между сроком завершения <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-го задания и сроком завершения <img class=tex src="../tex2png/cache/81feab0e2cc1a37ff2c95e0a32cf5fc3.png" alt="i-1">-го задания &mdash; это отрезок некоторой длины <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">. Будем извлекать из <img class=tex src="../tex2png/cache/733a381de525580104aa275afe299ec1.png" alt="q"> задания (в порядке увеличения оставшегося времени их выполнения) и помещать на выполнение в этом отрезке, пока не заполним весь отрезок <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">. Важный момент &mdash; если в какой-то момент времени очередное извлечённое из структуры задание можно успеть частично выполнить в отрезке <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">, то мы выполняем это задание частично &mdash; именно настолько, насколько это возможно, т.е. в течение <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> единиц времени, а оставшуюся часть задания помещаем обратно в <img class=tex src="../tex2png/cache/733a381de525580104aa275afe299ec1.png" alt="q">.<p>По окончании этого алгоритма мы выберем оптимальное решение (или, по крайней мере, одно из нескольких решений). Асимптотика решения &mdash; <img class=tex src="../tex2png/cache/65dae66ac82f684c5b24e464a8ca3610.png" alt="O (n \log n)">.<p><p><h2 style="padding-top:40px;">Реализация</h2><p><p><pre class="notranslate cpp"><span class="kw4">int</span> n<span class="sy4">;</span>
vector <span class="sy1">&lt;</span> pair<span class="sy1">&lt;</span><span class="kw4">int</span>,<span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> a<span class="sy4">;</span> <span class="co1">// задания в виде пар (крайний срок, длительность)</span>
... чтение n и a ...
&nbsp;
<span class="me1">sort</span> <span class="br0">&#40;</span>a.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, a.<span class="me1">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">typedef</span> set <span class="sy1">&lt;</span> pair<span class="sy1">&lt;</span><span class="kw4">int</span>,<span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> t_s<span class="sy4">;</span>
t_s s<span class="sy4">;</span>
vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> result<span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span>n<span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span> i<span class="sy1">&gt;=</span><span class="nu0">0</span><span class="sy4">;</span> <span class="sy2">--</span>i<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">int</span> t <span class="sy1">=</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">first</span> <span class="sy2">-</span> <span class="br0">&#40;</span>i <span class="sy4">?</span> a<span class="br0">&#91;</span>i<span class="sy2">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">first</span> <span class="sy4">:</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy4">;</span>
	s.<span class="me1">insert</span> <span class="br0">&#40;</span>make_pair <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">second</span>, i<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">while</span> <span class="br0">&#40;</span>t <span class="sy3">&amp;&amp;</span> <span class="sy3">!</span>s.<span class="me1">empty</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
		t_s<span class="sy4">::</span><span class="me2">iterator</span> it <span class="sy1">=</span> s.<span class="me1">begin</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span>
		<span class="kw1">if</span> <span class="br0">&#40;</span>it<span class="sy2">-</span><span class="sy1">&gt;</span>first <span class="sy1">&lt;=</span> t<span class="br0">&#41;</span> <span class="br0">&#123;</span>
			t <span class="sy2">-</span><span class="sy1">=</span> it<span class="sy2">-</span><span class="sy1">&gt;</span>first<span class="sy4">;</span>
			result.<span class="me1">push_back</span> <span class="br0">&#40;</span>it<span class="sy2">-</span><span class="sy1">&gt;</span>second<span class="br0">&#41;</span><span class="sy4">;</span>
		<span class="br0">&#125;</span>
		<span class="kw1">else</span> <span class="br0">&#123;</span>
			s.<span class="me1">insert</span> <span class="br0">&#40;</span>make_pair <span class="br0">&#40;</span>it<span class="sy2">-</span><span class="sy1">&gt;</span>first <span class="sy2">-</span> t, it<span class="sy2">-</span><span class="sy1">&gt;</span>second<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy4">;</span>
			t <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
		<span class="br0">&#125;</span>
		s.<span class="me1">erase</span> <span class="br0">&#40;</span>it<span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">size_t</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;</span>result.<span class="me1">size</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	<span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> result<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy1">&lt;&lt;</span> <span class="st0">' '</span><span class="sy4">;</span></pre><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>