<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Комбинаторика. Ожерелья</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 11:17<br>редактировано: 1 Jun 2009 11:36</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="necklace_colouring.html#" id="contents-hide">[скрыть]</a><a href="necklace_colouring.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Ожерелья</h1><p>Задача "ожерелья" &mdash; это одна из классических комбинаторных задач. Требуется посчитать количество различных ожерелий из <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> бусинок, каждая из которых может быть покрашена в один из <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> цветов. При сравнении двух ожерелий их можно поворачивать, но не переворачивать (т.е. разрешается сделать циклический сдвиг).<p><h2 style="padding-top:40px;">Решение</h2><p>Решить эту задачу можно, используя <a href="burnside_polya.html">лемму Бернсайда и теорему Пойа</a>. [ Ниже идёт копия текста из этой статьи ]<p>В этой задаче мы можем сразу найти группу инвариантных перестановок. Очевидно, она будет состоять из <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> перестановок:<p><p class=formula><img class=tex src="../tex2png/cache/a9074b2f09a28c3f03848d826dee4db4.png" alt=" \pi_0 = 1\ 2\ 3\ \ldots\ n "><br><img class=tex src="../tex2png/cache/f905357ad7c1f7d53ffeaacf843a6097.png" alt=" \pi_1 = 2\ 3\ \ldots\ n\ 1 "><br><img class=tex src="../tex2png/cache/ec6c30c2f8102e02a0f284cb67348ea4.png" alt=" \pi_2 = 3\ \ldots\ n\ 1\ 2 "><br><img class=tex src="../tex2png/cache/3ee865b5cc661e7f1c429bc56246d9cf.png" alt=" \ldots "><br><img class=tex src="../tex2png/cache/8a22fbcd3b0f6f1e7f8325a3a55a425b.png" alt=" \pi_{n-1} = n\ 1\ 2\ \ldots\ (n-1) "></p><p>Найдём явную формулу для вычисления <img class=tex src="../tex2png/cache/b5334f4af10fb6971800dc3d4ccad154.png" alt="C(\pi_i)">. Во-первых, заметим, что перестановки имеют такой вид, что в <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой перестановке на <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j">-ой позиции стоит <img class=tex src="../tex2png/cache/9a24a1a6fff9bf29cc0f8b96d5eed7f4.png" alt="i+j"> (взятое по модулю <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, если оно больше <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">). Если мы будем рассматривать циклическую структуру <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой перестановки, то увидим, что единица переходит в <img class=tex src="../tex2png/cache/5a151a6243dcc76e5e73bbf6dd8ef3e9.png" alt="1+i">, <img class=tex src="../tex2png/cache/5a151a6243dcc76e5e73bbf6dd8ef3e9.png" alt="1+i"> переходит в <img class=tex src="../tex2png/cache/69d3a54d126934cb46286f688fd6c3b8.png" alt="1+2i">, <img class=tex src="../tex2png/cache/69d3a54d126934cb46286f688fd6c3b8.png" alt="1+2i"> &mdash; в <img class=tex src="../tex2png/cache/77337a267a09bf2af23bade2c5cad584.png" alt="1+3i">, и т.д., пока не придём в число <img class=tex src="../tex2png/cache/2b67432c66246e849226209ceb5c4cca.png" alt="1 + kn">; для остальных элементов выполняются похожие утверждения. Отсюда можно понять, что все циклы имеют одинаковую длину, равную <img class=tex src="../tex2png/cache/5d3b91d2e81ef7616ea19c9c682ebe96.png" alt="{\rm lcm}(i,n) / i">, т.е. <img class=tex src="../tex2png/cache/759e322c3325f4aa4db0dafbd4254d23.png" alt="n / {\rm gcd}(i,n)"> ("gcd" &mdash; наибольший общий делитель, "lcm" &mdash; наименьшее общее кратное). Тогда количество циклов в <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой перестановке будет равно просто <img class=tex src="../tex2png/cache/bbac9caed8d120bcf65ef900716f035e.png" alt="{\rm gcd}(i,n)">.<p>Подставляя найденные значения в теорему Пойа, получаем <b>решение</b>:<p><p class=formula><img class=tex src="../tex2png/cache/e0b152e43f0be6d9e7053898f3c06c3a.png" alt=" {\rm Ans} = \frac{1}{n} \sum_{i=1}^{n} k ^ {{\rm [...]"></p><p>Можно оставить формулу в таком виде, а можно её свернуть ещё больше. Перейдём от суммы по всем <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> к сумме только по делителям <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">. Действительно, в нашей сумме будет много одинаковых слагаемых: если <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> не является делителем <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, то таковой делитель найдётся после вычисления <img class=tex src="../tex2png/cache/bbac9caed8d120bcf65ef900716f035e.png" alt="{\rm gcd}(i,n)">. Следовательно, для каждого делителя <img class=tex src="../tex2png/cache/a05131f9fd73ffae7121e74d3f34c7f9.png" alt="d|n"> его слагаемое <img class=tex src="../tex2png/cache/fd9595c92c7179e65b855624ff413c63.png" alt="k^{{\rm gcd}(d,n)} = k^d"> учтётся несколько раз, т.е. сумму можно представить в таком виде:<p><p class=formula><img class=tex src="../tex2png/cache/bf7e43830530d3b2afa67c0da7a33e81.png" alt=" {\rm Ans} = \frac{1}{n} \sum_{d|n} C_d k^d "></p><p>где <img class=tex src="../tex2png/cache/d89bf8f6f1591794041e9517f1aa4ff2.png" alt="C_d"> &mdash; это количество таких чисел <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">, что <img class=tex src="../tex2png/cache/0faab43f8e08f0dce2702de248bd0369.png" alt="{\rm gcd}(i,n) = d">. Найдём явное выражение для этого количества. Любое такое число <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> имеет вид: <img class=tex src="../tex2png/cache/21a08df6e0ca5d8656bbe492baca143e.png" alt="i=dj">, где <img class=tex src="../tex2png/cache/23048ff8e12ad66337a24cfc56103eb2.png" alt="{\rm gcd}(j,n/d) = 1"> (иначе было бы <img class=tex src="../tex2png/cache/710ed56962ad42c9a7e232656d332632.png" alt="{\rm gcd}(i,n) > d">). Вспоминая <a href="euler_function.html">функцию Эйлера</a>, мы находим, что количество таких <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j"> &mdash; это величина функции Эйлера <img class=tex src="../tex2png/cache/b230cc66afd7c6121af47c4a58ba4994.png" alt="\phi(n/d)">. Таким образом, <img class=tex src="../tex2png/cache/9b3f7d112ec638e6044f3b01996b364a.png" alt="C_d = \phi(n/d)">, и окончательно получаем <b>формулу</b>:<p><p class=formula><img class=tex src="../tex2png/cache/ad458f2bd2699770aebbace01f10d35d.png" alt=" {\rm Ans} = \frac{1}{n} \sum_{d|n} \phi \left( \f[...]"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>