<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Диаграмма Вороного в двумерном случае</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 16 Jan 2009 0:58<br>редактировано: 26 Apr 2011 16:58</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="voronoi_diagram_2d_n4.html#" id="contents-hide">[скрыть]</a><a href="voronoi_diagram_2d_n4.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Диаграмма Вороного в 2D</h1><p><h2 style="padding-top:40px;">Определение</h2><p>Даны <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> точек <img class=tex src="../tex2png/cache/2eff6c20988386470ea2ee1dd6893864.png" alt="P_i(x_i,y_i)"> на плоскости. Рассмотрим разбиение плоскости на <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> областей <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i"> (называемых многоугольниками Вороного или ячейками Вороного, иногда &mdash; многоугольниками близости, ячейками Дирихле, разбиением Тиссена), где <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i"> &mdash; множество всех точек плоскости, которые находятся ближе к точке <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i">, чем ко всем остальным точкам <img class=tex src="../tex2png/cache/ba3ff7ad9c9d31c5b492e7131fb7921c.png" alt="P_k">:<p class=formula><img class=tex src="../tex2png/cache/7ab9d99956fc67a72c0845a249c58dad.png" alt=" V_i = \{ (x,y): \rho ((x,y), P_i) = \min_{ k = 1 [...]"></p><p>Само разбиение плоскости называется диаграммой Вороного данного набора точек <img class=tex src="../tex2png/cache/ba3ff7ad9c9d31c5b492e7131fb7921c.png" alt="P_k">.<p>Здесь <img class=tex src="../tex2png/cache/8752d21e2f5025b7332fd5548e640f99.png" alt="\rho(p,q)"> &mdash; заданная метрика, обычно это стандартная Евклидова метрика: <img class=tex src="../tex2png/cache/8ec159fbcddd7d037ca54a3b520168c5.png" alt="\rho(p,q) = \sqrt{ (x_p-x_q)^2 + (y_p-y_q)^2 }">, однако ниже будет рассмотрен и случай так называемой манхэттенской метрики. Здесь и далее, если не оговорено иного, будет рассматриваться случай Евклидовой метрики<p>Ячейки Вороного представляют собой выпуклые многоугольники, некоторые являются бесконечными. Точки, принадлежащие согласно определению сразу нескольким ячейкам Вороного, обычно так и относят сразу к нескольким ячейкам (в случае Евклидовой метрики множество таких точек имеет меру нуль; в случае манхэттенской метрики всё несколько сложнее).<p>Такие многоугольники впервые были глубоко изучены русским математиком Вороным (1868-1908 гг.).<p><h2 style="padding-top:40px;">Свойства</h2><p><ul><p><li>Диаграмма Вороного является планарным графом, поэтому она имеет <img class=tex src="../tex2png/cache/3bd5ae6ef1beefce202e062967bc49c1.png" alt="O(n)"> вершин и рёбер.<p><li>Зафиксируем любое <img class=tex src="../tex2png/cache/ced0ccd215c22453360ad7a2d3ec7a23.png" alt="i=1 \ldots n">. Тогда для каждого <img class=tex src="../tex2png/cache/a71b075069e002c05d2d0051076f842d.png" alt="j=1 \ldots n, j \ne i"> проведём прямую &mdash; серединный перпендикуляр отрезка <img class=tex src="../tex2png/cache/583a894c516622d08b54dd76c55eb6c4.png" alt="(P_i,P_j)">; рассмотрим ту полуплоскость, образуемую этой прямой, в которой лежит точка <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i">. Тогда пересечение всех полуплоскостей для каждого <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j"> даст ячейку Вороного <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i">.<p><li>Каждая вершина диаграммы Вороного является центром окружности, проведённой через какие-либо три точки множества <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">. Эти окружности существенно используются во многих доказательствах, связанных с диаграммами Вороного.<p><li>Ячейка Вороного <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i"> является бесконечной тогда и только тогда, когда точка <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i"> лежит на границе выпуклой оболочки множества <img class=tex src="../tex2png/cache/ba3ff7ad9c9d31c5b492e7131fb7921c.png" alt="P_k">.<p><li>Рассмотрим граф, двойственный к диаграмме Вороного, т.е. в этом графе вершинами будут точки <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i">, а ребро проводится между точками <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i"> и <img class=tex src="../tex2png/cache/a085bafc960b3178e7b9945d72cc3413.png" alt="P_j">, если их ячейки Вороного <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i"> и <img class=tex src="../tex2png/cache/a18d471b20e91a3246bf941ffb5b4af2.png" alt="V_j"> имеют общее ребро. Тогда, при условии, что никакие четыре точки не лежат на одной окружности, двойственный к диаграмме Вороного граф является триангуляцией Делоне (обладающей множеством интересных свойств).<p></ul><p><h2 style="padding-top:40px;">Применение</h2><p>Диаграмма Вороного представляет собой компактную структуру данных, хранящую всю необходимую информацию для решения множества задач о близости.<p>В рассмотренных ниже задачах время, необходимое на построение самой диаграммы Вороного, в асимптотиках не учитывается.<p><ul><p><li>Нахождение ближайшей точки для каждой.<p>Отметим простой факт: если для точки <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i"> ближайшей является точка <img class=tex src="../tex2png/cache/a085bafc960b3178e7b9945d72cc3413.png" alt="P_j">, то эта точка <img class=tex src="../tex2png/cache/a085bafc960b3178e7b9945d72cc3413.png" alt="P_j"> имеет "своё" ребро в ячейке <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i">. Отсюда следует, что, чтобы найти для каждой точки ближайшую к ней, достаточно просмотреть рёбра её ячейки Вороного. Однако каждое ребро принадлежит ровно двум ячейкам, поэтому будет просмотрено ровно два раза, и вследствие линейности числа рёбер мы получаем решение данной задачи за <img class=tex src="../tex2png/cache/3bd5ae6ef1beefce202e062967bc49c1.png" alt="O(n)">.<p><li>Нахождение выпуклой оболочки.<p>Вспомним, что вершина принадлежит выпуклой оболочке тогда и только тогда, когда её ячейка Вороного бесконечна. Тогда найдём в диаграмме Вороного любое бесконечное ребро, и начнём двигаться в каком-либо фиксированном направлении (например, против часовой стрелки) по ячейке, содержащей это ребро, пока не дойдём до следующего бесконечного ребра. Тогда перейдём через это ребро в соседнюю ячейку и продолжим обход. В результате все просмотренные рёбра (кроме бесконечных) будут являться сторонами искомой выпуклой оболочки. Очевидно, время работы алгоритма - <img class=tex src="../tex2png/cache/3bd5ae6ef1beefce202e062967bc49c1.png" alt="O(n)">.<p><li>Нахождение Евклидова минимального остовного дерева.<p>Требуется найти минимальное остовное дерево с вершинами в данных точках <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">, соединяющее все эти точки. Если применять стандартные методы теории графов, то, т.к. граф в данном случае имеет <img class=tex src="../tex2png/cache/712c5a4a9bec3c435e92314194c99f95.png" alt="O(n^2)"> рёбер, даже оптимальный алгоритм будет иметь не меньшую асимптотику.<p>Рассмотрим граф, двойственный диаграмме Вороного, т.е. триангуляцию Делоне. Можно показать, что нахождение Евклидова минимального остова эквивалентно построению остова триангуляции Делоне. Действительно, в <a href="mst_prim.html">алгоритме Прима</a> каждый раз ищется кратчайшее ребро между двумя можествами точек; если мы зафиксируем точку одного множества, то ближайшая к ней точка имеет ребро в ячейке Вороного, поэтому в триангуляции Делоне будет присутствовать ребро к ближайшей точке, что и требовалось доказать.<p>Триангуляция является планарным графом, т.е. имеет линейное число рёбер, поэтому к ней можно применить <a href="mst_kruskal_with_dsu.html">алгоритм Крускала</a> и получить алгоритм с временем работы <img class=tex src="../tex2png/cache/527d68b29319f540bf910dd5bb881008.png" alt="O(n \log n)">.<p><li>Нахождение наибольшей пустой окружности.<p>Требуется найти окружность наибольшего радиуса, не содержащую внутри никакую из точек <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i"> (центр окружности должен лежать внутри выпуклой оболочки точек <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i">). Заметим, что, т.к. функция наибольшего радиуса окружности в данной точке <img class=tex src="../tex2png/cache/bc196c83bd0d746e6d5f404b0c6c1701.png" alt="f(x,y)"> является строго монотонной внутри каждой ячейки Вороного, то она достигает своего максимума в одной из вершин диаграммы Вороного, либо в точке пересечения рёбер диаграммы и выпуклой оболочки (а число таких точек не более чем в два раза больше числа рёбер диаграммы). Таким образом, остаётся только перебрать указанные точки и для каждой найти ближайшую, т.е. решение за <img class=tex src="../tex2png/cache/3bd5ae6ef1beefce202e062967bc49c1.png" alt="O(n)">.<p></ul><p><h2 style="padding-top:40px;">Простой алгоритм построения диаграммы Вороного за <img class=tex src="../tex2png/cache/528f2a9b7034622a521a5d07d1bab759.png" alt="O(n^4)"></h2><p>Диаграммы Вороного &mdash; достаточно хорошо изученный объект, и для них получено множество различных алгоритмов, работающих за оптимальную асимптотику <img class=tex src="../tex2png/cache/65dae66ac82f684c5b24e464a8ca3610.png" alt="O (n \log n)">, а некоторые из этих алгоритмов даже работают в среднем за <img class=tex src="../tex2png/cache/ad5a094bea72e51fb50321739f51ec0d.png" alt="O (n)">. Однако все эти алгоритмы весьма сложны.<p>Рассмотрим здесь самый простой алгоритм, основанный на приведённом выше свойстве, что каждая ячейка Вороного представляет собой пересечение полуплоскостей. Зафиксируем <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">. Проведём между точкой <img class=tex src="../tex2png/cache/f67331a1fbd6e5a8518c1a9ec9512b5d.png" alt="P_i"> и каждой точкой <img class=tex src="../tex2png/cache/a085bafc960b3178e7b9945d72cc3413.png" alt="P_j"> прямую &mdash; серединный перпендикуляр, затем пересечём попарно все полученные прямые &mdash; получим <img class=tex src="../tex2png/cache/712c5a4a9bec3c435e92314194c99f95.png" alt="O(n^2)"> точек, и каждую проверим на принадлежность всем <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> полуплоскостям. В результате за <img class=tex src="../tex2png/cache/5333bf52919bd2805f33a181851ebbf4.png" alt="O(n^3)"> действий мы получим все вершины ячейки Вороного <img class=tex src="../tex2png/cache/d919fc1e3636c8e11767aca3cdf54022.png" alt="V_i"> (их уже будет не более <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, поэтому мы можем без ухудшения асимптотики отсортировать их по полярному углу), а всего на построение диаграммы Вороного потребуется <img class=tex src="../tex2png/cache/022492c591829f1c0253baf809f9aeb3.png" alt="O(n^4)"> действий.<p><h2 style="padding-top:40px;">Случай особой метрики</h2><p>Рассмотрим следующую метрику:<p><p class=formula><img class=tex src="../tex2png/cache/46ebab073a94b4e508ac62de966cca4e.png" alt=" \rho(p,q) = \max (|x_p-x_q|, |y_p-y_q|) "></p><p>Начать рассмотрение следует с разбора простейшего случая &mdash; случая двух точек <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> и <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">.<p>Если <img class=tex src="../tex2png/cache/85c781bb27d11978638ba3e9bd42f4a1.png" alt="A_x=B_x"> или <img class=tex src="../tex2png/cache/099234957e751df101db1b5ee91e6740.png" alt="A_y=B_y">, то диаграммой Вороного для них будет соответственно вертикальная или горизонтальная прямая.<p>Иначе диаграмма Вороного будет иметь вид "уголка": отрезок под углом <img class=tex src="../tex2png/cache/2cc9aa00d97cb64e27c3b41c442719d9.png" alt="45"> градусов в прямоугольнике, образованном точками <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> и <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">, и горизонтальные/вертикальные лучи из его концов в зависимости от того, длиннее ли вертикальная сторона прямоугольника или горизонтальная.<p>Особый случай &mdash; когда этот прямоугольник имеет одинаковую длину и ширину, т.е. <img class=tex src="../tex2png/cache/cf96698f624e116f6d4fcb21930f35d6.png" alt="|A_x-B_x| = |A_y-B_y|">. В этом случае будут иметься две бесконечные области ("уголки", образованные двумя лучами, параллельными осям), которые по определению должны принадлежать сразу обеим ячейкам. В таком случае дополнительно определяют в условии, как следует понимать эти области (иногда искусственно вводят правило, по которому каждый уголок относят к своей ячейке).<p>Таким образом, уже для двух точек диаграмма Вороного в данной метрике представляет собой нетривиальный объект, а в случае большего числа точек эти фигуры надо будет уметь быстро пересекать.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>