<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Количество помеченных графов, связных помеченных графов, помеченных графов с K компонентами связности</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 8 Sep 2008 22:04<br>редактировано: 1 Jun 2009 15:46</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="counting_connected_graphs.html#" id="contents-hide">[скрыть]</a><a href="counting_connected_graphs.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h2 style="padding-top:40px;">Количество помеченных графов</h2><p>Дано число <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершин. Требуется посчитать количество <img class=tex src="../tex2png/cache/3e3834e96dd9c95fd42b2d6ebdbc6f13.png" alt="G_N"> различных помеченных графов с <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершинами (т.е. вершины графа помечены различными числами от <img class=tex src="../tex2png/cache/1737ac55fdbc871d8c7d14245b749ccd.png" alt="1"> до <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N">, и графы сравниваются с учётом этой покраски вершин). Рёбра графа неориентированы, петли и кратные рёбра запрещены.<p>Рассмотрим множество всех возможных рёбер графа. Для любого ребра <img class=tex src="../tex2png/cache/df9c3aa69e88ca097b0e7196d6b2dfed.png" alt="(i,j)"> положим, что <img class=tex src="../tex2png/cache/118d6fa21b7e03a54aadada264086399.png" alt="i<j"> (основываясь на неориентированности графа и отсутствии петель). Тогда множество всех возможных рёбер графа имеет мощность <img class=tex src="../tex2png/cache/14dde9f535e4cb25bfb80634ade3d2f6.png" alt="C_N^2">, т.е. <img class=tex src="../tex2png/cache/3d297088f670745df3cafb7d8c4d3e73.png" alt="\frac{ N (N-1) }{ 2 }">.<p>Поскольку любой помеченный граф однозначно определяется своими рёбрами, то количество помеченных графов с <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершинами равно:<p class=formula><img class=tex src="../tex2png/cache/6bb4227a0cb90574448c2a12de27e942.png" alt=" G_N = 2^{ \frac{ N (N-1) }{ 2 } } "></p><p><h2 style="padding-top:40px;">Количество связных помеченных графов</h2><p>По сравнению с предыдущей задачей мы дополнительно накладываем ограничение, что граф должен быть связным.<p>Обозначим искомое число через <img class=tex src="../tex2png/cache/c1a4b52ab0d75c5575d3869ceceee8b2.png" alt="Conn_N">.<p>Научимся, наоборот, считать количество <b>несвязных</b> графов; тогда количество связных графов получится как <img class=tex src="../tex2png/cache/3e3834e96dd9c95fd42b2d6ebdbc6f13.png" alt="G_N"> минус найденное число. Более того, научимся считать количество <b>корневых</b> (т.е. с выделенной вершиной - корнем) <b>несвязных графов</b>; тогда количество несвязных графов будет получаться из него делением на <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N">. Заметим, что, так как граф несвязный, то в нём найдётся компонента связности, внутри которой лежит корень, а остальной граф будет представлять собой ещё несколько (как минимум одну) компонент связности.<p>Переберём количество <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> вершин в этой компоненте связности, содержащей корень (очевидно, <img class=tex src="../tex2png/cache/9492ea07df39b428e0184945595a5f61.png" alt="K = 1 \ldots N-1">), и найдём количество таких графов. Во-первых, мы должны выбрать <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> вершин из <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N">, т.е. ответ умножается на <img class=tex src="../tex2png/cache/f1450ef62e9fd4c0593c8b9b865f3d24.png" alt="C_N^K">. Во-вторых, компонента связности с корнем даёт множитель <img class=tex src="../tex2png/cache/b56e7872eb6e8b9a50b952e05bde5ea1.png" alt="Conn_K">. В-третьих, оставшийся граф из <img class=tex src="../tex2png/cache/61de6d5409af0864030b353f3cc00372.png" alt="N-K"> вершин является произвольным графом, а потому он даёт множитель <img class=tex src="../tex2png/cache/8264ca87744bc30885b2954c2a7b8531.png" alt="G_{N-K}">. Наконец, количество способов выделить корень в компоненте связности из <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> вершин равно <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K">. Итого, при фиксированном <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> количество <b>корневых несвязных</b> графов равно:<p class=formula><img class=tex src="../tex2png/cache/79831e6080e8481bf0264717ff1756b0.png" alt=" K\ C_N^K\ Conn_K\ G_{N-K} "></p><p>Значит, количество <b>несвязных</b> графов с <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершинами равно:<p class=formula><img class=tex src="../tex2png/cache/673749ffe2e9559b9d24d59cb3ade21f.png" alt=" \frac{1}{N} \sum_{K=1}^{N-1} K\ C_N^K\ Conn_K\ G_[...]"></p><p>Наконец, искомое количество <b>связных</b> графов равно:<p class=formula><img class=tex src="../tex2png/cache/96926f7aa6751ea7783939402958213c.png" alt=" Conn_N = G_N - \frac{1}{N} \sum_{K=1}^{N-1} K\ C_[...]"></p><p><h2 style="padding-top:40px;">Количество помеченных графов с <img class=tex src="../tex2png/cache/95208af85464752e6cdf00db627db58d.png" alt="K"> компонентами связности</h2><p>Основываясь на предыдущей формуле, научимся считать количество помеченных графов с <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершинами и <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> компонентами связности.<p>Сделать это можно с помощью динамического программирования. Научимся считать <b><img class=tex src="../tex2png/cache/15267b110688dbfbf0974adc48905ba8.png" alt="D[N][K]"></b> &mdash; количество помеченных графов с <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> вершинами и <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> компонентами связности.<p>Научимся вычислять очередной элемент <img class=tex src="../tex2png/cache/15267b110688dbfbf0974adc48905ba8.png" alt="D[N][K]">, зная предыдущие значения. Воспользуемся стандартным приёмом при решении таких задач: возьмём вершину с номером 1, она принадлежит какой-то компоненте, вот эту компоненту мы и будем перебирать. Переберём размер <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> этой компоненты, тогда количество способов выбрать такое множество вершин равно <img class=tex src="../tex2png/cache/ac7ac1d8355b5ed18bcac5ef36a33d31.png" alt="C_{N-1}^{S-1}"> (одну вершину &mdash; вершину 1 &mdash; перебирать не надо). Количество же способов построить компоненту связности из <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> вершин мы уже умеем считать &mdash; это <img class=tex src="../tex2png/cache/b72a88e8589766155ce86e581b0d868d.png" alt="Conn_S">. После удаления этой компоненты из графа у нас остаётся граф с <img class=tex src="../tex2png/cache/12a0a7a615be9130198ac6e0d29657a6.png" alt="N-S"> вершинами и <img class=tex src="../tex2png/cache/33a1ae69f0df0b0bb37a4b0d17f4f2f4.png" alt="K-1"> компонентами связности, т.е. мы получили рекуррентную зависимость, по которой можно вычислять значения <img class=tex src="../tex2png/cache/027142e8ccc9fa6dc0cb292f71ad6938.png" alt="D[][]">:<p><p class=formula><img class=tex src="../tex2png/cache/74af6bb85fbcafd0aa17b4513127cb82.png" alt=" D[N][K] = \sum_{S=1}^{N} C_{N-1}^{S-1}\ Conn_S\ D[...]"></p><p>Итого получаем примерно такой код:<pre class="notranslate cpp"><span class="kw4">int</span> d<span class="br0">&#91;</span>n<span class="sy2">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#91;</span>k<span class="sy2">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy4">;</span> <span class="co1">// изначально заполнен нулями</span>
d<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span> i<span class="sy1">&lt;=</span>n<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> j<span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span> j<span class="sy1">&lt;=</span>i <span class="sy3">&amp;&amp;</span> j<span class="sy1">&lt;=</span>k<span class="sy4">;</span> <span class="sy2">++</span>j<span class="br0">&#41;</span>
		<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> s<span class="sy1">=</span><span class="nu0">1</span><span class="sy4">;</span> s<span class="sy1">&lt;=</span>i<span class="sy4">;</span> <span class="sy2">++</span>s<span class="br0">&#41;</span>
			d<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy2">+</span><span class="sy1">=</span> C<span class="br0">&#91;</span>i<span class="sy2">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#91;</span>s<span class="sy2">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy2">*</span> conn<span class="br0">&#91;</span>s<span class="br0">&#93;</span> <span class="sy2">*</span> d<span class="br0">&#91;</span>i<span class="sy2">-</span>s<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="sy2">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy4">;</span>
<span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> d<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy4">;</span></pre><p>Разумеется, на практике, скорее всего, нужна будет <a href="big_integer.html">длинная арифметика</a>.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>