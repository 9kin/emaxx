<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Числа Фибоначчи и их быстрое вычисление</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 17:59<br>редактировано: 28 Aug 2011 23:42</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="fibonacci_numbers.html#" id="contents-hide">[скрыть]</a><a href="fibonacci_numbers.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Числа Фибоначчи </h1><p><p><h2 style="padding-top:40px;"> Определение </h2><p>Последовательность Фибоначчи определяется следующим образом:<p><p class=formula><img class=tex src="../tex2png/cache/ac70adb6e1ad0de137149bb25bbce573.png" alt=" F_0 = 0, "><br><img class=tex src="../tex2png/cache/020e61c3040ca0ea193cc454189a750b.png" alt=" F_1 = 1, "><br><img class=tex src="../tex2png/cache/73d5028a13d9a693ef8effbcbf629c7a.png" alt=" F_n = F_{n-1} + F_{n-2}. "></p><p>Несколько первых её членов:<p><p class=formula><img class=tex src="../tex2png/cache/d36d015f185d84462b59e9afdf4c9c48.png" alt=" 0, ~ 1, ~ 1, ~ 2, ~ 3, ~ 5, ~ 8, ~ 13, ~ 21, ~ 34[...]"><p></p><p><h2 style="padding-top:40px;"> История </h2><p>Эти числа ввёл в 1202 г. Леонардо Фибоначчи (Leonardo Fibonacci) (также известный как Леонардо Пизанский (Leonardo Pisano)). Однако именно благодаря математику 19 века Люка (Lucas) название "числа Фибоначчи" стало общеупотребительным.<p>Впрочем, индийские математики упоминали числа этой последовательности ещё раньше: Гопала (Gopala) до 1135 г., Хемачандра (Hemachandra) &mdash; в 1150 г.<p><p><h2 style="padding-top:40px;"> Числа Фибоначчи в природе </h2><p>Сам Фибоначчи упоминал эти числа в связи с такой задачей: "Человек посадил пару кроликов в загон, окруженный со всех сторон стеной. Сколько пар кроликов за год может произвести на свет эта пара, если известно, что каждый месяц, начиная со второго, каждая пара кроликов производит на свет одну пару?". Решением этой задачи и будут числа последовательности, называемой теперь в его честь. Впрочем, описанная Фибоначчи ситуация &mdash; больше игра разума, чем реальная природа.<p>Индийские математики Гопала и Хемачандра упоминали числа этой последовательности в связи с количеством ритмических рисунков, образующихся в результате чередования долгих и кратких слогов в стихах или сильных и слабых долей в музыке. Число таких рисунков, имеющих в целом <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> долей, равно <img class=tex src="../tex2png/cache/7dcd6b01c7bd079818d4c4c37d4a511a.png" alt="F_n">.<p>Числа Фибоначчи появляются и в работе Кеплера 1611 года, который размышлял о числах, встречающихся в природе (работа "О шестиугольных снежинках").<p>Интересен пример растения &mdash; тысячелистника, у которого число стеблей (а значит и цветков) всегда есть число Фибоначчи. Причина этого проста: будучи изначально с единственным стеблем, этот стебель затем делится на два, затем от главного стебля ответвляется ещё один, затем первые два стебля снова разветвляются, затем все стебли, кроме двух последних, разветвляются, и так далее. Таким образом, каждый стебель после своего появления "пропускает" одно разветвление, а затем начинает делиться на каждом уровне разветвлений, что и даёт в результате числа Фибоначчи.<p>Вообще говоря, у многих цветов (например, лилий) число лепестков является тем или иным числом Фибоначчи.<p>Также в ботанике известно явление ''филлотаксиса''. В качестве примера можно привести расположение семечек подсолнуха: если посмотреть сверху на их расположение, то можно увидеть одновременно две серии спиралей (как бы наложенных друг на друга): одни закручены по часовой стрелке, другие &mdash; против. Оказывается, что число этих спиралей примерно совпадает с двумя последовательными числами Фибоначчи: 34 и 55 или 89 и 144. Аналогичные факты верны и для некоторых других цветов, а также для сосновых шишек, брокколи, ананасов, и т.д.<p>Для многих растений (по некоторым данным, для 90% из них) верен и такой интересный факт. Рассмотрим какой-нибудь лист, и будем спускаться от него вниз до тех пор, пока не достигнем листа, расположенного на стебле точно так же (т.е. направленного точно в ту же сторону). Попутно будем считать все листья, попадавшиеся нам (т.е. расположенные по высоте между стартовым листом и конечным), но расположенными по-другому. Нумеруя их, мы будем постепенно совершать витки вокруг стебля (поскольку листья расположены на стебле по спирали). В зависимости от того, совершать витки по часовой стрелке или против, будет получаться разное число витков. Но оказывается, что число витков, совершённых нами по часовой стрелке, число витков, совершённых против часовой стрелки, и число встреченных листьев образуют 3 последовательных числа Фибоначчи.<p>Впрочем, следует отметить, что есть и растения, для которых приведённые выше подсчёты дадут числа из совсем других последовательностей, поэтому нельзя сказать, что явление филлотаксиса является законом, &mdash; это скорее занимательная тенденция.<p><p><h2 style="padding-top:40px;"> Свойства </h2><p>Числа Фибоначчи обладают множеством интересных математических свойств.<p>Вот лишь некоторые из них:<p><ul><p><li>Соотношение Кассини: <p><p class=formula><img class=tex src="../tex2png/cache/75e6504cda450aad19cdc711a6e5dab2.png" alt=" F_{n+1} F_{n-1} - F_n^2 = (-1)^n. "></p><p><li>Правило "сложения": <p><p class=formula><img class=tex src="../tex2png/cache/f8e29750c209d1e8cc2b3727a61b4952.png" alt=" F_{n+k} = F_k F_{n+1} + F_{k-1} F_n. "></p><p><li>Из предыдущего равенства при <img class=tex src="../tex2png/cache/fb94585b00c4261727abdcbb24da4ea0.png" alt="k = n"> вытекает: <p><p class=formula><img class=tex src="../tex2png/cache/8c6a047a4fce3504e51f4bd6ce52e549.png" alt=" F_{2n} = F_n (F_{n+1} + F_{n-1}). "></p><p><li>Из предыдущего равенста по индукции можно получить, что <p><img class=tex src="../tex2png/cache/4a6f5e3ebe15343dbb165ab194b0c64e.png" alt="F_{nk}"> всегда кратно <img class=tex src="../tex2png/cache/7dcd6b01c7bd079818d4c4c37d4a511a.png" alt="F_n">.<p><li>Верно и обратное к предыдущему утверждение:<p>если <img class=tex src="../tex2png/cache/85e2d7065e3c4541c4a967e042517d65.png" alt="F_m"> кратно <img class=tex src="../tex2png/cache/7dcd6b01c7bd079818d4c4c37d4a511a.png" alt="F_n">, то <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m"> кратно <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">.<p><li>НОД-равенство: <p><p class=formula><img class=tex src="../tex2png/cache/91fb2960ab2502096ac76ab153df6582.png" alt=" {\rm gcd} (F_m, F_n) = F_{{\rm gcd} (m, n)}. "></p><p><li>По отношению к алгоритму Евклида числа Фибоначчи обладают тем замечательным свойством, что они являются наихудшими входными данными для этого алгоритма (см. "Теорема Ламе" в <a href="euclid_algorithm.html">Алгоритме Евклида</a>).<p></ul><p><p><h2 style="padding-top:40px;"> Фибоначчиева система счисления </h2><p><b>Теорема Цекендорфа</b> утверждает, что любое натуральное число <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> можно представить единственным образом в виде суммы чисел Фибоначчи:<p><p class=formula><img class=tex src="../tex2png/cache/e53a084cf161f2860c40aa27206badd7.png" alt="N = F_{k_1} + F_{k_2} + \ldots + F_{k_r}"></p><p>где <img class=tex src="../tex2png/cache/11b2b5d094c6dba796964a0e20d9675b.png" alt="k_1 \ge k_2+2">, <img class=tex src="../tex2png/cache/a05ab9a07779f20561e3746132df980d.png" alt="k_2 \ge k_3+2">,  <img class=tex src="../tex2png/cache/267994e119a8959ca9fc503a1ebd7490.png" alt="\ldots">,  <img class=tex src="../tex2png/cache/e7c0f5d2f922bbdd2c3d11a359da35a2.png" alt="k_r \ge 2"> (т.е. в записи нельзя использовать два соседних числа Фибоначчи).<p>Отсюда следует, что любое число можно однозначно записать в <b>фибоначчиевой системе счисления</b>, например:<p><p class=formula><img class=tex src="../tex2png/cache/c4ddc04df1e3162f3538763bd4fd48fc.png" alt=" 9 = 8+1 = F_6 + F_1 = (10001)_F, "><br><img class=tex src="../tex2png/cache/633c4089858a73e972028d718f5d5cec.png" alt=" 6 = 5+1 = F_5 + F_1 = (1001)_F, "><br><img class=tex src="../tex2png/cache/6512778f1f28a576be4b67f9473f3dfc.png" alt=" 19 = 13+5+1 = F_7 + F_5 + F_1 = (101001)_F, "></p><p>причём ни в каком числе не могут идти две единицы подряд.<p>Нетрудно получить и правило прибавления единицы к числу в фибоначчиевой системе счисления: если младшая цифра равна 0, то её заменяем на 1, а если равна 1 (т.е. в конце стоит 01), то 01 заменяем на 10. Затем "исправляем" запись, последовательно исправляя везде 011 на 100. В результате за линейное время будет получена запись нового числа.<p>Перевод числа в фибоначчиеву систему счисления осуществляется простым "жадным" алгоритмом: просто перебираем числа Фибоначчи от больших к меньшим и, если некоторое <img class=tex src="../tex2png/cache/7a9aaa27f625e10e91daf32b956fab15.png" alt="F_k \le n">, то <img class=tex src="../tex2png/cache/65c9f06e848ecdb1a3a023d32a8bf201.png" alt="F_k"> входит в запись числа <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, и мы отнимаем <img class=tex src="../tex2png/cache/65c9f06e848ecdb1a3a023d32a8bf201.png" alt="F_k"> от <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> и продолжаем поиск.<p><p><h2 style="padding-top:40px;"> Формула для n-го числа Фибоначчи </h2><p><p><h3 style="padding-top:15px;"> Формула через радикалы </h3><p>Существует замечательная формула, называемая по имени французского математика Бине (Binet), хотя она была известна до него Муавру (Moivre):<p><p class=formula><img class=tex src="../tex2png/cache/b905d527e4c238203b5be148f5f93a83.png" alt=" F_n = \frac{ \left( \frac{1+\sqrt{5}}{2} \right)^[...]"></p><p>Эту формулу легко доказать по индукции, однако вывести её можно с помощью понятия образующих функций или с помощью решения функционального уравнения.<p>Сразу можно заметить, что второе слагаемое всегда по модулю меньше 1, и более того, очень быстро убывает (экспоненциально). Отсюда следует, что значение первого слагаемого даёт "почти" значение <img class=tex src="../tex2png/cache/7dcd6b01c7bd079818d4c4c37d4a511a.png" alt="F_n">. Это можно записать в строгом виде:<p><p class=formula><img class=tex src="../tex2png/cache/1094df5457848414456a232b8e0e0254.png" alt="F_n = \left[ \frac{ \left( \frac{1+\sqrt{5}}{2} \r[...]"></p><p>где квадратные скобки обозначают округление до ближайшего целого.<p>Впрочем, для практического применения в вычислениях эти формулы мало подходят, потому что требуют очень высокой точности работы с дробными числами.<p><p><h3 style="padding-top:15px;"> Матричная формула для чисел Фибоначчи </h3><p>Нетрудно доказать матричное следующее равенство:<p><p class=formula><img class=tex src="../tex2png/cache/dae8aa23f9a9ab8ca68d653890d7200b.png" alt=" \pmatrix{
F_{n-2} & F_{n-1} \cr
} \cdot \pmatri[...]"></p><p>Но тогда, обозначая<p><p class=formula><img class=tex src="../tex2png/cache/b53793ea15e37412d46506a65f01df04.png" alt=" P \equiv
\pmatrix{
0 & 1 \cr
1 & 1 \cr
}, "></p><p>получаем:<p><p class=formula><img class=tex src="../tex2png/cache/5f31c53e54bed1cce6c326dce75c3157.png" alt=" \pmatrix{
F_0 & F_1 \cr
} \cdot P^n = \pmatrix{[...]"></p><p>Таким образом, для нахождения <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-го числа Фибоначчи надо возвести матрицу <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> в степень <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">.<p>Вспоминая, что возведение матрицы в <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-ую степень можно осуществить за <img class=tex src="../tex2png/cache/f164aa195cc12acf4e3719819f08c698.png" alt="O (\log n)"> (см. <a href="binary_pow.html">Бинарное возведение в степень</a>), получается, что <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-ое число Фибоначчи можно легко вычислить за <img class=tex src="../tex2png/cache/f164aa195cc12acf4e3719819f08c698.png" alt="O (\log n)"> c использованием только целочисленной арифметики.<p><p><h2 style="padding-top:40px;"> Периодичность последовательности Фибоначчи по модулю </h2><p>Рассмотрим последовательность Фибоначчи <img class=tex src="../tex2png/cache/6f20aa15b643326c3c95219518f4e2a4.png" alt="F_i"> по некоторому модулю <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p">. Докажем, что она является периодичной, и причём период начинается с <img class=tex src="../tex2png/cache/31b80f6bddddc900162ff255c6022e2d.png" alt="F_1=1"> (т.е. предпериод содержит только <img class=tex src="../tex2png/cache/fc9d8805dc1ef76ee59cac2703222e9a.png" alt="F_0">).<p>Докажем это от противного. Рассмотрим <img class=tex src="../tex2png/cache/0a2bed7916d86f211d40cc77959c2ee4.png" alt="p^2+1"> пар чисел Фибоначчи, взятых по модулю <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p">:<p><p class=formula><img class=tex src="../tex2png/cache/d1cc75773a002e484a9ae21befa62de4.png" alt="(F_1,F_2),\ (F_2,F_3),\ \ldots,\ (F_{p^2+1},F_{p^2[...]"></p><p>Поскольку по модулю <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> может быть только <img class=tex src="../tex2png/cache/c73db14dd9783b2c98935cc595e24ba3.png" alt="p^2"> различных пар, то среди этой последовательности найдётся как минимум две одинаковые пары. Это уже означает, что последовательность периодична.<p>Выберем теперь среди всех таких одинаковых пар две одинаковые пары с наименьшими номерами. Пусть это пары с некоторыми номерами <img class=tex src="../tex2png/cache/133ab10b60fc78a139db66791ab92f4a.png" alt="(F_a,F_{a+1})"> и <img class=tex src="../tex2png/cache/025f23174508a1aafe6a278d56a823a8.png" alt="(F_b,F_{b+1})">. Докажем, что <img class=tex src="../tex2png/cache/4bf171543cac7f428ab0ffabfee59832.png" alt="a=1">. Действительно, в противном случае для них найдутся предыдущие пары <img class=tex src="../tex2png/cache/f5a7851f12aa14505027fb4d0edf364e.png" alt="(F_{a-1},F_a)"> и <img class=tex src="../tex2png/cache/a359a2e7653db43c2f5ef731e47daba2.png" alt="(F_{b-1},F_b)">, которые, по свойству чисел Фибоначчи, также будут равны друг другу. Однако это противоречит тому, что мы выбрали совпадающие пары с наименьшими номерами, что и требовалось доказать.<p><p><h2 style="padding-top:40px;"> Литература </h2><p><ul><li><a href="../bookz/files/graham.djvu">Роналд Грэхэм, Дональд Кнут, Орен Паташник. <b>Конкретная математика</b> [1998]</a></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>