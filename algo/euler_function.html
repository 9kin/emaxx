<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Функция Эйлера и её вычисление</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 10:57<br>редактировано: 18 Oct 2011 20:20</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="euler_function.html#" id="contents-hide">[скрыть]</a><a href="euler_function.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Функция Эйлера </h1><p><p><h2 style="padding-top:40px;"> Определение </h2><p><b>Функция Эйлера</b> <img class=tex src="../tex2png/cache/06884fbd050a6fc272c9ac86e3a1bc7a.png" alt="\phi (n)"> (иногда обозначаемая <img class=tex src="../tex2png/cache/ec0498290873cd73de317820d717340e.png" alt="\varphi(n)"> или <img class=tex src="../tex2png/cache/87e5cd0bab8a6c7b527589d963849612.png" alt="{\it phi}(n)">) &mdash; это количество чисел от <img class=tex src="../tex2png/cache/1737ac55fdbc871d8c7d14245b749ccd.png" alt="1"> до <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">, взаимно простых с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">. Иными словами, это количество таких чисел в отрезке <img class=tex src="../tex2png/cache/69cc1de918936aa552092962896df9f8.png" alt="[1; n]">, <a href="euclid_algorithm.html">наибольший общий делитель</a> которых с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> равен единице.<p>Несколько первых значений этой функции (<a href="http://oeis.org/A000010">A000010 в энциклопедии OEIS</a>):<p><p class=formula><img class=tex src="../tex2png/cache/2d77f826ff760cf7378449718ebaf48d.png" alt=" \phi (1)=1, "><br><img class=tex src="../tex2png/cache/3af9ba07c4600561c5060f95039fb7d5.png" alt=" \phi (2)=1, "><br><img class=tex src="../tex2png/cache/1b316921abbfd0ca75c61aede7c12769.png" alt=" \phi (3)=2, "><br><img class=tex src="../tex2png/cache/a61fa6468be3aebbf034ae5a48df5087.png" alt=" \phi (4)=2, "><br><img class=tex src="../tex2png/cache/1a0afff59693f24769a720457ac57f44.png" alt=" \phi (5)=4. "><p></p><p><h2 style="padding-top:40px;"> Свойства </h2><p>Три следующих простых свойства функции Эйлера &mdash; достаточны, чтобы научиться вычислять её для любых чисел:<p><ul><p><li>Если <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> &mdash; простое число, то <img class=tex src="../tex2png/cache/35b3d65d4b4b7f36a59c0ffb4d9c8bd9.png" alt="\phi (p)=p-1">.<p>(Это очевидно, т.к. любое число, кроме самого <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p">, взаимно просто с ним.)<p><li>Если <img class=tex src="../tex2png/cache/2f8934466bea85c9661745280df23800.png" alt="p"> &mdash; простое, <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> &mdash; натуральное число, то <img class=tex src="../tex2png/cache/9a45df37031ef09d8d100fbccd187288.png" alt="\phi (p^a)=p^a-p^{a-1}">.<p>(Поскольку с числом <img class=tex src="../tex2png/cache/91466d507d494201298e5801ccf43de1.png" alt="p^a"> не взаимно просты только числа вида <img class=tex src="../tex2png/cache/c47e0db5137b3942a5a71d5ab0eb721d.png" alt="pk"> <img class=tex src="../tex2png/cache/ce6a1611a97cbd4554a20f9737300abe.png" alt="(k \in \mathcal{N})">, которых <img class=tex src="../tex2png/cache/a803078e07bde2406610ebfd67157555.png" alt="p^a / p = p^{a-1}"> штук.)<p><li>Если <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> взаимно простые, то <img class=tex src="../tex2png/cache/bfbc97efe35696ba2081d215bf97c67c.png" alt="\phi(ab) = \phi(a) \phi(b)"> ("мультипликативность" функции Эйлера).<p>(Этот факт следует из <a href="chinese_theorem.html">китайской теоремы об остатках</a>. Рассмотрим произвольное число <img class=tex src="../tex2png/cache/b0e8614db4b9e3538d258abc685996d0.png" alt="z \le ab">. Обозначим через <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> остатки от деления <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z"> на <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> соответственно. Тогда <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z"> взаимно просто с <img class=tex src="../tex2png/cache/3698bb2e4986b233d66bcbf5f7f883a6.png" alt="ab"> тогда и только тогда, когда <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z"> взаимно просто с <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и с <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> по отдельности, или, что то же самое, <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> взаимно просто с <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> взаимно просто с <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b">. Применяя китайскую теорему об остатках, получаем, что любой паре чисел <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y"> <img class=tex src="../tex2png/cache/c121421451dd4b3346e57dc031c2901c.png" alt="(x \le a, ~ y \le b)"> взаимно однозначно соответствует число <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z"> <img class=tex src="../tex2png/cache/e0b1d81e5edffa4fb293491964168caf.png" alt="(z \le ab)">, что и завершает доказательство.)<p></ul><p>Отсюда можно получить функцию Эйлера для любого <img class=tex src="../tex2png/cache/155fd4df26627d27050c7d0b0fece491.png" alt="\it n"> через его <b>факторизацию</b> (разложение <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> на простые сомножители):<p>если<p><p class=formula><img class=tex src="../tex2png/cache/3d3e83493513e2058c3835f438a7a37b.png" alt=" n = p_1^{a_1} \cdot p_2^{a_2} \cdot \ldots \cdot [...]"></p><p>(где все <img class=tex src="../tex2png/cache/b98bee3099688d9f0572adb2ffa3ff68.png" alt="p_i"> &mdash; простые), то<p><p class=formula><img class=tex src="../tex2png/cache/146722a63b75ce3841aae9cb02f06cac.png" alt=" \phi(n) = \phi(p_1^{a_1}) \cdot \phi(p_2^{a_2}) \[...]"><br><img class=tex src="../tex2png/cache/589f0d28922891ee426452eba24e3af1.png" alt=" = (p_1^{a_1} - p_1^{a_1-1}) \cdot (p_2^{a_2} - p_[...]"><br><img class=tex src="../tex2png/cache/3ca03d151f2c44851d626e5a6c9df921.png" alt=" = n \cdot \left( 1-{1\over p_1} \right) \cdot \le[...]"><p></p><p><h2 style="padding-top:40px;"> Реализация </h2><p>Простейший код, вычисляющий функцию Эйлера, факторизуя число элементарным методом за <img class=tex src="../tex2png/cache/04cf973f41ff261d4131428451a0846e.png" alt="O (\sqrt n)">:<p><pre class="notranslate cpp"><span class="kw4">int</span> phi <span class="br0">&#40;</span><span class="kw4">int</span> n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">int</span> result <span class="sy1">=</span> n<span class="sy4">;</span>
	<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">2</span><span class="sy4">;</span> i<span class="sy2">*</span>i<span class="sy1">&lt;=</span>n<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
		<span class="kw1">if</span> <span class="br0">&#40;</span>n <span class="sy2">%</span> i <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
			<span class="kw1">while</span> <span class="br0">&#40;</span>n <span class="sy2">%</span> i <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>
				n <span class="sy2">/</span><span class="sy1">=</span> i<span class="sy4">;</span>
			result <span class="sy2">-</span><span class="sy1">=</span> result <span class="sy2">/</span> i<span class="sy4">;</span>
		<span class="br0">&#125;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>n <span class="sy1">&gt;</span> <span class="nu0">1</span><span class="br0">&#41;</span>
		result <span class="sy2">-</span><span class="sy1">=</span> result <span class="sy2">/</span> n<span class="sy4">;</span>
	<span class="kw1">return</span> result<span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p>Ключевое место для вычисление функции Эйлера &mdash; это нахождение <b>факторизации</b> числа <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">. Его можно осуществить за время, значительно меньшее <img class=tex src="../tex2png/cache/e89d540813b771cb61aba6ca1d79b86e.png" alt="O(\sqrt{n})">: см. <a href="factorization.html">Эффективные алгоритмы факторизации</a>.<p><p><h2 style="padding-top:40px;"> Приложения функции Эйлера </h2><p>Самое известное и важное свойство функции Эйлера выражается в <b>теореме Эйлера</b>:<p class=formula><img class=tex src="../tex2png/cache/dd54e3a4495b866d067e85424d76e0f3.png" alt=" a^{\phi(m)} \equiv 1 \pmod m, "></p>где <img class=tex src="../tex2png/cache/d81d59b834ab57fe6530f94e0696deaf.png" alt="\it a"> и <img class=tex src="../tex2png/cache/d389afcf9c1cdc2bfd9f10bc3b6b988a.png" alt="\it m"> взаимно просты.<p>В частном случае, когда <img class=tex src="../tex2png/cache/d389afcf9c1cdc2bfd9f10bc3b6b988a.png" alt="\it m"> простое, теорема Эйлера превращается в так называемую <b>малую теорему Ферма</b>:<p class=formula><img class=tex src="../tex2png/cache/68bd40b34bc2c510b5c0ff6052263c23.png" alt=" a^{m-1} \equiv 1  \pmod m "></p><p>Теорема Эйлера достаточно часто встречается в практических приложениях, например, см. <a href="reverse_element.html">Обратный элемент в поле по модулю</a>.<p><p><h2 style="padding-top:40px;"> Задачи в online judges </h2><p>Список задач, в которых требуется посчитать функцию Эйлера,либо воспользоваться теоремой Эйлера, либо по значению функции Эйлера восстанавливать исходное число:<p><ul><p><li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1120">UVA #10179 <b>"Irreducible Basic Fractions"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: низкая]</a><p><li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&page=show_problem&problem=1240">UVA #10299 <b>"Relatives"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: низкая]</a><p><li><a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=2302">UVA #11327 <b>"Enumerating Rational Numbers"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: средняя]</a><p><li><a href="http://acm.timus.ru/problem.aspx?space=1&num=1673">TIMUS #1673 <b>"Допуск к экзамену"</b> &nbsp;&nbsp;&nbsp;&nbsp; [сложность: высокая]</a><p></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>