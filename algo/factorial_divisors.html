<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Нахождение степени делителя факториала</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jul 2008 13:58<br>редактировано: 27 May 2012 17:55</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="factorial_divisors.html#" id="contents-hide">[скрыть]</a><a href="factorial_divisors.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Нахождение степени делителя факториала </h1><p>Даны два числа: <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> и <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">. Требуется посчитать, с какой степенью делитель <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> входит в число <img class=tex src="../tex2png/cache/7256a61e63bdcff610d0e712a6b2a485.png" alt="n!">, т.е. найти наибольшее <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> такое, что <img class=tex src="../tex2png/cache/7256a61e63bdcff610d0e712a6b2a485.png" alt="n!"> делится на <img class=tex src="../tex2png/cache/6eb3b04fdba1cc0a3ac5dc3758ef58c2.png" alt="k^x">.<p><p><h2 style="padding-top:40px;"> Решение для случая простого <img class=tex src="../tex2png/cache/336a051837a2ed662422914225a362d0.png" alt="k"> </h2><p>Рассмотрим сначала случай, когда <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> простое.<p>Выпишем выражение для факториала в явном виде:<p><p class=formula><img class=tex src="../tex2png/cache/684b48935745d6363de72245d852a91e.png" alt=" n! = 1\ 2\ 3\ \ldots\ (n-1)\ n "></p><p>Заметим, что каждый <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">-ый член этого произведения делится на <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">, т.е. даёт +1 к ответу; количество таких членов равно <img class=tex src="../tex2png/cache/5c07f2a63a57214f745fed3574d77090.png" alt="\lfloor n/k \rfloor">.<p>Далее, заметим, что каждый <img class=tex src="../tex2png/cache/b459e6813a3a82cd3920ad3372eefaab.png" alt="k^2">-ый член этого ряда делится на <img class=tex src="../tex2png/cache/b459e6813a3a82cd3920ad3372eefaab.png" alt="k^2">, т.е. даёт ещё +1 к ответу (учитывая, что <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> в первой степени уже было учтено до этого); количество таких членов равно <img class=tex src="../tex2png/cache/0365c674224cd8948cac3cfdacae743d.png" alt="\lfloor n/k^2 \rfloor">.<p>И так далее, каждый <img class=tex src="../tex2png/cache/e29e216481293f1eb3c9c0161faa278d.png" alt="k^i">-ый член ряда даёт +1 к ответу, а количество таких членов равно <img class=tex src="../tex2png/cache/16506adc9e3d062365f9b5fcbee1e01c.png" alt="\lfloor n/k^i \rfloor">.<p>Таким образом, ответ равен величине:<p class=formula><img class=tex src="../tex2png/cache/937f7e1100fb720eb0a2f22ef574eabb.png" alt=" \frac{n}{k} + \frac{n}{k^2} + \ldots + \frac{n}{k[...]"></p><p>Эта сумма, разумеется, не бесконечная, т.к. только первые примерно <img class=tex src="../tex2png/cache/9c9fce1597a71ebea27f027db3b24a42.png" alt="\log_k n"> членов отличны от нуля. Следовательно, асимптотика такого алгоритма равна <img class=tex src="../tex2png/cache/ebdf6041a9f16b0fc40d2c809b94c3c9.png" alt="O(\log_k n)">.<p>Реализация:<p><pre class="notranslate cpp"><span class="kw4">int</span> fact_pow <span class="br0">&#40;</span><span class="kw4">int</span> n, <span class="kw4">int</span> k<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">int</span> res <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
	<span class="kw1">while</span> <span class="br0">&#40;</span>n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
		n <span class="sy2">/</span><span class="sy1">=</span> k<span class="sy4">;</span>
		res <span class="sy2">+</span><span class="sy1">=</span> n<span class="sy4">;</span>
	<span class="br0">&#125;</span>
	<span class="kw1">return</span> res<span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p><p><h2 style="padding-top:40px;"> Решение для случая составного <img class=tex src="../tex2png/cache/336a051837a2ed662422914225a362d0.png" alt="k"> </h2><p>Ту же идею применить здесь непосредственно уже нельзя.<p>Но мы можем факторизовать <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">, решить задачу для каждого его простого делителя, а потом выбрать минимум из ответов.<p>Более формально, пусть <img class=tex src="../tex2png/cache/3f5a403f96bd6eec290ef2e1d7e06413.png" alt="k_i"> &mdash; это <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ый делитель числа <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">, входящий в него в степени <img class=tex src="../tex2png/cache/b98bee3099688d9f0572adb2ffa3ff68.png" alt="p_i">. Решим задачу для <img class=tex src="../tex2png/cache/3f5a403f96bd6eec290ef2e1d7e06413.png" alt="k_i"> с помощью вышеописанной формулы за <img class=tex src="../tex2png/cache/f164aa195cc12acf4e3719819f08c698.png" alt="O (\log n)">; пусть мы получили ответ <img class=tex src="../tex2png/cache/922e33dc697634ccc7e72d955d6259c2.png" alt="{\rm Ans}_i">. Тогда ответом для составного <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> будет минимум из величин <img class=tex src="../tex2png/cache/2546470bca97b6a2f61ca11d707ec75d.png" alt="{\rm Ans}_i / p_i">.<p>Учитывая, что факторизация простейшим образом выполняется за <img class=tex src="../tex2png/cache/1ad580f765f143f18afc4e44d85889c4.png" alt="O (\sqrt{k})">, получаем итоговую асимптотику <img class=tex src="../tex2png/cache/1ad580f765f143f18afc4e44d85889c4.png" alt="O (\sqrt{k})">.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>