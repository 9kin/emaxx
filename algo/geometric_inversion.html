<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Преобразование геометрической инверсии</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 14 Sep 2010 2:07<br>редактировано: 6 Jan 2011 1:11</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="geometric_inversion.html#" id="contents-hide">[скрыть]</a><a href="geometric_inversion.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Преобразование геометрической инверсии </h1><p>Преобразование геометрической инверсии (inversive geometry) &mdash; это особый тип преобразования точек на плоскости. Практическая польза этого преобразования в том, что зачастую оно позволяет свести решение геометрической задачи <b>с окружностями</b> к решению соответствующей задачи <b>с прямыми</b>, которая обычно имеет гораздо более простое решение.<p>По всей видимости, основоположником этого направления математики был Людвиг Иммануэль Магнус (Ludwig Immanuel Magnus), который в 1831 г. опубликовал статью об инверсных преобразованиях.<p><p><h2 style="padding-top:40px;"> Определение </h2><p>Зафиксируем окружность с центром в точке <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> радиуса <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r">. Тогда <b>инверсией</b> точки <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> относительно этой окружности называется такая точка <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime">, которая лежит на луче <img class=tex src="../tex2png/cache/ad6b145920a6164e070785a2b60f329f.png" alt="OP">, а на расстояние наложено условие:<p><p class=formula><img class=tex src="../tex2png/cache/d86c0c8a5b1c830e97d95f986e6e69d8.png" alt=" OP \cdot OP^\prime = r^2. "></p><p><img src="inversion_3.png"><p>Если считать, что центр <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> окружности совпадает с началом координат, то можно сказать, что точка <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime"> имеет тот же полярный угол, что и <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">, а расстояние вычисляется по указанной выше формуле.<p>В терминах <b>комплексных чисел</b> преобразование инверсии выражается достаточно просто, если считать, что центр <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> окружности совпадает с началом координат:<p><p class=formula><img class=tex src="../tex2png/cache/3cd4236c03e25363495db93fc282e963.png" alt=" z^\prime = r^2 \cdot \frac{ z }{ |z|^2 }. "></p><p>С помощью сопряжённого элемента <img class=tex src="../tex2png/cache/4e3e2b2779ab96c5fc182ca66fbeb850.png" alt="\overline{z}"> можно получить более простую форму:<p><p class=formula><img class=tex src="../tex2png/cache/2d03ab53011cd7899cce63f5a54c9575.png" alt=" z^\prime = \frac{ r^2 }{ \overline{z} }. "></p><p>Применение инверсии (в точке-середине доски) к изображению шахматной доски даёт интересную картинку (справа):<p><img src="inversion_9.png"><p><p><h2 style="padding-top:40px;"> Свойства </h2><p>Очевидно, что любая точка, лежащая <b>на окружности</b>, относительно которой производится преобразование инверсии, при отображении переходит в себя же. Любая точка, лежащая <b>внутри</b> окружности, переходит во <b>внешнюю</b> область, и наоборот. Считается, что центр окружности переходит в точку "бесконечность" <img class=tex src="../tex2png/cache/3d40198f44abce2dbb7a7eb7fba559c9.png" alt="\infty">, а точка "бесконечность" &mdash; наоборот, в центр окружности:<p><p class=formula><img class=tex src="../tex2png/cache/228f538331a452c84d54427762439d0f.png" alt=" (O)^\prime = \infty, "><br><img class=tex src="../tex2png/cache/1eff5e1a028e01e63cb4247b65867523.png" alt=" (\infty)^\prime = O. "></p><p>Очевидно, что повторное применение преобразования инверсии <b>обращает</b> первое её применение &mdash; все точки возвращаются обратно:<p><p class=formula><img class=tex src="../tex2png/cache/37844505793b9fcbf2b963afd510df76.png" alt=" \left( P^\prime \right) ^\prime \equiv P. "><p></p><p><h3 style="padding-top:15px;"> Обобщённые окружности </h3><p>Обобщённая окружность &mdash; это либо окружность, либо прямая (считается, что это тоже окружность, но имеющая бесконечный радиус).<p>Ключевое свойство преобразования инверсии &mdash; что при его применении обобщённая окружность <b>всегда переходит в обобщённую окружность</b> (подразумевается, что преобразование инверсии поточечно применяется ко всем точкам фигуры).<p>Сейчас мы увидим, что именно происходит с прямыми и окружностями при преобразовании инверсии.<p><p><h3 style="padding-top:15px;"> Инверсия прямой, проходящей через точку <img class=tex src="../tex2png/cache/6a7e44a61e0c2fd8166d09fa3e85251f.png" alt="O"> </h3><p>Утверждается, что любая прямая, проходящая через <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, после преобразования инверсии <b>не меняется</b>.<p>В самом деле, любая точка этой прямой, кроме <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> и <img class=tex src="../tex2png/cache/3d40198f44abce2dbb7a7eb7fba559c9.png" alt="\infty">, переходит по определению тоже в точку этой прямой (причём в итоге получившиеся точки заполнят всю прямую целиком, поскольку преобразование инверсии обратимо). Остаются точки <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> и <img class=tex src="../tex2png/cache/3d40198f44abce2dbb7a7eb7fba559c9.png" alt="\infty">, но при инверсии они переходят друг в друга, поэтому доказательство завершено.<p><p><h3 style="padding-top:15px;"> Инверсия прямой, не проходящей через точку <img class=tex src="../tex2png/cache/6a7e44a61e0c2fd8166d09fa3e85251f.png" alt="O"> </h3><p>Утверждается, что любая такая прямая перейдёт <b>в окружность</b>, проходящую через <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">.<p><img src="inversion_4.png"><p>Рассмотрим любую точку <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> этой прямой, и рассмотрим также точку <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q"> &mdash; ближайшую к <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> точку прямой. Понятно, что отрезок <img class=tex src="../tex2png/cache/933a9a95d2db6d72ee5c960290cd76d1.png" alt="OQ"> перпендикулярен прямой, а потому образуемый им угол <img class=tex src="../tex2png/cache/7689b02a0853567b458916f5b61f9c5d.png" alt="\angle PQO"> &mdash; прямой.<p>Воспользуемся теперь <b>леммой о равных углах</b>, которую мы докажем чуть позже, эта лемма даёт нам равенство:<p><p class=formula><img class=tex src="../tex2png/cache/197dd00b2a4b2df0163f6b8815ca21f6.png" alt=" \angle PQO = \angle Q^\prime P^\prime O. "></p><p>Следовательно, угол <img class=tex src="../tex2png/cache/dd3b8ff2d50b8eac796ea181bde18932.png" alt="\angle Q^\prime P^\prime O"> тоже прямой. Поскольку мы брали точку <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> любой, то получается, что точка <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime"> лежит на окружности, построенной на <img class=tex src="../tex2png/cache/859232b0b7f544352deca3769fd52b74.png" alt="O Q^\prime"> как на диаметре. Легко понять, что в итоге все точки прямой покроют всю эту окружность целиком, следовательно, утверждение доказано.<p><p><h3 style="padding-top:15px;"> Инверсия окружности, проходящей через точку <img class=tex src="../tex2png/cache/6a7e44a61e0c2fd8166d09fa3e85251f.png" alt="O"> </h3><p>Любая такая окружность перейдёт <b>в прямую</b>, не проходящую через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">.<p>В самом деле, это сразу следует из предыдущего пункта, если мы вспомним об обратимости преобразования инверсии.<p><p><h3 style="padding-top:15px;"> Инверсия окружности, не проходящей через точку <img class=tex src="../tex2png/cache/6a7e44a61e0c2fd8166d09fa3e85251f.png" alt="O"> </h3><p>Любая такая окружность перейдёт <b>в окружность</b>, по-прежнему не проходящую через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">.<p><img src="inversion_5.png"><p>В самом деле, рассмотрим любую такую окружность <img class=tex src="../tex2png/cache/6008744c03ea12dc6aa14f3594eb9f61.png" alt="Z"> с центром в точке <img class=tex src="../tex2png/cache/2b1c298c3527edc9cd32927d7c006a27.png" alt="O_2">. Соединим центры <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> и <img class=tex src="../tex2png/cache/2b1c298c3527edc9cd32927d7c006a27.png" alt="O_2"> окружностей прямой; эта прямая пересечёт окружность <img class=tex src="../tex2png/cache/6008744c03ea12dc6aa14f3594eb9f61.png" alt="Z"> в двух точках <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> и <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> (очевидно, <img class=tex src="../tex2png/cache/8ff3c8f3dbae7551bd21921bd670a7c2.png" alt="ST"> &mdash; диаметр <img class=tex src="../tex2png/cache/6008744c03ea12dc6aa14f3594eb9f61.png" alt="Z">).<p>Теперь рассмотрим любую точку <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">, лежающую на окружности <img class=tex src="../tex2png/cache/6008744c03ea12dc6aa14f3594eb9f61.png" alt="Z">. Угол <img class=tex src="../tex2png/cache/48065f7b9a3efe951afbf7d45fd26664.png" alt="\angle SPT"> прямой для любой такой точки, но по следствию из <b>леммы о равных углах</b> также прямым должен быть и угол <img class=tex src="../tex2png/cache/d1efdc4968456d442c594335f0e6291e.png" alt="\angle S^\prime P^\prime T^\prime">, откуда и следует, что точка <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime"> лежит на окружности, построенной на отрезке <img class=tex src="../tex2png/cache/57dc71ce069ae5290d42ba80a25caa3a.png" alt="S^\prime T^\prime"> как на диаметре. Опять же, легко понять, что все образы <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime"> в итоге покроют эту окружность.<p>Понятно, что эта новая окружность не может проходить через <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">: иначе бы точка <img class=tex src="../tex2png/cache/3d40198f44abce2dbb7a7eb7fba559c9.png" alt="\infty"> должна была бы принадлежать старой окружности.<p><p><h3 style="padding-top:15px;"> Лемма о равных углах </h3><p>Это вспомогательное свойство, которое было использовано выше при анализе результатов преобразования инверсии.<p><h4> Формулировка </h4><p>Рассмотрим любые две точки <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> и <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q">, и применим к ним преобразование инверсии, получим точки <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime"> и <img class=tex src="../tex2png/cache/9a1915f49bb96b3b58208ce0e092a27a.png" alt="Q^\prime">. Тогда следующие углы равны:<p><p class=formula><img class=tex src="../tex2png/cache/781f02bba8af1260d2b3ba7f5c7fa95e.png" alt=" \angle PQO = \angle Q^\prime P^\prime O, "><br><img class=tex src="../tex2png/cache/788f940bf0e11daadc8be325600216da.png" alt=" \angle QPO = \angle P^\prime Q^\prime O. "></p><p><h4> Доказательство </h4><p>Докажем, что треугольники <img class=tex src="../tex2png/cache/14c7cc60e84721f8e0fcc945bd8b6f37.png" alt="\triangle PQO"> и <img class=tex src="../tex2png/cache/11b7a18bcc7f1eb9fb95c7a0c5d3d092.png" alt="\triangle Q^\prime P^\prime O"> подобны (порядок вершин важен!).<p><img src="inversion_1.png"><p>В самом деле, по определению преобразования инверсии имеем:<p><p class=formula><img class=tex src="../tex2png/cache/ebf1ff8f03cf1e5a688bf352345baaa8.png" alt=" OP \cdot OP^\prime = r^2, "><br><img class=tex src="../tex2png/cache/7240c9376d5614ddf492ff3621dcb171.png" alt=" OQ \cdot OQ^\prime = r^2, "></p><p>откуда получаем равенство:<p><p class=formula><img class=tex src="../tex2png/cache/5394d3b8b5b444c7019e1239e04ff514.png" alt=" OP \cdot OP^\prime = OQ \cdot OQ^\prime, "><br><img class=tex src="../tex2png/cache/3f013f9f64b3487b0985f3f366789221.png" alt=" \frac{ OP }{ OQ } = \frac{ OQ^\prime }{ OP^\prime[...]"></p><p>Таким образом, треугольники <img class=tex src="../tex2png/cache/14c7cc60e84721f8e0fcc945bd8b6f37.png" alt="\triangle PQO"> и <img class=tex src="../tex2png/cache/11b7a18bcc7f1eb9fb95c7a0c5d3d092.png" alt="\triangle Q^\prime P^\prime O"> имеют общий угол, а две прилежащие к нему стороны пропорциональны, следовательно, эти треугольники подобны, а потому соответствующие углы совпадают.<p><h4> Следствие из леммы </h4><p>Если даны любые три точки <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">, <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q">, <img class=tex src="../tex2png/cache/4f3105397250ea0969b057bde4dfb244.png" alt="R">, причём точка <img class=tex src="../tex2png/cache/4f3105397250ea0969b057bde4dfb244.png" alt="R"> лежит на отрезке <img class=tex src="../tex2png/cache/933a9a95d2db6d72ee5c960290cd76d1.png" alt="OQ">, то выполняется:<p><p class=formula><img class=tex src="../tex2png/cache/38dbb8f0431922c9dd1eb8e441832575.png" alt=" \angle QPR = \angle Q^\prime P^\prime R^\prime, "></p><p>причём эти углы ориентированы в разные стороны (т.е. если рассматривать эти два угла как ориентированные, то они разного знака).<p><img src="inversion_2.png"><p>Для доказательства заметим, что <img class=tex src="../tex2png/cache/6a114f34504b8962aeaa67ebc87b6474.png" alt="\angle QPR"> &mdash; это разность двух углов <img class=tex src="../tex2png/cache/7951e30c879b0b7cc1306be7c34e1bf1.png" alt="\angle QPO"> и <img class=tex src="../tex2png/cache/6ed12582d6f3ea782a794104ad64cad7.png" alt="\angle RPO">, к каждому из которых можно применить лемму о равных углах:<p><p class=formula><img class=tex src="../tex2png/cache/727d17b772267435a1af1f8e244b6675.png" alt=" \angle QPR = \angle QPO - \angle RPO = \angle P^\[...]"></p><p>При осуществлении последнего перехода мы изменили порядок следования точек, что и означает, что мы изменили ориентацию угла на противоположную.<p><p><h3 style="padding-top:15px;"> Конформность </h3><p>Преобразование инверсии является конформным, т.е. <b>сохраняет углы в точках пересечения кривых</b>. При этом, если углы рассматривать как ориентированные, то ориентация углов при применении инверсии изменяется на противоположную.<p><img src="inversion_6.png"><p>Для <b>доказательства</b> этого рассмотрим две произвольные кривые, пересекающиеся в точке <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> и имеющие в ней касательные. Пусть по первой кривой будет идти точка <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q">, по второй &mdash; точка <img class=tex src="../tex2png/cache/4f3105397250ea0969b057bde4dfb244.png" alt="R"> (мы их устремим в пределе к <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">).<p>Очевидно, что после применения инверсии кривые будут по-прежнему пересекаться (если, конечно, они не проходили через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, но такой случай мы не рассматриваем), и точкой их пересечения будет <img class=tex src="../tex2png/cache/3f4b00ceb5f28bb8722a58c043a9b510.png" alt="P^\prime">.<p>Учитывая, что точка <img class=tex src="../tex2png/cache/4f3105397250ea0969b057bde4dfb244.png" alt="R"> лежит на прямой, соединяющей <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> и <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q">, получаем, что можем применить следствие из леммы о равных углах, из которой мы получаем:<p><p class=formula><img class=tex src="../tex2png/cache/3c8769e5694787d74ad1c2ab90a56e40.png" alt=" \angle QPR = - \angle Q^\prime P^\prime R^\prime,[...]"></p><p>где под знаком "минус" мы понимаем то, что углы ориентированы в разных направлениях.<p>Устремляя точки <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q"> и <img class=tex src="../tex2png/cache/4f3105397250ea0969b057bde4dfb244.png" alt="R"> к точке <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P">, мы в пределе получаем, что это равенство &mdash; выражение угла между пересекающимися кривыми, что и требовалось доказать.<p><p><h3 style="padding-top:15px;"> Свойство отражения </h3><p>Если <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> &mdash; обобщённая окружность, то при преобразовании инверсии она <b>сохраняется</b> тогда и только тогда, когда <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> <b>ортогональна</b> окружности <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C">, относительно которой производится инверсия (<img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> и <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> считаются различными).<p>Доказательство этого свойства интересно тем, что оно <b>демонстрирует</b> применение геометрической инверсии для ухода от окружностей и упрощения задачи.<p>Первым шагом <b>доказательства</b> будет указание того факта, что <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> и <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> имеют как минимум две точки пересечения. В самом деле, преобразование инверсии относительно <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> отображает внутренность окружности в её внешность, и наоборот. Раз <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> после преобразования не изменилась, то значит, она содержит точки как из внутренности, так и из внешности окружности <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C">. Отсюда и следует, что точек пересечения две (одна она быть не может &mdash; это означает касание двух окружностей, но этого случая, очевидно, быть по условию не может; совпадать окружности также не могут по определению).<p>Обозначим одну точку пересечения через <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">, другую &mdash; через <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">. Рассмотрим произвольную окружность с центром в точке <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">, и выполним преобразование инверсии относительно неё. Заметим, что тогда и окружность <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C">, и обобщённая окружность <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> необходимо переходят в пересекающиеся прямые. Учитывая конформность преобразования инверсии, получаем, что <img class=tex src="../tex2png/cache/1cd011e00eb4014fe99892f5ffbf5abd.png" alt="M"> и <img class=tex src="../tex2png/cache/6fa3b7b1df2447aac8af9a78f6c8751c.png" alt="M^\prime"> совпадали тогда и только тогда, когда угол между двумя этими пересекающимися прямыми прямой (в самом деле, первое преобразование инверсии, &mdash; относительно <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C">, &mdash; изменяет направление угла между окружностями на противоположное, поэтому если окружность совпадает со своей инверсией, то углы между пересекающимися прямыми с обеих сторон должны совпадать, и равны <img class=tex src="../tex2png/cache/ccbc413a483472217630d70616ea899e.png" alt="\frac{ 180 }{ 2 } = 90"> градусов).<p><p><h2 style="padding-top:40px;"> Практическое применение </h2><p>Сразу стоит отметить, что при применении в расчётах нужно учитывать большую <b>погрешность</b>, вносимую преобразованием инверсии: могут появляться дробные числа весьма малых порядков, и обычно из-за высокой погрешности метод инверсии хорошо работает только со сравнительно небольшими координатами.<p><p><h3 style="padding-top:15px;"> Построение фигур после инверсии </h3><p>В программных вычислениях зачастую более удобно и надёжно использовать не готовые формулы для координат и радиусов получающихся обобщённых окружностей, а восстанавливать каждый раз прямые/окружности по двумя точкам. Если для восстановления прямой достаточно взять любые две точки и вычислить их образы и соединить прямой, то с окружностями всё гораздо сложнее.<p>Если мы хотим найти окружность, получившуюся в результате инверсии прямой, то, согласно приведённым выше выкладкам, надо найти ближайшую к центру инверсии точку <img class=tex src="../tex2png/cache/c81650f5b09e29586f6c77c5325ac538.png" alt="Q"> прямой, применить к ней инверсию (получив некую точку <img class=tex src="../tex2png/cache/9a1915f49bb96b3b58208ce0e092a27a.png" alt="Q^\prime">), и тогда искомая окружность будет иметь диаметр <img class=tex src="../tex2png/cache/859232b0b7f544352deca3769fd52b74.png" alt="O Q^\prime">.<p>Пусть теперь мы хотим найти окружность, получившуюся в результате инверсии другой окружности. Вообще говоря, центр новой окружности &mdash; не совпадает с образом центра старой окружности. Для определения центра новой окружности можно воспользоваться таким приёмом: провести через центр инверсии и центр старой окружности прямую, посмотреть её точки пересечения со старой окружностью, &mdash; пусть это будут точки <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> и <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">. Отрезок <img class=tex src="../tex2png/cache/8ff3c8f3dbae7551bd21921bd670a7c2.png" alt="ST"> образует диаметр старой окружности, и легко понять, что после инверсии этот отрезок по-прежнему будет образовывать диаметр. Следовательно, центр новой окружности можно найти как среднее арифметическое точек <img class=tex src="../tex2png/cache/b12cfe80a3f885976ecf4a0ff79725e8.png" alt="S^\prime"> и <img class=tex src="../tex2png/cache/8b76c2fbba6f73909688cf09bde99121.png" alt="T^\prime">.<p><p><h3 style="padding-top:15px;"> Параметры окружности после инверсии </h3><p>Требуется по заданной окружности (по известным координатам её центра <img class=tex src="../tex2png/cache/802e57a22add7d3b409c069862e15e82.png" alt="(x_0,y_0)"> и радиусу <img class=tex src="../tex2png/cache/8b5006adf8ef37bdaa0a64235f263743.png" alt="r_0">) определить, в какую именно окружность она перейдёт после преобразования инверсии относительно окружности с центром в <img class=tex src="../tex2png/cache/c22b448e1ed7de804817187b201b493e.png" alt="(x_c,y_c)"> и радиусом <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r">.<p>Т.е. мы решаем задачу, описанную в предыдущем пункте, но хотим получить решение в аналитическом виде.<p>Ответ выглядит в виде формул:<p><p class=formula><img class=tex src="../tex2png/cache/bac599fe32a0e8ebb193392ca72ffede.png" alt=" x^\prime = x_c + s (x_0 - x_c), "><br><img class=tex src="../tex2png/cache/24077df51b86f78254af2c0523fb95df.png" alt=" y^\prime = y_c + s (y_0 - y_c), "><br><img class=tex src="../tex2png/cache/df6126b3d79dccbe0f0aa2c5df1fc20d.png" alt=" r^\prime = |s| \cdot r_0, "></p><p>где<p><p class=formula><img class=tex src="../tex2png/cache/bd909f172f598dd3df70732172a37e8b.png" alt=" s = \frac{ r^2 }{ (x_0 - x_c)^2 + (y_0 - y_c)^2 -[...]"></p><p>Мнемонически эти формулы можно запомнить так: центр окружности переходит "почти" как по преобразованию инверсии, только в знаменателе помимо <img class=tex src="../tex2png/cache/bf659cf5aaa2747137c1c6109f8fc8eb.png" alt="|z|^2 = (x_0 - x_c)^2 + (y_0 - y_c)^2"> появилось ещё вычитаемое <img class=tex src="../tex2png/cache/bb54a3c9afddd2502957f06a3f0260fb.png" alt="r_0^2">.<p>Выводятся эти формулы ровно по описанному в предыдущем пункте алгоритму: находятся выражения для двух диаметральных точек <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> и <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">, затем к ним применяется инверсия, и затем берётся среднее арифметическое от их координат. Аналогично можно посчитать и радиус как половину длины отрезка <img class=tex src="../tex2png/cache/8ff3c8f3dbae7551bd21921bd670a7c2.png" alt="ST">.<p><p><h3 style="padding-top:15px;"> Применение в доказательствах: задача о разбиении точек окружностью </h3><p>Даны <img class=tex src="../tex2png/cache/02f3339bd527ea60f4b8a5fcb94023f1.png" alt="2n"> различных точек на плоскости, а также произвольная точка <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, отличная от всех остальных. Доказать, что найдётся окружность, проходящая через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, такая, что внутри и вне неё будет лежать одинаковое число точек набора, т.е. по <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> штук.<p>Для <b>доказательства</b> произведём преобразование инверсии относительно выбранной точки <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> (с любым радиусом, например, <img class=tex src="../tex2png/cache/3c14889fd7334ac877509395cab163d7.png" alt="r=1">). Тогда искомой окружности будет соответствовать прямая, не проходящая через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">. Причём по одну сторону прямой лежит полуплоскость, соответствующая внутренности окружности, а по другую &mdash; соответствующая внешности. Понятно, что всегда найдётся такая прямая, которая разбивает множество из <img class=tex src="../tex2png/cache/02f3339bd527ea60f4b8a5fcb94023f1.png" alt="2n"> точек на две половины по <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> точек, и при этом не проходит через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> (например, такую прямую можно получить, повернув всю картину на любой такой угол, чтобы ни у каких из рассматриваемых <img class=tex src="../tex2png/cache/96876279d909aa6f93cfe73be57187df.png" alt="2n+1"> точек не совпали координаты <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">, а затем просто взяв вертикальную прямую между <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">-ой и <img class=tex src="../tex2png/cache/a7f8de3dd9b0da0eb8ed96689169566e.png" alt="n+1">-ой точками). Эта прямая соответствует искомой окружности, проходящей через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, а значит, утверждение доказано.<p><p><h3 style="padding-top:15px;"> Применение при решении задач вычислительной геометрии </h3><p>Замечательное свойство геометрической инверсии &mdash; в том, что во многих случаях она позволяет упростить поставленную геометрическую задачу, заменяя рассмотрение окружностей только рассмотрением прямых.<p>Т.е. если задача имеет достаточно сложный вид различных операций с окружностями, то имеет смысл применить ко входным данным преобразование инверсии, попытаться решить полученную модифицированную задачу без окружностей (или с меньшим их числом), и затем повторным применением инверсии получить решение исходной задачи.<p>Пример такой задачи описан в следующем разделе.<p><p><h3 style="padding-top:15px;"> Цепочки Штейнера </h3><p>Даны две окружности <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> и <img class=tex src="../tex2png/cache/eb1a191fcb4a60d0abd8341d6d13e0e6.png" alt="D">, одна находится строго внутри другой. Затем рисуется третья окружность <img class=tex src="../tex2png/cache/75014114e5532780acf8715ec0ab6829.png" alt="E">, касающаяся этих двух окружностей, после чего запускается итеративный процесс: каждый раз рисуется новая окружность так, чтобы она <b>касалась</b> предыдущей нарисованной, и первых двух. Рано или поздно очередная нарисованная окружность пересечётся с какой-то из уже поставленных, или по крайней мере коснётся её.<p>Случай пересечения:<p><img src="inversion_8.png"><p>Случай касания:<p><img src="inversion_7.png"><p>Соответственно, наша задача &mdash; поставить <b>как можно больше</b> окружностей так, чтобы пересечения (т.е. первого из представленных случаев) не было. Первые две окружности (внешняя и внутренняя) фиксированы, мы можем лишь варьировать положение первой касающейся окружности, дальше все касающиеся окружности ставятся однозначно.<p>В случае касания получающая цепочка окружностей называется <b>цепочкой Штейнера</b>.<p>С этой цепочкой связано так называемое <b>утверждение Штейнера</b> (Steiner's porism): если существует хотя бы одна цепочка Штейнера (т.е. существует соответствующее положение стартовой касающейся окружности, приводящее к цепочке Штейнера), то при любом другом выборе стартовой касающейся окружности также будет получаться цепочка Штейнера, причём число окружностей в ней будет таким же.<p>Из этого утверждения следует, что и при решении задачи максимизации числа окружностей ответ не зависит от позиции первой поставленной окружности.<p><b>Доказательство</b> и конструктивный алгоритм решения следующие. Заметим, что задача имеет очень простое решение в случае, когда центры внешней и внутренней окружностей совпадают. Понятно, что в этом случае число поставленных окружностей никак не будет зависеть от первой поставленной. В этом случае все окружности имеют одинаковый радиус, и число их и координаты центров можно посчитать по простым формулам.<p>Чтобы перейти к этой простой ситуации из любой подаваемой на вход, применим преобразование инверсии относительно некоторой окружности. Нам нужно, чтобы центр внутренней окружности передвинулся и совпал с центром внешней, поэтому искать точку, относительно которой будем брать инверсию, надо только на прямой, соединяющей центры окружностей. Используя формулы для координат центра окружности после применения инверсии, можно составить уравнение на положение центра инверсии, и решить это уравнение. Тем самым мы от произвольной ситуации можем перейти к простому, симметрическому случаю, а, решив задачу для него, повторно применим преобразование инверсии и получим решение исходной задачи.<p><p><h3 style="padding-top:15px;"> Применение в технике: прямило Липкина-Поселье </h3><p>Долгое время задача преобразования кругового (вращательного) движения в прямолинейное оставалась весьма сложной в машиностроении, удавалось находить в лучшем случае приближённые решения. И лишь в 1864 г. офицер инженерного корпуса французской армии Шарль Никола Поселье (Charles-Nicolas Peaucellier) и в 1868 г. студент Чебышёва Липман Липкин (Lipman Lipkin) изобрели это устройство, основанное на идее геометрической инверсии. Устройство получило название <b>"прямило Липкина-Поселье"</b> (Peaucellier–Lipkin linkage).<p><img src="inversion_10.gif"><p>Чтобы понять работу устройства, отметим на нём несколько точек:<p><img src="inversion_11.png"><p>Точка <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> совершает вращательное движение по окружности (красного цвета), в результате чего точка <img class=tex src="../tex2png/cache/eb1a191fcb4a60d0abd8341d6d13e0e6.png" alt="D"> необходимо движется по прямой (синего цвета). Наша задача &mdash; доказать, что точка <img class=tex src="../tex2png/cache/eb1a191fcb4a60d0abd8341d6d13e0e6.png" alt="D"> &mdash; суть инверсия точки <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> относительно центра <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> с некоторым радиусом <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r">.<p>Формализуем условие задачи: что точка <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O"> жёстко закреплена, отрезки <img class=tex src="../tex2png/cache/93cf5064aa38624fde573f585d789d61.png" alt="OA"> и <img class=tex src="../tex2png/cache/29dfeefbaf287cd7214bcad6775b41d1.png" alt="OC"> совпадают, и также совпадает четвёрка отрезков <img class=tex src="../tex2png/cache/9a51958816d5650e3b69e2cd05b84323.png" alt="AB">, <img class=tex src="../tex2png/cache/a30b298915c7851f29739fc0953768ae.png" alt="BC">, <img class=tex src="../tex2png/cache/5208710f6aeeccfca4db476d19545da5.png" alt="CD">, <img class=tex src="../tex2png/cache/7972013ca6f224e945daaab70ae40cf0.png" alt="DA">. Точка <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> движется вдоль окружности, проходящей через точку <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">.<p>Для <b>доказательства</b> заметим вначале, что точки <img class=tex src="../tex2png/cache/fdce0dc9f56b80e66e4b2310347ebb3e.png" alt="O">, <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> и <img class=tex src="../tex2png/cache/eb1a191fcb4a60d0abd8341d6d13e0e6.png" alt="D"> лежат на одной прямой (это следует из равенства треугольников). Обозначим через <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> точку пересечения отрезков <img class=tex src="../tex2png/cache/9c253128c1fcbf4b6754ef7a8f7c4769.png" alt="AC"> и <img class=tex src="../tex2png/cache/934eed947634996c5fb24564750c83e3.png" alt="BD">. Введём обозначения:<p><p class=formula><img class=tex src="../tex2png/cache/faa4953943be54107bb2b1e8c71ab689.png" alt=" OB=x,~~~BP=y,~~~AP=h. "></p><p>Нам нужно показать, что величина <img class=tex src="../tex2png/cache/c7f0b2e038914fff5cb3a2e453341aa4.png" alt="OB \cdot OD = {\rm const}">:<p><p class=formula><img class=tex src="../tex2png/cache/4d00e82304515515185524d42f8e6b3c.png" alt=" OB \cdot OD = x(x+2y) = x^2 + 2xy. "></p><p>По теореме Пифагора получаем:<p><p class=formula><img class=tex src="../tex2png/cache/61a9e6f9615eb2a8882a0a08f1c8cf4b.png" alt=" OA^2 = (x+y)^2 + h^2, "><br><img class=tex src="../tex2png/cache/16e6978fb0c0f01acbab1957def116e5.png" alt=" AD^2 = y^2 + h^2. "></p><p>Возьмём разность этих двух величин:<p><p class=formula><img class=tex src="../tex2png/cache/ae1896b533c68d817e2092e4fe5b6543.png" alt=" OA^2 - AD^2 = x^2 + 2xy = OB \cdot OD. "></p><p>Таким образом, мы доказали, что <img class=tex src="../tex2png/cache/c7f0b2e038914fff5cb3a2e453341aa4.png" alt="OB \cdot OD = {\rm const}">, что и означает, что <img class=tex src="../tex2png/cache/eb1a191fcb4a60d0abd8341d6d13e0e6.png" alt="D"> &mdash; инверсия точки <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">.<p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>