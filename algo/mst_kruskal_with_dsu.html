<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Минимальное остовное дерево. Алгоритм Крускала со структурой данных 'система непересекающихся множеств'</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 22:05<br>редактировано: 3 May 2010 23:29</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="mst_kruskal_with_dsu.html#" id="contents-hide">[скрыть]</a><a href="mst_kruskal_with_dsu.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Минимальное остовное дерево. Алгоритм Крускала с системой непересекающихся множеств</h1>

<p>Постановку задачи и описание алгоритма Крускала см. <a href="mst_kruskal.html">здесь</a>.</p>
<p>Здесь будет рассмотрена реализация с использованием структуры данных <a href="dsu.html">"система непересекающихся множеств" (DSU)</a>, которая позволит достигнуть асимптотики <b>O (M log N)</b>.</p>
<h3>Описание</h3>
<p>Так же, как и в простой версии алгоритма Крускала, отсортируем все рёбра по неубыванию веса. Затем поместим каждую вершину в своё дерево (т.е. своё множество) с помощью вызова функции DSU MakeSet - на это уйдёт в сумме O (N). Перебираем все рёбра (в порядке сортировки) и для каждого ребра за O (1) определяем, принадлежат ли его концы разным деревьям (с помощью двух вызовов FindSet за O (1)). Наконец, объединение двух деревьев будет осуществляться вызовом Union - также за O (1). Итого мы получаем асимптотику O (M log N + N + M) = O (M log N).</p>
<h3>Реализация</h3>
<p>Для уменьшения объёма кода реализуем все операции не в виде отдельных функций, а прямо в коде алгоритма Крускала.</p>
<p>Здесь будет использоваться рандомизированная версия DSU.</p>
<pre>vector&lt;int> p (n);

int dsu_get (int v) {
	return (v == p[v]) ? v : (p[v] = dsu_get (p[v]));
}

void dsu_unite (int a, int b) {
	a = dsu_get (a);
	b = dsu_get (b);
	if (rand() & 1)
		swap (a, b);
	if (a != b)
		p[a] = b;
}

... в функции main(): ...

int m;
vector &lt; pair &lt; int, pair&lt;int,int> > > g; // вес - вершина 1 - вершина 2
... чтение графа ...

int cost = 0;
vector &lt; pair&lt;int,int> > res;

sort (g.begin(), g.end());
p.resize (n);
for (int i=0; i&lt;n; ++i)
	p[i] = i;
for (int i=0; i&lt;m; ++i) {
	int a = g[i].second.first,  b = g[i].second.second,  l = g[i].first;
	if (dsu_get(a) != dsu_get(b)) {
		cost += l;
		res.push_back (g[i].second);
		dsu_unite (a, b);
	}
}</pre><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>