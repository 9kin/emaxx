<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Нахождение точки пересечения двух прямых</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 10:19<br>редактировано: 7 Jul 2009 17:57</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="lines_intersection.html#" id="contents-hide">[скрыть]</a><a href="lines_intersection.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Точка пересечения прямых</h1><p>Пусть нам даны две прямые, заданные своими коэффициентами <img class=tex src="../tex2png/cache/4b1891213df57b734ad8da9f211364dc.png" alt="A_1, B_1, C_1"> и <img class=tex src="../tex2png/cache/b232278da1c588f9d66e3ffb577e9703.png" alt="A_2, B_2, C_2">. Требуется найти их точку пересечения, или выяснить, что прямые параллельны.<p><h2 style="padding-top:40px;">Решение</h2><p>Если две прямые не параллельны, то они пересекаются. Чтобы найти точку пересечения, достаточно составить из двух уравнений прямых систему и решить её:<p class=formula><img class=tex src="../tex2png/cache/f77e66a94c03f61814aa0ef92635c401.png" alt=" \cases{ A_1 x + B_1 y + C_1 = 0, \cr
A_2 x + B_2[...]"></p><p>Пользуясь формулой Крамера, сразу находим решение системы, которое и будет искомой <b>точкой пересечения</b>:<p><p class=formula><img class=tex src="../tex2png/cache/40747e199c16e822a930e6905b762826.png" alt=" x = - \frac{ \left|\matrix{C_1&B_1 \cr C_2&B_2}\r[...]"><br><img class=tex src="../tex2png/cache/dff542a7857dc0658e9f3a62aadfafd1.png" alt=" y = - \frac{ \left|\matrix{A_1&C_1 \cr A_2&C_2}\r[...]"></p><p>Если знаменатель нулевой, т.е.<p class=formula><img class=tex src="../tex2png/cache/44eb890c515406b4cd577ff25f9a58e2.png" alt=" \left|\matrix{A_1&B_1 \cr A_2&B_2}\right| = A_1 B[...]"></p>то система решений не имеет (прямые <b>параллельны</b> и не совпадают) или имеет бесконечно много (прямые <b>совпадают</b>). Если необходимо различить эти два случая, надо проверить, что коэффициенты <img class=tex src="../tex2png/cache/5572481c8713abb69ad4011419e91fc7.png" alt="C"> прямых пропорциональны с тем же коэффициентом пропорциональности, что и коэффициенты <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> и <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">, для чего достаточно посчитать два определителя, если они оба равны нулю, то прямые совпадают:<p><p class=formula><img class=tex src="../tex2png/cache/f3843941327446b308d790f179eba390.png" alt=" \left|\matrix{ A_1 & C_1 \cr A_2 & C_2 }\right|, [...]"></p><p><h2 style="padding-top:40px;">Реализация</h2><p><pre class="notranslate cpp"><span class="kw4">struct</span> pt <span class="br0">&#123;</span>
	<span class="kw4">double</span> x, y<span class="sy4">;</span>
<span class="br0">&#125;</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">struct</span> line <span class="br0">&#123;</span>
	<span class="kw4">double</span> a, b, c<span class="sy4">;</span>
<span class="br0">&#125;</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">const</span> <span class="kw4">double</span> EPS <span class="sy1">=</span> <span class="nu19">1e-9</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">double</span> det <span class="br0">&#40;</span><span class="kw4">double</span> a, <span class="kw4">double</span> b, <span class="kw4">double</span> c, <span class="kw4">double</span> d<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">return</span> a <span class="sy2">*</span> d <span class="sy2">-</span> b <span class="sy2">*</span> c<span class="sy4">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">bool</span> intersect <span class="br0">&#40;</span>line m, line n, pt <span class="sy3">&amp;</span> res<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">double</span> zn <span class="sy1">=</span> det <span class="br0">&#40;</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">&#41;</span><span class="sy4">;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">abs</span> <span class="br0">&#40;</span>zn<span class="br0">&#41;</span> <span class="sy1">&lt;</span> EPS<span class="br0">&#41;</span>
		<span class="kw1">return</span> <span class="kw2">false</span><span class="sy4">;</span>
	res.<span class="me1">x</span> <span class="sy1">=</span> <span class="sy2">-</span> det <span class="br0">&#40;</span>m.<span class="me1">c</span>, m.<span class="me1">b</span>, n.<span class="me1">c</span>, n.<span class="me1">b</span><span class="br0">&#41;</span> <span class="sy2">/</span> zn<span class="sy4">;</span>
	res.<span class="me1">y</span> <span class="sy1">=</span> <span class="sy2">-</span> det <span class="br0">&#40;</span>m.<span class="me1">a</span>, m.<span class="me1">c</span>, n.<span class="me1">a</span>, n.<span class="me1">c</span><span class="br0">&#41;</span> <span class="sy2">/</span> zn<span class="sy4">;</span>
	<span class="kw1">return</span> <span class="kw2">true</span><span class="sy4">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">bool</span> parallel <span class="br0">&#40;</span>line m, line n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">return</span> <span class="kw3">abs</span> <span class="br0">&#40;</span>det <span class="br0">&#40;</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">&lt;</span> EPS<span class="sy4">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw4">bool</span> equivalent <span class="br0">&#40;</span>line m, line n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">return</span> <span class="kw3">abs</span> <span class="br0">&#40;</span>det <span class="br0">&#40;</span>m.<span class="me1">a</span>, m.<span class="me1">b</span>, n.<span class="me1">a</span>, n.<span class="me1">b</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">&lt;</span> EPS
		<span class="sy3">&amp;&amp;</span> <span class="kw3">abs</span> <span class="br0">&#40;</span>det <span class="br0">&#40;</span>m.<span class="me1">a</span>, m.<span class="me1">c</span>, n.<span class="me1">a</span>, n.<span class="me1">c</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">&lt;</span> EPS
		<span class="sy3">&amp;&amp;</span> <span class="kw3">abs</span> <span class="br0">&#40;</span>det <span class="br0">&#40;</span>m.<span class="me1">b</span>, m.<span class="me1">c</span>, n.<span class="me1">b</span>, n.<span class="me1">c</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">&lt;</span> EPS<span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>