<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Модульное линейное уравнение первого порядка: AX=B</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jul 2008 10:35<br>редактировано: 8 Sep 2010 21:21</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="diofant_1_equation.html#" id="contents-hide">[скрыть]</a><a href="diofant_1_equation.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Модульное линейное уравнение первого порядка </h1><p><h2 style="padding-top:40px;"> Постановка задачи </h2><p>Это уравнение вида:<p><p class=formula><img class=tex src="../tex2png/cache/6ca0ab0b3fe7a560099177d0c7e3a64a.png" alt="a \cdot x = b \pmod n,"></p><p>где <img class=tex src="../tex2png/cache/afa23815c44bfd74f5ef3ca0d25ad342.png" alt="a, b, n"> &mdash; заданные целые числа, <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> &mdash; неизвестное целое число.<p>Требуется найти искомое значение <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x">, лежащее в отрезке <img class=tex src="../tex2png/cache/d802e8209f0a0199b9f99384e16f9dd9.png" alt="[0; n-1]"> (поскольку на всей числовой прямой, ясно, может существовать бесконечно много решений, которые будут отличаться друг друга на <img class=tex src="../tex2png/cache/c679035452a917adacf97de92025ac12.png" alt="n \cdot k">, где <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> &mdash; любое целое число). Если решение не единственно, то мы рассмотрим, как получить все решения.<p><p><h2 style="padding-top:40px;"> Решение с помощью нахождения Обратного элемента </h2><p>Рассмотрим сначала более простой случай &mdash; когда <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> <b>взаимно просты</b>. Тогда можно найти <a href="reverse_element.html">обратный элемент</a> к числу <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a">, и, домножив на него обе части уравнения, получить решение (и оно будет <b>единственным</b>):<p><p class=formula><img class=tex src="../tex2png/cache/964caea533eae91e4d64db8d62e730cf.png" alt="x = b \cdot a^{-1} \pmod n"></p><p>Теперь рассмотрим случай, когда <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> <b>не взаимно просты</b>. Тогда, очевидно, решение будет существовать не всегда (например, <img class=tex src="../tex2png/cache/9da8bd4ab51214f185a414c81bb5043a.png" alt="2 \cdot x = 1 \pmod 4">).<p>Пусть <img class=tex src="../tex2png/cache/0387a30d0ae1f22541a82a908e9a50c1.png" alt="g = {\rm gcd(a,n)}">, т.е. их <a href="euclid_algorithm.html">наибольший общий делитель</a> (который в данном случае больше единицы).<p>Тогда, если <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> не делится на <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">, то решения не существует. В самом деле, при любом <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> левая часть уравнения, т.е. <img class=tex src="../tex2png/cache/7144f4bc4bdbbe75a7d5114b47257709.png" alt="(a \cdot x) \pmod n">, всегда делится на <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">, в то время как правая часть на него не делится, откуда и следует, что решений нет.<p>Если же <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> делится на <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">, то, разделив обе части уравнения на это <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g"> (т.е. разделив <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a">, <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b"> и <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> на <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g">), мы придём к новому уравнению:<p><p class=formula><img class=tex src="../tex2png/cache/efbbceb5e0f4b2f9dcb87e452d3ccea1.png" alt="a^\prime \cdot x = b^\prime \pmod {n^\prime}"></p><p>в котором <img class=tex src="../tex2png/cache/78a664fd8a7739ee61682c53d726f28d.png" alt="a^\prime"> и <img class=tex src="../tex2png/cache/58a25258ba6fca08ee8773eb300146dc.png" alt="n^\prime"> уже будут взаимно просты, а такое уравнение мы уже научились решать. Обозначим его решение через <img class=tex src="../tex2png/cache/610e1474df77b6daa51545cbb716cdff.png" alt="x^\prime">.<p>Понятно, что это <img class=tex src="../tex2png/cache/610e1474df77b6daa51545cbb716cdff.png" alt="x^\prime"> будет также являться и решением исходного уравнения. Однако если <img class=tex src="../tex2png/cache/2877e51b7077a4466343fae8531125f1.png" alt="g > 1">, то оно будет <b>не единственным</b> решением. Можно показать, что исходное уравнение будет иметь ровно <img class=tex src="../tex2png/cache/016b9521e1847132b61db0423dfff527.png" alt="g"> решений, и они будут иметь вид:<p><p class=formula><img class=tex src="../tex2png/cache/3fdaa409588f818017f0c3fd482d78b2.png" alt="x_i = (x^\prime + i \cdot n^\prime) \pmod n,"><br><img class=tex src="../tex2png/cache/55d857882e906181aa592c97729d8ab9.png" alt="i = 0 \ldots (g-1)."></p><p>Подводя итог, можно сказать, что <b>количество решений</b> линейного модульного уравнения равно либо <img class=tex src="../tex2png/cache/0387a30d0ae1f22541a82a908e9a50c1.png" alt="g = {\rm gcd(a,n)}">, либо нулю.<p><h2 style="padding-top:40px;"> Решение с помощью Расширенного алгоритма Евклида </h2><p>Приведём наше модулярное уравнение к диофантову уравнению следующим образом:<p><p class=formula><img class=tex src="../tex2png/cache/93b862812ad9237a5f4bd2ec36f23b98.png" alt="a \cdot x + n \cdot k = b,"></p><p>где <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k"> &mdash; неизвестные целые числа.<p>Способ решения этого уравнения описан в соответствующей статье <a href="diofant_2_equation.html">Линейные диофантовы уравнения второго порядка</a>, и заключается он в применении <a href="extended_euclid_algorithm.html">Расширенного алгоритма Евклида</a>.<p>Там же описан и способ получения всех решений этого уравнения по одному найденному решению, и, кстати говоря, этот способ при внимательном рассмотрении абсолютно эквивалентен способу, описанному в предыдущем пункте.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>