<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Интегрирование по формуле Симпсона</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 11:13<br>редактировано: 15 Jul 2014 17:13</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="simpson_integrating.html#" id="contents-hide">[скрыть]</a><a href="simpson_integrating.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Интегрирование по формуле Симпсона</h1><p>Требуется посчитать значение определённого интеграла:<p><p class=formula><img class=tex src="../tex2png/cache/892bcc22b5048a323ab9194018a79cfe.png" alt=" \int_a^b f(x) dx "></p><p>Решение, описываемое здесь, было опубликовано в одной из диссертаций <b>Томаса Симпсона</b> (Thomas Simpson) в 1743 г.<p><p><h2 style="padding-top:40px;">Формула Симпсона</h2><p>Пусть <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> &mdash; некоторое натуральное число. Разобьём отрезок интегрирования <img class=tex src="../tex2png/cache/2876eb358dba6f6f1347e3e76bed79d6.png" alt="[a;b]"> на <img class=tex src="../tex2png/cache/02f3339bd527ea60f4b8a5fcb94023f1.png" alt="2n"> равных частей:<p><p class=formula><img class=tex src="../tex2png/cache/b0829bdc4bc60b77eb4910dac122b21d.png" alt=" x_i = a + i h,~~i = 0 \ldots 2n, "><br><img class=tex src="../tex2png/cache/1637fb2fdedc44d0038707ab86dfa483.png" alt=" h = \frac{ b-a }{ 2n }. "></p><p>Теперь посчитаем интеграл отдельно на каждом из отрезков <img class=tex src="../tex2png/cache/2c925530d34e05809b7c770b9eefdc53.png" alt="[x_{2i-2}, x_{2i}], i = 1 \ldots n">, а затем сложим все значения.<p>Итак, пусть мы рассматриваем очередной отрезок <img class=tex src="../tex2png/cache/2c925530d34e05809b7c770b9eefdc53.png" alt="[x_{2i-2}, x_{2i}], i = 1 \ldots n">. Заменим функцию <img class=tex src="../tex2png/cache/c08c01c7f11043de3440285568d82570.png" alt="f(x)"> на нём параболой, проходящей через 3 точки <img class=tex src="../tex2png/cache/80cc2ea89fd7ac13ec7304e9ec21a981.png" alt="(x_{2i-2},x_{2i-1},x_{2i})">. Такая парабола всегда существует и единственна. Её можно найти аналитически, затем останется только проинтегрировать выражение для неё, и окончательно получаем:<p><p class=formula><img class=tex src="../tex2png/cache/5297672110131bc921e4ca4aeaec0296.png" alt=" \int_{x_{2i-2}}^{x_{2i}} f(x) dx = \left( f(x_{2i[...]"></p><p>Складывая эти значения по всем отрезкам, получаем окончательную <b>формулу Симпсона</b>:<p><p class=formula><img class=tex src="../tex2png/cache/57f736489c0f6be93df8547ed89d8db7.png" alt=" \int_a^b f(x) dx = \left( f(x_0) + 4 f(x_1) + 2 f[...]"><p></p><p><h2 style="padding-top:40px;">Погрешность</h2><p>Погрешность, даваемая формулой Симпсона, не превосходит по модулю величины:<p><p class=formula><img class=tex src="../tex2png/cache/721cc96b401b4154c4732e7e1991a38a.png" alt=" \frac{ 1 }{ 180 } h^4 (b - a) \max_{a \le x \le b[...]"></p><p>Таким образом, погрешность имеет порядок уменьшения как <img class=tex src="../tex2png/cache/e1ee0b092b56f3dd3c347a13cdeabaed.png" alt="O (n^4)">.<p><p><h2 style="padding-top:40px;">Реализация</h2><p>Здесь <img class=tex src="../tex2png/cache/c08c01c7f11043de3440285568d82570.png" alt="f(x)"> &mdash; некоторая пользовательская функция.<p><pre class="notranslate cpp"><span class="kw4">double</span> a, b<span class="sy4">;</span> <span class="co1">// входные данные</span>
<span class="kw4">const</span> <span class="kw4">int</span> N <span class="sy1">=</span> <span class="nu0">1000</span><span class="sy2">*</span><span class="nu0">1000</span><span class="sy4">;</span> <span class="co1">// количество шагов (уже умноженное на 2)</span>
<span class="kw4">double</span> s <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
<span class="kw4">double</span> h <span class="sy1">=</span> <span class="br0">&#40;</span>b <span class="sy2">-</span> a<span class="br0">&#41;</span> <span class="sy2">/</span> N<span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;=</span>N<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw4">double</span> x <span class="sy1">=</span> a <span class="sy2">+</span> h <span class="sy2">*</span> i<span class="sy4">;</span>
	s <span class="sy2">+</span><span class="sy1">=</span> f<span class="br0">&#40;</span>x<span class="br0">&#41;</span> <span class="sy2">*</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>i<span class="sy1">==</span><span class="nu0">0</span> <span class="sy3">||</span> i<span class="sy1">==</span>N<span class="br0">&#41;</span> <span class="sy4">?</span> <span class="nu0">1</span> <span class="sy4">:</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>i<span class="sy3">&amp;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy1">==</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="sy4">?</span> <span class="nu0">2</span> <span class="sy4">:</span> <span class="nu0">4</span><span class="br0">&#41;</span><span class="sy4">;</span>
<span class="br0">&#125;</span>
s <span class="sy2">*</span><span class="sy1">=</span> h <span class="sy2">/</span> <span class="nu0">3</span><span class="sy4">;</span></pre><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>