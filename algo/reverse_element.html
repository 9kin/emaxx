<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Обратный элемент в кольце по модулю</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 10 Jun 2008 18:03<br>редактировано: 15 Dec 2011 21:27</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="reverse_element.html#" id="contents-hide">[скрыть]</a><a href="reverse_element.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Обратный элемент в кольце по модулю </h1><p><p><h2 style="padding-top:40px;"> Определение </h2><p>Пусть задан некоторый натуральный модуль <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">, и рассмотрим кольцо, образуемое этим модулем (т.е. состоящее из чисел от <img class=tex src="../tex2png/cache/d796aaaffd5bff4144c8ac3509c1d33d.png" alt="0"> до <img class=tex src="../tex2png/cache/2c069843c4709d96b1c8d49f2e2e99de.png" alt="m-1">). Тогда для некоторых элементов этого кольца можно найти <b>обратный элемент</b>.<p>Обратным к числу <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> по модулю <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m"> называется такое число <img class=tex src="../tex2png/cache/64e10b28938db2ba8a2b9fabb72a2cd9.png" alt="b">, что:<p><p class=formula><img class=tex src="../tex2png/cache/00a0fb73b628c52912bf70c1a70c9b2e.png" alt=" a \cdot b \equiv 1 \pmod m, "></p><p>и его нередко обозначают через <img class=tex src="../tex2png/cache/df7055e194e173b3130468fc8addb9bf.png" alt="a^{-1}">.<p>Понятно, что для нуля обратного элемента не существует никогда; для остальных же элементов обратный может как существовать, так и нет. Утверждается, что обратный существует только для тех элементов <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a">, которые <b>взаимно просты</b> с модулем <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">.<p>Рассмотрим ниже два способа нахождения обратного элемента, работающих при условии, что он существует.<p>В завершение, рассмотрим алгоритм, который позволяет найти обратные ко всех числам по некоторому модулю за линейное время.<p><p><h2 style="padding-top:40px;"> Нахождение с помощью Расширенного алгоритма Евклида </h2><p>Рассмотрим вспомогательное уравнение (относительно неизвестных <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и <img class=tex src="../tex2png/cache/e1fbf2db960f0155bd590871a486e78c.png" alt="y">):<p><p class=formula><img class=tex src="../tex2png/cache/82a0752c4953ca56ecdc4f8b18098f0a.png" alt=" a \cdot x + m \cdot y = 1. "></p><p>Это <a href="diofant_2_equation.html">линейное диофантово уравнение второго порядка</a>. Как показано в соответствующей статье, из условия <img class=tex src="../tex2png/cache/2590616769a1ce844b91b75d479411b4.png" alt="{\rm gcd}(a,m)=1"> следует, что это уравнение имеет решение, которое можно найти с помощью <a href="extended_euclid_algorithm.html">Расширенного алгоритма Евклида</a> (отсюда же, кстати говоря, следует, что когда <img class=tex src="../tex2png/cache/700a3e599b129074b83fd4ca6a087e98.png" alt="{\rm gcd}(a,m) \ne 1">, решения, а потому и обратного элемента, не существует).<p>С другой стороны, если мы возьмём от обеих частей уравнения остаток по модулю <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">, то получим:<p><p class=formula><img class=tex src="../tex2png/cache/bd0c0a7f330cc8b909fe03048fd7576e.png" alt=" a \cdot x = 1 \pmod m. "></p><p>Таким образом, найденное <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> и будет являться обратным к <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a">.<p>Реализация (с учётом того, что найденное <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> надо взять по модулю <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">, и <img class=tex src="../tex2png/cache/4a9252cee23f1a80a4e03256ef62d733.png" alt="x"> могло быть отрицательным):<p><pre class="notranslate cpp"><span class="kw4">int</span> x, y<span class="sy4">;</span>
<span class="kw4">int</span> g <span class="sy1">=</span> gcdex <span class="br0">&#40;</span>a, m, x, y<span class="br0">&#41;</span><span class="sy4">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>g <span class="sy3">!</span><span class="sy1">=</span> <span class="nu0">1</span><span class="br0">&#41;</span>
	<span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;no solution&quot;</span><span class="sy4">;</span>
<span class="kw1">else</span> <span class="br0">&#123;</span>
	x <span class="sy1">=</span> <span class="br0">&#40;</span>x <span class="sy2">%</span> m <span class="sy2">+</span> m<span class="br0">&#41;</span> <span class="sy2">%</span> m<span class="sy4">;</span>
	<span class="kw3">cout</span> <span class="sy1">&lt;&lt;</span> x<span class="sy4">;</span>
<span class="br0">&#125;</span></pre><p>Асимптотика этого решения получается <img class=tex src="../tex2png/cache/1598b628fc5926ef873e70421a929113.png" alt="O (\log m)">.<p><p><h2 style="padding-top:40px;"> Нахождение с помощью Бинарного возведения в степень </h2><p>Воспользуемся теоремой Эйлера:<p><p class=formula><img class=tex src="../tex2png/cache/adb5ef77937ec366d259b86c09beaee5.png" alt=" a ^ {\phi(m)} \equiv 1 \pmod m, "></p><p>которая верна как раз для случая взаимно простых <img class=tex src="../tex2png/cache/e4c9b6bf3a65f2e487e7cb3e199f2154.png" alt="a"> и <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">.<p>Кстати говоря, в случае простого модуля <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m"> мы получаем ещё более простое утверждение &mdash; малую теорему Ферма:<p><p class=formula><img class=tex src="../tex2png/cache/52eaf702af22b53abd5441ff6c5eacf5.png" alt=" a^{m-1} \equiv 1 \pmod m. "></p><p>Умножим обе части каждого из уравнений на <img class=tex src="../tex2png/cache/df7055e194e173b3130468fc8addb9bf.png" alt="a^{-1}">, получим:<p><ul><p><li>для любого модуля <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">:<p><p class=formula><img class=tex src="../tex2png/cache/207f8c5cdd743aa0d654ef3c3d7e14f2.png" alt=" a^{\phi(m)-1} \equiv a^{-1} \pmod m, "></p><p><li>для простого модуля <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">:<p><p class=formula><img class=tex src="../tex2png/cache/64bb8cc864c36349005dd353a0398d82.png" alt=" a^{m-2} \equiv a^{-1} \pmod m. "></p><p></ul><p>Таким образом, мы получили формулы для непосредственного вычисления обратного. Для практического применения обычно используют эффективный <a href="binary_pow.html">алгоритм бинарного возведения в степень</a>, который в нашем случае позволит произвести возведение в степень за <img class=tex src="../tex2png/cache/1598b628fc5926ef873e70421a929113.png" alt="O (\log m)">.<p>Этот метод представляется несколько проще описанного в предыдущем пункте, однако он требует знания значения функции Эйлера, что фактически требует факторизации модуля <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">, что иногда может оказаться весьма сложной задачей.<p>Если же факторизация числа известна, то тогда и этот метод также работает за асимптотику <img class=tex src="../tex2png/cache/1598b628fc5926ef873e70421a929113.png" alt="O (\log m)">.<p><p><h2 style="padding-top:40px;"> Нахождение всех простых по заданному модулю за линейное время </h2><p>Пусть дан простой модуль <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">. Требуется для каждого числа в отрезке <img class=tex src="../tex2png/cache/3b7c9525d0056770ca97f2bee9913b2c.png" alt="[1; m-1]"> найти обратное к нему.<p>Применяя описанные выше алгоритмы, мы получим лишь решения с асимптотикой <img class=tex src="../tex2png/cache/4e1e762af9af8ca31e5c9954bc266ee3.png" alt="O (m \log m)">. Здесь же мы приведём простое решение с асимптотикой <img class=tex src="../tex2png/cache/08faf3b47d5f052931b9f4e825287711.png" alt="O (m)">.<p><b>Решение</b> это выглядит следующим образом. Обозначим через <img class=tex src="../tex2png/cache/e85959d16890401cba9446db20b9579b.png" alt="r[i]"> искомое обратное к числу <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> по модулю <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">. Тогда для <img class=tex src="../tex2png/cache/90ba1684c1882c21a4d17a268cc62a10.png" alt="i > 1"> верно тождество:<p><p class=formula><img class=tex src="../tex2png/cache/46a0bd2083e3333979322a84e084bc45.png" alt=" r[i] = - \left\lfloor \frac{m}{i} \right\rfloor \[...]"></p><p><b>Реализация</b> этого удивительно лаконичного решения:<p><pre class="notranslate cpp">r<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">2</span><span class="sy4">;</span> i<span class="sy1">&lt;</span>m<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	r<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy1">=</span> <span class="br0">&#40;</span>m <span class="sy2">-</span> <span class="br0">&#40;</span>m<span class="sy2">/</span>i<span class="br0">&#41;</span> <span class="sy2">*</span> r<span class="br0">&#91;</span>m<span class="sy2">%</span>i<span class="br0">&#93;</span> <span class="sy2">%</span> m<span class="br0">&#41;</span> <span class="sy2">%</span> m<span class="sy4">;</span></pre><p><b>Доказательство</b> этого решения представляет из себя цепочку простых преобразований:<p>Распишем значение <img class=tex src="../tex2png/cache/dca8f599a7d92530c29bc1990421e662.png" alt="m {\rm~mod~} i">:<p><p class=formula><img class=tex src="../tex2png/cache/528c465c9a2c2ec1eb35979416c6f344.png" alt=" m {\rm~mod~} i = m - \left\lfloor \frac{m}{i} \ri[...]"></p><p>откуда, беря обе части по модулю <img class=tex src="../tex2png/cache/4f70748eaed5e0c2c70d7e899166ee1d.png" alt="m">, получаем:<p><p class=formula><img class=tex src="../tex2png/cache/858334e9bb94ed60c600b0fad0758a83.png" alt=" m {\rm~mod~} i = - \left\lfloor \frac{m}{i} \righ[...]"></p><p>Умножая обе части на обратное к <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> и обратное к <img class=tex src="../tex2png/cache/58872bedb09f01a9819588cdf624393a.png" alt="(m {\rm~mod~} i)">, получаем искомую формулу:<p><p class=formula><img class=tex src="../tex2png/cache/e96f90fd0b0e949047d30f3563df1061.png" alt=" r[i] = - \left\lfloor \frac{m}{i} \right\rfloor \[...]"></p><p>что и требовалось доказать.<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>