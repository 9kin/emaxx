<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Центры тяжести многоугольников и многогранников</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 25 Apr 2011 22:25<br>редактировано: 24 Nov 2011 0:14</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="gravity_center.html#" id="contents-hide">[скрыть]</a><a href="gravity_center.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Центры тяжести многоугольников и многогранников</h1><p><b>Центром тяжести</b> (или <b>центром масс</b>) некоторого тела называется точка, обладающая тем свойством, что если подвесить тело за эту точку, то оно будет сохранять свое положение.<p>Ниже рассмотрены двумерные и трёхмерные задачи, связанные с поиском различных центров масс &mdash; в основном с точки зрения вычислительной геометрии.<p>В рассмотренных ниже решениях можно выделить два основных <b>факта</b>. Первый &mdash; что центр масс системы материальных точек равен среднему их координат, взятых с коэффициентами, пропорциональными их массам. Второй факт &mdash; что если мы знаем центры масс двух непересекающихся фигур, то центр масс их объединения будет лежать на отрезке, соединяющем эти два центра, причём он будет делить его в то же отношении, как масса второй фигуры относится к массе первой.<p><p><h2 style="padding-top:40px;">Двумерный случай: многоугольники</h2><p>На самом деле, говоря о центре масс двумерной фигуры, можно иметь в виду одну из трёх следующих <b>задач</b>:<p><ul><li>Центр масс системы точек &mdash; т.е. вся масса сосредоточена только в вершинах многоугольника.<li>Центр масс каркаса &mdash; т.е. масса многоугольника сосредоточена на его периметре.<li>Центр масс сплошной фигуры &mdash; т.е. масса многоугольника распределена по всей его площади.</ul><p>Каждая из этих задач имеет самостоятельное решение, и будет рассмотрена ниже отдельно.<p><p><h3 style="padding-top:15px;">Центр масс системы точек</h3><p>Это самая простая из трёх задач, и её решение &mdash; известная физическая формула центра масс системы материальных точек:<p><p class=formula><img class=tex src="../tex2png/cache/2286171b604a90e59b43dde1b104d8aa.png" alt=" \vec{r_c} = \frac{ \sum\limits_i \vec{r_i} ~ m_i [...]"></p><p>где <img class=tex src="../tex2png/cache/95af43509dfcbb034613793cd3112890.png" alt="m_i"> &mdash; массы точек, <img class=tex src="../tex2png/cache/2f059f75296be82b18e61e83fefe23b1.png" alt="\vec{r_i}"> &mdash; их радиус-векторы (задающие их положение относительно начала координат), и <img class=tex src="../tex2png/cache/8669c69d275487f700577c30eb9a74ed.png" alt="\vec{r_c}"> &mdash; искомый радиус-вектор центра масс.<p>В частности, если все точки имеют одинаковую массу, то координаты центра масс есть <b>среднее арифметическое</b> координат точек. Для <b>треугольника</b> эта точка называется <b>центроидом</b> и совпадает с точкой пересечения медиан:<p><p class=formula><img class=tex src="../tex2png/cache/ad4abd54639a8d91c005945c9b5c02d3.png" alt=" \vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r[...]"></p><p>Для <b>доказательства</b> этих формул достаточно вспомнить, что равновесие достигается в такой точке <img class=tex src="../tex2png/cache/dfdd807efb7529538a677b7399fcc182.png" alt="r_c">, в которой сумма моментов всех сил равна нулю. В данном случае это превращается в условие того, чтобы сумма радиус-векторов всех точек относительно точки <img class=tex src="../tex2png/cache/dfdd807efb7529538a677b7399fcc182.png" alt="r_c">, домноженных на массы соответствующих точек, равнялась нулю:<p><p class=formula><img class=tex src="../tex2png/cache/4e68da41dd69b5c3f6f8f6caf33f6f39.png" alt=" \sum\limits_i \left( \vec{r_i} - \vec{r_c} \right[...]"></p><p>и, выражая отсюда <img class=tex src="../tex2png/cache/8669c69d275487f700577c30eb9a74ed.png" alt="\vec{r_c}">, мы и получаем требуемую формулу.<p><p><h3 style="padding-top:15px;">Центр масс каркаса</h3><p>Будем считать для простоты, что каркас однороден, т.е. его плотность везде одна и та же.<p>Но тогда каждую сторону многоугольника можно заменить одной точкой &mdash; серединой этого отрезка (т.к. центр масс однородного отрезка есть середина этого отрезка), с массой, равной длине этого отрезка.<p>Теперь мы получили задачу о системе материальных точек, и применяя к ней решение из предыдущего пункта, мы находим:<p><p class=formula><img class=tex src="../tex2png/cache/177656c0796bf0ae0789515329740fbd.png" alt=" \vec{r_c} = \frac{ \sum\limits_i \vec{r_i^\prime}[...]"></p><p>где <img class=tex src="../tex2png/cache/eccc339643d14e454f51266984e69229.png" alt="\vec{r_i^\prime}"> &mdash; точка-середина <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой стороны многоугольника, <img class=tex src="../tex2png/cache/29dd86344077e65dd6bf2875a9366f93.png" alt="l_i"> &mdash; длина <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой стороны, <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> &mdash; периметр, т.е. сумма длин сторон.<p>Для <b>треугольника</b> можно показать следующее утверждение: эта точка является <b>точкой пересечения биссектрис</b> треугольника, образованного серединами сторон исходного треугольника. (чтобы показать это, надо воспользоваться приведённой выше формулой, и затем заметить, что биссектрисы делят стороны получившегося треугольника в тех же соотношениях, что и центры масс этих сторон).<p><p><h3 style="padding-top:15px;">Центр масс сплошной фигуры</h3><p>Мы считаем, что масса распределена по фигуре однородно, т.е. плотность в каждой точке фигуры равна одному и тому же числу.<p><h4>Случай треугольника</h4><p>Утверждается, что для треугольника ответом будет всё тот же <b>центроид</b>, т.е. точка, образованная средним арифметическим координат вершин:<p><p class=formula><img class=tex src="../tex2png/cache/ad4abd54639a8d91c005945c9b5c02d3.png" alt=" \vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r[...]"></p><p><h4>Случай треугольника: доказательство</h4><p>Приведём здесь элементарное доказательство, не использующее теорию интегралов. <p>Первым подобное, чисто геометрическое, доказательство привёл Архимед, но оно было весьма сложным, с большим числом геометрических построений. Приведённое здесь доказательство взято из статьи Apostol, Mnatsakanian "Finding Centroids the Easy Way".<p>Доказательство сводится к тому, чтобы показать, что центр масс треугольника лежит на одной из медиан; повторяя этот процесс ещё дважды, мы тем самым покажем, что центр масс лежит в точке пересечения медиан, которая и есть центроид.<p>Разобьём данный треугольник <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> на четыре, соединив середины сторон, как показано на рисунке:<p><img src="centroids_1.jpg"><p>Четыре получившихся треугольника подобны треугольнику <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> с коэффициентом <img class=tex src="../tex2png/cache/e8c10a24565fd4a9da8e3ea9e464fec9.png" alt="1/2">.<p>Треугольники №1 и №2 вместе образуют параллелограмм, центр масс которого <img class=tex src="../tex2png/cache/58390d91c72a3448176ac07726eb622b.png" alt="c_{12}"> лежит в точке пересечения его диагоналей (поскольку это фигура, симметричная относительно обеих диагоналей, а, значит, её центр масс обязан лежать на каждой из двух диагоналей). Точка <img class=tex src="../tex2png/cache/58390d91c72a3448176ac07726eb622b.png" alt="c_{12}"> находится посередине общей стороны треугольников №1 и №2, а также лежит на медиане треугольника <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">:<p><img src="centroids_2.jpg"><p>Пусть теперь вектор <img class=tex src="../tex2png/cache/e77f13f6d02eabc9ec2e5ced8ce6cd22.png" alt="\vec{r}"> &mdash; вектор, проведённый из вершины <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> к центру масс <img class=tex src="../tex2png/cache/b06d49dbb8e3290786f17ec1eb3a24d7.png" alt="c_1"> треугольника №1, и пусть вектор <img class=tex src="../tex2png/cache/c7813586615133f30dc6bea31d47d020.png" alt="\vec{m}"> &mdash; вектор, проведённый из <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> к точке <img class=tex src="../tex2png/cache/58390d91c72a3448176ac07726eb622b.png" alt="c_{12}"> (которая, напомним, является серединой стороны, на которой она лежит):<p><img src="centroids_3.jpg"><p>Наша цель &mdash; показать, что вектора <img class=tex src="../tex2png/cache/e77f13f6d02eabc9ec2e5ced8ce6cd22.png" alt="\vec{r}"> и <img class=tex src="../tex2png/cache/c7813586615133f30dc6bea31d47d020.png" alt="\vec{m}"> коллинеарны.<p>Обозначим через <img class=tex src="../tex2png/cache/b6cdefa6632857f6103c69e89d63959b.png" alt="c_3"> и <img class=tex src="../tex2png/cache/fa7e7d621fc814616d39ab07ab2122b0.png" alt="c_4"> точки, являющиеся центрами масс треугольников №3 и №4. Тогда, очевидно, центром масс совокупности этих двух треугольников будет точка <img class=tex src="../tex2png/cache/23a227f74feb4eedcf0c70ea6ab2a5a2.png" alt="c_{34}">, являющаяся серединой отрезка <img class=tex src="../tex2png/cache/9b19f5c25331fe6a005fb01006ba1aab.png" alt="c_3 c_4">. Более того, вектор от точки <img class=tex src="../tex2png/cache/58390d91c72a3448176ac07726eb622b.png" alt="c_{12}"> к точке <img class=tex src="../tex2png/cache/23a227f74feb4eedcf0c70ea6ab2a5a2.png" alt="c_{34}"> совпадает с вектором <img class=tex src="../tex2png/cache/e77f13f6d02eabc9ec2e5ced8ce6cd22.png" alt="\vec{r}">.<p>Искомый центр масс <img class=tex src="../tex2png/cache/fdabaa70e1c423d289836bd4624e9e4e.png" alt="c"> треугольника <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> лежит посередине отрезка, соединяющего точки <img class=tex src="../tex2png/cache/58390d91c72a3448176ac07726eb622b.png" alt="c_{12}"> и <img class=tex src="../tex2png/cache/23a227f74feb4eedcf0c70ea6ab2a5a2.png" alt="c_{34}"> (поскольку мы разбили треугольник <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> на две части равных площадей: №1-№2 и №3-№4):<p><img src="centroids_4.jpg"><p>Таким образом, вектор от вершины <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> к центроиду <img class=tex src="../tex2png/cache/fdabaa70e1c423d289836bd4624e9e4e.png" alt="c"> равен <img class=tex src="../tex2png/cache/897bfceedc0f2bdf16c23b7a2b6a0912.png" alt="\vec{m} + \vec{r}/2">. С другой стороны, т.к. треугольник №1 подобен треугольнику <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> с коэффициентом <img class=tex src="../tex2png/cache/e8c10a24565fd4a9da8e3ea9e464fec9.png" alt="1/2">, то этот же вектор равен <img class=tex src="../tex2png/cache/90433486bbbfd8a677d534cddcb371e5.png" alt="2 \vec{r}">. Отсюда получаем уравнение:<p><p class=formula><img class=tex src="../tex2png/cache/0a64e37d9a9f82228c533a4c73e7b658.png" alt=" \vec{m} + \vec{r}/2 = 2 \vec{r}, "></p><p>откуда находим:<p><p class=formula><img class=tex src="../tex2png/cache/b94ea7dec62339a6463f3cf5462b8ea5.png" alt=" \vec{r} = \frac{2}{3} \vec{m}. "></p><p>Таким образом, мы доказали, что вектора <img class=tex src="../tex2png/cache/e77f13f6d02eabc9ec2e5ced8ce6cd22.png" alt="\vec{r}"> и <img class=tex src="../tex2png/cache/c7813586615133f30dc6bea31d47d020.png" alt="\vec{m}"> коллинеарны, что и означает, что искомый центроид <img class=tex src="../tex2png/cache/fdabaa70e1c423d289836bd4624e9e4e.png" alt="c"> лежит на медиане, исходящей из вершины <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">.<p>Более того, попутно мы доказали, что центроид делит каждую медиану в отношении <img class=tex src="../tex2png/cache/0b6584d85913c7cc17f605523732ffc7.png" alt="2:1">, считая от вершины.<p><p><p><h4>Случай многоугольника</h4><p>Перейдём теперь к общему случаю &mdash; т.е. к случаю <b>мноугоугольника</b>. Для него такие рассуждения уже неприменимы, поэтому сведём задачу к треугольной: а именно, разобьём многоугольник на треугольники (т.е. триангулируем его), найдём центр масс каждого треугольника, а затем найдём центр масс получившихся центров масс треугольников.<p>Окончательная формула получается следующей:<p><p class=formula><img class=tex src="../tex2png/cache/44b5988148d38a4d76586f1b0248262d.png" alt=" \vec{r_c} = \frac{ \sum\limits_i \vec{r_i^\circ} [...]"></p><p>где <img class=tex src="../tex2png/cache/5ed36e5449b294bea632dfc992d1b550.png" alt="\vec{r_i^\circ}"> &mdash; центроид <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-го треугольника в триангуляции заданного многоугольника, <img class=tex src="../tex2png/cache/7a58ee586c917a1b02226123e7191b83.png" alt="S_i"> &mdash; площадь <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-го треугольника триангуляции, <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> &mdash; площадь всего многоугольника.<p>Триангуляция выпуклого многоугольника &mdash; тривиальная задача: для этого, например, можно взять треугольники <img class=tex src="../tex2png/cache/6d57063b4ce0164a7151b9f8fab5866e.png" alt="(r_1,r_{i-1},r_i)">, где <img class=tex src="../tex2png/cache/d264c352a02d7b433a5096ff7cf21211.png" alt="i = 3 \ldots n">.<p><h4>Случай многоугольника: альтернативный способ</h4><p>С другой стороны, применение приведённой формулы не очень удобно для <b>невыпуклых многоугольников</b>, поскольку произвести их триангуляцию &mdash; сама по себе непростая задача. Но для таких многоугольников можно придумать более простой подход. А именно, проведём аналогию с тем, как можно искать площадь произвольного многоугольника: выбирается произвольная точка <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z">, а затем суммируются знаковые площади треугольников, образованных этой точкой и точками многоугольника: <img class=tex src="../tex2png/cache/e6c2a20bce878d97f631a71a2b249ce3.png" alt="S = |\sum_{i=1}^n S_{z,p_i,p_{i+1}}|">. Аналогичный приём можно применить и для поиска центра масс: только теперь мы будем суммировать центры масс треугольников <img class=tex src="../tex2png/cache/ee110d4c6dee3086ee0501ee8957b8a9.png" alt="(z,p_i,p_{i+1})">, взятых с коэффициентами, пропорциональными их площадям, т.е. итоговая формула для центра масс такова:<p><p class=formula><img class=tex src="../tex2png/cache/5c77c581a1318ebba5b4c8460fa5edb5.png" alt=" \vec{r_c} = \frac{ \sum\limits_i {\vec r}_{z,p_i,[...]"></p><p>где <img class=tex src="../tex2png/cache/bb3cdafd77b2b4bf060c2c08de238c72.png" alt="z"> &mdash; произвольная точка, <img class=tex src="../tex2png/cache/b98bee3099688d9f0572adb2ffa3ff68.png" alt="p_i"> &mdash; точки многоугольника, <img class=tex src="../tex2png/cache/817f4316d7c4bf657dc740405aec1b37.png" alt="{\vec r}_{z,p_i,p_{i+1}}^\circ"> &mdash; центроид треугольника <img class=tex src="../tex2png/cache/ee110d4c6dee3086ee0501ee8957b8a9.png" alt="(z,p_i,p_{i+1})">, <img class=tex src="../tex2png/cache/1998891dd431b40143298f5cad21a4e5.png" alt="S_{z,p_i,p_{i+1}}"> &mdash; знаковая площадь этого треугольника, <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> &mdash; знаковая площадь всего многоугольника (т.е. <img class=tex src="../tex2png/cache/7d62efba07c40efc00e9b7b43d8b9d98.png" alt="S = \sum_{i=1}^{n} S_{z,p_i,p_{i+1}}">).<p><p><h2 style="padding-top:40px;">Трёхмерный случай: многогранники</h2><p>Аналогично двумерному случаю, в 3D можно говорить сразу о четырёх возможных постановках задачи:<p><ul><li>Центр масс системы точек &mdash; вершин многогранника.<li>Центр масс каркаса &mdash; рёбер многогранника.<li>Центр масс поверхности &mdash; т.е. масса распределена по площади поверхности многогранника.<li>Центр масс сплошного многогранника &mdash; т.е. масса распределена по всему многограннику.</ul><p><p><h3 style="padding-top:15px;">Центр масс системы точек</h3><p>Как и в двумерном случае, мы можем применить физическую формулу и получить тот же самый результат:<p><p class=formula><img class=tex src="../tex2png/cache/2286171b604a90e59b43dde1b104d8aa.png" alt=" \vec{r_c} = \frac{ \sum\limits_i \vec{r_i} ~ m_i [...]"></p><p>который в случае равных масс превращается в среднее арифметическое координат всех точек.<p><p><h3 style="padding-top:15px;">Центр масс каркаса многогранника</h3><p>Аналогично двумерному случаю, мы просто заменяем каждое ребро многогранника материальной точкой, расположенной посередине этого ребра, и с массой, равной длине этого ребра. Получив задачу о материальных точках, мы легко находим её решение как взвешенную сумму координат этих точек.<p><p><h3 style="padding-top:15px;">Центр масс поверхности многогранника</h3><p>Каждая грань поверхности многогранника &mdash; двухмерная фигура, центр масс которой мы умеем искать. Найдя эти центры масс и заменив каждую грань её центром масс, мы получим задачу с материальными точками, которую уже легко решить.<p><p><h3 style="padding-top:15px;">Центр масс сплошного многогранника</h3><p><h4>Случай тетраэдра</h4><p>Как и в двумерном случае, решим сначала простейшую задачу &mdash; задачу для тетраэдра.<p>Утверждается, что центр масс тетраэдра совпадает с точкой пересечения его медиан (медианой тетраэдра называется отрезок, проведённый из его вершины в центр масс противоположной грани; таким образом, медиана тетраэдра проходит через вершину и через точку пересечения медиан треугольной грани).<p>Почему это так? Здесь верны рассуждения, аналогичные двумерному случаю: если мы рассечём тетраэдр на два тетраэдра с помощью плоскости, проходящей через вершину тетраэдра и какую-нибудь медиану противоположной грани, то оба получившихся тетраэдра будут иметь одинаковый объём (т.к. треугольная грань разобьётся медианой на два треугольника равной площади, а высота двух тетраэдров не изменится). Повторяя эти рассуждения несколько раз, получаем, что центр масс лежит на точке пересечения медиан тетраэдра.<p>Эта точка &mdash; точка пересечения медиан тетраэдра &mdash; называется его <b>центроидом</b>. Можно показать, что она на самом деле имеет координаты, равные среднему арифметическому координат вершин тетраэдра:<p><p class=formula><img class=tex src="../tex2png/cache/3d0aa508a93a05ec34f6fb1110900d84.png" alt=" \vec{r_c} = \frac{ \vec{r_1} + \vec{r_2} + \vec{r[...]"></p><p>(это можно вывести из того факта, что центроид делит медианы в отношении <img class=tex src="../tex2png/cache/fbd09cd75df6530fffe16a27767e98ff.png" alt="1:3">)<p>Таким образом, между случаями тетраэдра и треугольника принципиальной разницы нет: точка, равная среднему арифметическому вершин, является центром масс сразу в двух постановках задачи: и когда массы находится только в вершинах, и когда массы распределены по всей площади/объёму. На самом деле, этот результат обобщается на произвольную размерность: центр масс произвольного <b>симплекса</b> (simplex) есть среднее арифметическое координат его вершин.<p><h4>Случай произвольного многогранника</h4><p>Перейдём теперь к общему случаю &mdash; случаю произвольного многогранника.<p>Снова, как и в двумерном случае, мы производим сведение этой задачи к уже решённой: разбиваем многогранник на тетраэдры (т.е. производим его тетраэдризацию), находим центр масс каждого из них, и получаем окончательный ответ на задачу в виде взвешенной суммы найденных центров масс.<p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>