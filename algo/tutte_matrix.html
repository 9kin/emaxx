<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Матрица Татта. Рандомизированный алгоритм для поиска максимального паросочетания в произвольном графе</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 16 Sep 2010 17:09<br>редактировано: 2 Nov 2012 18:32</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="tutte_matrix.html#" id="contents-hide">[скрыть]</a><a href="tutte_matrix.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1> Матрица Татта </h1><p>Матрица Татта &mdash; это изящный подход к решению задачи о <b>паросочетании</b> в произвольном (не обязательно двудольном) графе. Правда, в простом виде алгоритм не выдаёт сами рёбра, входящие в паросочетание, а только размер максимального паросочетания в графе.<p>Ниже мы сначала рассмотрим результат, полученный Таттом (Tutte) для проверки существования совершенного паросочетания (т.е. паросочетания, содержащего <img class=tex src="../tex2png/cache/48b1c5206b1d914c2ec894c9078c06ca.png" alt="n/2"> рёбер, и потому насыщающего все <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершин). После этого мы рассмотрим результат, полученный позже Ловасом (Lovasz), который уже позволяет искать размер максимального паросочетания, а не только ограничивается случаем совершенного паросочетания. Затем приводится результат Рабина (Rabin) и Вазирани (Vazirani), которые указали алгоритм восстановления самого паросочетания (как набора входящих в него рёбер).<p><p><h2 style="padding-top:40px;"> Определение </h2><p>Пусть дан граф <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершинами (<img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> &mdash; чётно).<p>Тогда <b>матрицей Татта</b> (Tutte) называется следующая матрица <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n">:<p><p class=formula><img class=tex src="../tex2png/cache/e1e558470a506ffeec7ca0e9e8200d55.png" alt=" \pmatrix{
0 & x_{12} & x_{13} & \ldots & x_{1(n-[...]"></p><p>где <img class=tex src="../tex2png/cache/1c086e59b1b753d8d335bdb3d1e2f5c7.png" alt="x_{ij}"> (<img class=tex src="../tex2png/cache/e5efd940138a73d2667794785080c5e0.png" alt="1 \le i < j \le n">) &mdash; это либо независимая переменная, соответствующая ребру между вершинами <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> и <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j">, либо тождественный ноль, если ребра между этими вершинами нет.<p>Таким образом, в случае полного графа с <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершинами матрица Татта содержит <img class=tex src="../tex2png/cache/3923232d8bb4b598284103ebb1aa816b.png" alt="n (n-1) / 2"> независимых переменных, если же в графе какие-то рёбра отсутствуют, то соответствующие элементы матрицы Татта превращаются в нули. Вообще, число переменных в матрице Татта совпадает с числом рёбер графа.<p>Матрица Татта антисимметрична (кососимметрична).<p><p><h2 style="padding-top:40px;"> Теорема Татта </h2><p>Рассмотрим определитель <img class=tex src="../tex2png/cache/fc989b6d69e0f9bbc5852c6301f7fc6e.png" alt="\det(A)"> матрицы Татта. Это, вообще говоря, многочлен относительно переменных <img class=tex src="../tex2png/cache/1c086e59b1b753d8d335bdb3d1e2f5c7.png" alt="x_{ij}">.<p><b>Теорема Татта</b> гласит: в графе <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> существует совершенное паросочетание тогда и только тогда, когда многочлен <img class=tex src="../tex2png/cache/fc989b6d69e0f9bbc5852c6301f7fc6e.png" alt="\det(A)"> не равен нулю тождественно (т.е. имеет хотя бы одно слагаемое с ненулевым коэффициентом). Напомним, что паросочетание называется совершенным, если оно насыщает все вершины, т.е. его мощность равна <img class=tex src="../tex2png/cache/48b1c5206b1d914c2ec894c9078c06ca.png" alt="n/2">.<p>Канадский математик Вильям Томас Татт (William Thomas Tutte) первым указал на тесную связь между паросочетаниями в графах и определителями матриц (1947 г.). Более простой вид этой связи позже обнаружил Эдмондс (Edmonds) в случае двудольных графов (1967 г.). Рандомизированные алгоритмы для нахождения величины максимального паросочетания и самих рёбер этого паросочетания были предложены позже, соответственно, Ловасом (Lovasz) (в 1979 г.), и Рабином (Rabin) и Вазирани (Vazirani) (в 1984 г.).<p><p><h3 style="padding-top:15px;"> Практическое применение: рандомизированный алгоритм </h3><p>Непосредственно применять теорему Татта даже в задаче проверки существования совершенного паросочетания нецелесообразно. Причиной этого является то, что при символьном вычислении определителя (т.е. в виде многочленов над переменными <img class=tex src="../tex2png/cache/1c086e59b1b753d8d335bdb3d1e2f5c7.png" alt="x_{ij}">) промежуточные результаты являются многочленами, содержащими <img class=tex src="../tex2png/cache/712c5a4a9bec3c435e92314194c99f95.png" alt="O(n^2)"> переменных. Поэтому вычисление определителя матрицы Татта в символьном виде потребует неоправданно много времени.<p>Венгерский математик Ласло Ловас (Laszlo Lovasz) был первым, указавшим возможность применения здесь <b>рандомизированного</b> алгоритма для упрощения вычислений.<p>Идея очень проста: заменим все переменные <img class=tex src="../tex2png/cache/1c086e59b1b753d8d335bdb3d1e2f5c7.png" alt="x_{ij}"> случайными числами:<p><p class=formula><img class=tex src="../tex2png/cache/b3b19cbd60801fa18b7e37c2822125f3.png" alt=" x_{ij} = {\rm rand}(). "></p><p>Тогда, если полином <img class=tex src="../tex2png/cache/fc989b6d69e0f9bbc5852c6301f7fc6e.png" alt="\det(A)"> был тождественно нулевым, после такой замены он и будет оставаться нулевым; если же он был отличным от нуля, то при такой случайной числовой замене вероятность того, что он обратится в ноль, достаточно мала.<p>Понятно, что такой тест (подстановка случайных значений и вычисление определителя <img class=tex src="../tex2png/cache/fc989b6d69e0f9bbc5852c6301f7fc6e.png" alt="\det(A)">) если и ошибается, то только в одну сторону: может сообщить об отсутствии совершенного паросочетания, когда на самом деле оно существует.<p>Мы можем повторить этот тест несколько раз, подставляя в качестве значений переменных новые случайные числа, и с каждым повторным запуском мы получаем всё большую уверенность в том, что тест выдал правильный ответ. На практике в большинстве случаев достаточно одного теста, чтобы определить, есть ли в графе совершенное паросочетание или нет; несколько таких тестов дают уже весьма высокую вероятность.<p>Для оценки <b>вероятности ошибки</b> можно использовать лемму Шварца-Зиппеля (Schwartz–Zippel), которая гласит, что вероятность обращения в ноль ненулевого полинома <img class=tex src="../tex2png/cache/bad23dd3e46f552bca69f71baf5d83f0.png" alt="P"> <img class=tex src="../tex2png/cache/252410059470b019db6fd4c3b844a348.png" alt="k">-ой степени при подстановке в качестве значений переменных случайных чисел, каждое из которых может принимать <img class=tex src="../tex2png/cache/342d607718e99ee38ba275df55ced44e.png" alt="s"> вариантов значения, &mdash; эта вероятность удовлетворяет неравенству:<p><p class=formula><img class=tex src="../tex2png/cache/c13f286410e9e7fcffcd96398f3e6c33.png" alt=" {\rm Pr}[P(r_1,\ldots,r_k)=0] \le \frac{k}{s}. "></p><p>Например, при использовании стандартной функции случайных чисел C++ <img class=tex src="../tex2png/cache/c43ed05d94b341f4dfefa96acf14d238.png" alt="\rm rand()"> получаем, что эта вероятность при <img class=tex src="../tex2png/cache/126bdca7d5d290c8a92cb186f039779d.png" alt="n=300"> составляет около процента.<p><b>Асимптотика</b> решения получается равной <img class=tex src="../tex2png/cache/5333bf52919bd2805f33a181851ebbf4.png" alt="O(n^3)"> (с использованием, например, <a href="determinant_gauss.html">алгоритма Гаусса</a>), умноженное на количество итераций теста. Стоит отметить, что по асимптотике такое решение значительно отстаёт от решения <a href="matching_edmonds.html">алгоритмом Эдмондса сжатия цветков</a>, однако в некоторых случаях более предпочтительно из-за простоты реализации.<p><b>Восстановить</b> само совершенное паросочетание как набор рёбер является более сложной задачей. Самым простым, хотя и медленным, вариантом будет восстановление этого паросочетания по одному ребру: перебираем первое ребро ответа, выбираем его так, чтобы в оставшемся графе существовало совершенное паросочетание, и т.д.<p><p><h3 style="padding-top:15px;"> Доказательство теоремы Татта </h3><p>Чтобы хорошо понять доказательство этой теоремы, сначала рассмотрим более простой результат, &mdash; полученный Эдмондсом для случая двудольных графов.<p><p><h4> Теорема Эдмондса </h4><p>Рассмотрим двудольный граф, в каждой доле которого по <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> вершин. Составим матрицу <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n">, в которой, по аналогии с матрицей Татта, <img class=tex src="../tex2png/cache/170d6fe5caf26a7db8ba756f9e2b4cd5.png" alt="b_{ij}"> является отдельной независимой переменной, если ребро <img class=tex src="../tex2png/cache/df9c3aa69e88ca097b0e7196d6b2dfed.png" alt="(i,j)"> присутствует в графе, и является тождественным нулём в противном случае.<p>Эта матрица похожа на матрицу Татта, однако матрица Эдмондса имеет вдвое меньшую разность, и каждому ребру здесь соответствует только одна ячейка матрицы.<p>Докажем следующую <b>теорему</b>: определитель <img class=tex src="../tex2png/cache/48e311da3820e7106f0223cbabf77011.png" alt="\det(B)"> отличен от нуля тогда и только тогда, когда в двудольном графе существует совершенное паросочетание.<p><b>Доказательство</b>. Распишем определитель согласно его определению, как сумма по всем перестановкам:<p><p class=formula><img class=tex src="../tex2png/cache/dc064e7cd4a3fb45b998041832f9e0af.png" alt=" \det(B) = \sum_{\pi \in S_n} {\rm sgn}(\pi) \cdot[...]"></p><p>Заметим, что поскольку все ненулевые элементы матрицы <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> &mdash; различные независимые переменные, то в этой сумме все ненулевые слагаемые различны, а потому никаких сокращений в процессе суммирования не происходит. Осталось заметить, что любое ненулевое слагаемое в этой сумме означает непересекающийся по вершинам набор рёбер, т.е. некоторое совершенное паросочетание. И наоборот, любому совершенному паросочетанию соответствует ненулевое слагаемое в этой сумме. Вкупе с вышесказанным это доказывает теорему.<p><p><h4> Свойства антисимметричных матриц </h4><p>Для доказательства теоремы Татта необходимо воспользоваться несколькими известными фактами линейной алгебры о свойствах антисимметричных матриц.<p><b>Во-первых</b>, если антисимметричная матрица имеет нечётный размер, то её определитель всегда равен нулю (теорема Якоби (Jacobi)). Для этого достаточно заметить, что антисимметричная матрица удовлетворяет равенству <img class=tex src="../tex2png/cache/302fd5345b6da0371fbf7724287e1002.png" alt="A^T = -A">, и теперь получаем цепочку равенств:<p><p class=formula><img class=tex src="../tex2png/cache/14e507a437fa7318033da1497ac6ca52.png" alt=" \det(A) = \det(A^T) = \det(-A) = (-1)^n \det(A), "></p><p>откуда и следует, что при нечётных <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> определитель необходимо должен быть равен нулю.<p><b>Во-вторых</b>, оказывается, что в случае антисимметричных матриц чётного размера их определитель всегда можно записать как квадрат некоторого полинома относительно переменных-элементов этой матрицы (полином называется пфаффианом (pfaffian), а результат принадлежит Мьюру (Muir)):<p><p class=formula><img class=tex src="../tex2png/cache/7a497b8160abc9cd19b6a953cb062975.png" alt=" \det(A) = {\rm Pf}^2(A). "></p><p><b>В-третьих</b>, этот пфаффиан представляет собой не произвольный многочлен, а сумму вида:<p><p class=formula><img class=tex src="../tex2png/cache/1902822863b64d150fabeae0cfeb05fc.png" alt=" {\rm Pf}(A) = \frac{ 1 }{ 2^n n! } \sum_{\pi \in [...]"></p><p>Таким образом, каждое слагаемое в пфаффиане &mdash; это произведение таких <img class=tex src="../tex2png/cache/48b1c5206b1d914c2ec894c9078c06ca.png" alt="n/2"> элементов матрицы, что их индексы в совокупности представляют собой разбиение множества <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n"> на <img class=tex src="../tex2png/cache/48b1c5206b1d914c2ec894c9078c06ca.png" alt="n/2"> пар. Перед каждым слагаемым имеется свой коэффициент, но его вид нас здесь не интересует.<p><p><h4> Доказательство теоремы Татта </h4><p>Воспользовавшись вторым и третьим свойством из предыдущего пункта, мы получаем, что определитель <img class=tex src="../tex2png/cache/fc989b6d69e0f9bbc5852c6301f7fc6e.png" alt="\det(A)"> матрицы Татта представляет собой квадрат от суммы слагаемых такого вида, что каждое слагаемое &mdash; произведение элементов матрицы, индексы которых не повторяются и покрывают все номера от <img class=tex src="../tex2png/cache/1737ac55fdbc871d8c7d14245b749ccd.png" alt="1"> до <img class=tex src="../tex2png/cache/8bc19c5640342f9c5ad0ba16baf59981.png" alt="n">. Таким образом, снова, как и в доказательстве теоремы Эдмондса, каждое ненулевое слагаемое этой суммы соответствует совершенному паросочетанию в графе, и наоборот.<p><p><h2 style="padding-top:40px;"> Теорема Ловаса: обобщение для поиска размера максимального паросочетания </h2><p><p><h3 style="padding-top:15px;"> Формулировка </h3><p><b>Ранг</b> матрицы Татта совпадает с удвоенной величиной <b>максимального паросочетания</b> в данном графе.<p><p><h3 style="padding-top:15px;"> Применение </h3><p>Для применения этой теоремы на практике можно воспользоваться тем же самым приёмом рандомизации, что и в вышеописанном алгоритме для матрицы Татта, а именно: подставить вместо переменных случайные значения, и найти ранг полученной числовой матрицы. Ранг матрицы, опять же, ищется за <img class=tex src="../tex2png/cache/ee6e2ce73ecd60d80d4fa8f04d0691e9.png" alt="O (n^3)"> с помощью модифицированного алгоритма Гаусса, см. <a href="matrix_rank.html">здесь</a>.<p>Впрочем, следует отметить, что приведённая выше лемма Шварца-Зиппеля неприменима в явном виде, и интуитивно кажется, что вероятность ошибки здесь становится выше. Однако утверждается (см. работы Ловаса (Lovasz)), что и здесь вероятность ошибки (т.е. того, что ранг полученной матрицы окажется меньше, чем удвоенный размер максимального паросочетания) не превосходит <img class=tex src="../tex2png/cache/1a71b883f4e52648a9c36172d6b1bf4f.png" alt="\frac{n}{s}"> (где <img class=tex src="../tex2png/cache/342d607718e99ee38ba275df55ced44e.png" alt="s">, как и выше, обозначает размер множества, из которого выбираются случайные числа).<p><p><h3 style="padding-top:15px;"> Доказательство </h3><p>Доказательство будет вытекать из теоремы линейной алгебры, известной как <b>теорема Фробениуса</b> (Frobenius). Пусть дана антисимметричная матрица <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> размера <img class=tex src="../tex2png/cache/0fc9328e33c84faad487e059a12d8e47.png" alt="n \times n">, и пусть множества <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> и <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T"> &mdash; любые два подмножества множества <img class=tex src="../tex2png/cache/13f29abc0e5ed9ec6b3d6e6d8f8971b1.png" alt="\{ 1, \ldots, n \}">, причём размеры этих множеств совпадают и равны рангу матрицы <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A">. Обозначим через <img class=tex src="../tex2png/cache/cf2f5279aa3d3b88cb6687f9a8ae714a.png" alt="A_{XY}"> матрицу, полученную из матрицы <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> только строками с номерами из множества <img class=tex src="../tex2png/cache/6c40947c41a939b41e0cfe6506c9e3c8.png" alt="X"> и столбцами с номерами из множества <img class=tex src="../tex2png/cache/2f103fbb20004cd7122d15d73c2acaf0.png" alt="Y"> (где <img class=tex src="../tex2png/cache/6c40947c41a939b41e0cfe6506c9e3c8.png" alt="X"> и <img class=tex src="../tex2png/cache/2f103fbb20004cd7122d15d73c2acaf0.png" alt="Y"> &mdash; некоторые подмножества множества <img class=tex src="../tex2png/cache/13f29abc0e5ed9ec6b3d6e6d8f8971b1.png" alt="\{ 1, \ldots, n \}">). Тогда выполняется:<p><p class=formula><img class=tex src="../tex2png/cache/27b929296c88a6bb74259f0e276d04b3.png" alt=" \det(A_{SS}) \cdot \det(A_{TT}) = \det(A_{ST}) \c[...]"></p><p>Покажем, как это свойство позволяет установить <b>соответствие</b> между рангом матрицы <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> Татта и величиной максимального паросочетания.<p>С одной стороны, рассмотрим в графе <img class=tex src="../tex2png/cache/4c5f3ba22ad1fd775e82380ae681dbdb.png" alt="G"> некоторое максимальное паросочетание, и обозначим множество насыщаемых им вершин через <img class=tex src="../tex2png/cache/8514055a7c7c69a4c367f8f3cc226d9a.png" alt="U">. Тогда, согласно теореме Татта, определитель <img class=tex src="../tex2png/cache/1f300e007d814c3897bbb927b1f76745.png" alt="\det(A_{UU})"> отличен от нуля. Следователь, ранг матрицы Татта &mdash; как минимум <img class=tex src="../tex2png/cache/b20dfe1a18272516de71a63a38e85cfd.png" alt="2|U|">, т.е. не меньше удвоенной величины максимального паросочетания.<p>Покажем теперь обратное неравенство. Обозначим ранг матрицы <img class=tex src="../tex2png/cache/b5f17df636a8bd667d2f5c3404ed82e7.png" alt="A"> через <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r">. Это означает, что нашлась такая подматрица <img class=tex src="../tex2png/cache/8c762cbdeeae06cc7a40cb8e02271161.png" alt="A_{ST}">, где <img class=tex src="../tex2png/cache/7b4bf398beb9be170aecf6cfde8180d1.png" alt="|S| = |T| = r">, определитель которой отличен от нуля. Легко заметить, что <img class=tex src="../tex2png/cache/fd47531795029669db8a267b01282136.png" alt="A_{TS}"> также будет отлично от нуля. Но по приведённой выше теореме Фробениуса это означает, что обе матрицы <img class=tex src="../tex2png/cache/c62d9e2528bdcb07efeb7e71b4763979.png" alt="A_{SS}"> и <img class=tex src="../tex2png/cache/685552bd3e2c62e83ed09302a6002fd6.png" alt="A_{TT}"> имеют ненулевой определитель. Отсюда следует, что <img class=tex src="../tex2png/cache/d51b82f01bc38fe0d2e4a69ebec7c641.png" alt="r"> чётно (потому что, как было отмечено выше, антисимметричная матрица нечётной размерности всегда имеет нулевой определитель). Таким образом, мы можем применить к подматрице <img class=tex src="../tex2png/cache/c62d9e2528bdcb07efeb7e71b4763979.png" alt="A_{SS}"> (или <img class=tex src="../tex2png/cache/685552bd3e2c62e83ed09302a6002fd6.png" alt="A_{TT}">) теорему Татта. Следовательно, в подграфе, индуцированном множеством вершин <img class=tex src="../tex2png/cache/7af761eb0d1f3ce7b5a85ce3d8902662.png" alt="S"> (или множеством вершин <img class=tex src="../tex2png/cache/0e738dc1c640233f2c460e261c522f78.png" alt="T">), имеется совершенное паросочетание (и величина его равна <img class=tex src="../tex2png/cache/3ab49d0a75899c77319a09d1c72e4c26.png" alt="r/2">). Таким образом, ранг матрицы Татта не может быть больше удвоенной величины максимального паросочетания.<p>Объединяя два доказанных неравенства, мы получаем утверждение теоремы: ранг матрицы Татта совпадает с удвоенной величиной максимального паросочетания.<p><p><h2 style="padding-top:40px;"> Алгоритм Рабина-Вазирани нахождения максимального паросочетания </h2><p>Этот алгоритм является дальнейшим обобщением двух предыдущих теорем, и позволяет, в отличие от них, выдавать не только величину максимального паросочетания, но и сами рёбра, входящие в него.<p><p><h3 style="padding-top:15px;"> Формулировка теоремы </h3><p>Пусть в графе существует совершенное паросочетание. Тогда его матрица Татта невырождена, т.е. <img class=tex src="../tex2png/cache/6cf0ee6ad7ff0877619d95368e716014.png" alt="\det(A) \ne 0">. Сгенерируем по ней, как было описано выше, случайную числовую матрицу <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">. Тогда, с высокой вероятностью, <img class=tex src="../tex2png/cache/bdddc509fb61b364dcf38dcb8b0d2c09.png" alt="(B^{-1})_{ji} \ne 0"> тогда и только тогда, когда ребро <img class=tex src="../tex2png/cache/df9c3aa69e88ca097b0e7196d6b2dfed.png" alt="(i,j)"> входит в какое-либо совершенное паросочетание.<p>(Здесь через <img class=tex src="../tex2png/cache/cc1d58dec29de8e89d8a16d3f79361f5.png" alt="B^{-1}"> обозначена матрица, обратная к <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B">. Предполагается, что определитель матрицы <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> отличен от нуля, поэтому обратная матрица существует.)<p><p><h3 style="padding-top:15px;"> Применение </h3><p>Эту теорему можно применять для восстановления самих рёбер максимального паросочетания. Сначала придётся выделить подграф, в котором содержится искомое максимальное паросочетание (это можно сделать параллельно с алгоритмом поиска ранга матрицы).<p>После этого задача сводится к поиску совершенного паросочетания по данной числовой матрице, полученной из матрицы Татта. Здесь мы уже применяем теорему Рабина-Вазирани, &mdash; находим обратную матрицу (что можно сделать модифицированным алгоритмом Гаусса за <img class=tex src="../tex2png/cache/ee6e2ce73ecd60d80d4fa8f04d0691e9.png" alt="O (n^3)">), находим в ней любой ненулевой элемент, удаляем из графа, и повторяем процесс. Асимптотика такого решения будет не самой быстрой &mdash; <img class=tex src="../tex2png/cache/e1ee0b092b56f3dd3c347a13cdeabaed.png" alt="O (n^4)">, зато взамен получаем простоту решения (по сравнению, например, с <a href="matching_edmonds.html">алгоритмом Эдмондса сжатия цветков</a>).<p><p><h3 style="padding-top:15px;"> Доказательство теоремы </h3><p>Вспомним известную формулу для элементов обратной матрицы <img class=tex src="../tex2png/cache/cc1d58dec29de8e89d8a16d3f79361f5.png" alt="B^{-1}">:<p><p class=formula><img class=tex src="../tex2png/cache/e0769b9e3663dbd6e9cb7276ccc5e472.png" alt=" (B^{-1})_{ji} = \frac{ {\rm adj}(B)_{i,j} }{ \det[...]"></p><p>где через <img class=tex src="../tex2png/cache/a76a18afe139fecf1d1e41eb747290ed.png" alt="{\rm adj}(B)_{i,j}"> обозначено алгебраическое дополнение, т.е. это число <img class=tex src="../tex2png/cache/9d29380d318449416c2be03ed941bc4b.png" alt="(-1)^{i+j}">, умноженное на определитель матрицы, получаемой из <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> удалением <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-й строки и <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j">-го столбца.<p>Отсюда сразу получаем, что элемент <img class=tex src="../tex2png/cache/3dcb9e9258822520325bcb31411b7d54.png" alt="(B^{-1})_{ji}"> отличен от нуля тогда и только тогда, когда матрица <img class=tex src="../tex2png/cache/fb8234db4e6ea317a7c2aef7a38775ba.png" alt="B"> с вычеркнутыми <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i">-ой строкой и <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j">-ым столбцом имеет ненулевой определитель, что, применяя теорему Татта, означает с высокой вероятностью, что в графе без вершин <img class=tex src="../tex2png/cache/2d9d1096e116db33bc39a0accf4e9ef7.png" alt="i"> и <img class=tex src="../tex2png/cache/f2761432c5377ee4ded848884be6d407.png" alt="j"> по-прежнему существует совершенное паросочетание.<p><p><h2 style="padding-top:40px;"> Литература </h2><p><ul><li><a href="../bookz/files/tutte.pdf">William Thomas Tutte. <b>The Factorization of Linear Graphs</b> [1946]</a><li>Laszlo Lovasz. <b>On Determinants, Matchings and Random Algorithms</b> [1979]<li><a href="../bookz/files/lovasz_plummer.pdf">Laszlo Lovasz, M.D. Plummer. <b>Matching Theory</b> [1986]</a><li>Michael Oser Rabin, Vijay V. Vazirani. <b>Maximum matchings in general graphs through randomization</b> [1989]<li><a href="../bookz/files/tucker.pdf">Allen B. Tucker. <b>Computer Science Handbook</b> [2004]</a><li><a href="../bookz/files/motwani.djvu">Rajeev Motwani, Prabhakar Raghavan. <b>Randomized Algorithms</b> [1995]</a><li><a href="../bookz/files/aitken.pdf">A.C. Aitken. <b>Determinants and matrices</b> [1944]</a></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>