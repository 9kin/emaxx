<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>MAXimal :: algo :: Игра Пятнашки: существование решения</title><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta name="author" lang="ru" content="e-maxx" /><meta name="description" content="Алгоритмы, олимпиадное программирование, математика" /><meta name="keywords" content="алгоритмы программирование" /><meta name="google-site-verification" content="Pnjjj2XuxB0CTiqgDDvkp79bfSeDQ8Vw57iNeDJZkSc" /><link rel="stylesheet" type="text/css" href="../data/style.css"><script type="text/javascript" src="../data/jquery.js"></script><script type="text/javascript" src="../data/page-contents.js"></script><link rel="stylesheet" type="text/css" href="../geshi/geshi.css"><!--[if IE]><style>.menu a, .menu a:hover { width: 100%; }</style><![endif]--></head><body><table class=main cellpadding=0 cellspacing=0><tr><td class=title colspan=2><p>MAXimal</p></td></tr><tr><td class=menu><ul><li><a href="../index.php.html" >home</a></li><li><a href="index.html" class=current>algo</a></li><li><a href="../bookz/index.html" >bookz</a></li><li><a href="../forum/index.html" >forum</a></li><li><a href="../about.php.html" >about</a></li></ul></td><td class=content><p class=algoinfo>добавлено: 11 Jun 2008 11:27<br>редактировано: 27 Dec 2008 16:39</p><div id="contents-table"><p id="contents-table-title">Содержание <a href="15_puzzle.html#" id="contents-hide">[скрыть]</a><a href="15_puzzle.html#" id="contents-show" style="display:none">[показать]</a></p><div style="display:none"></div></div><h1>Игра Пятнашки: существование решения</h1><p>Напомним, что игра представляет собой поле <img class=tex src="../tex2png/cache/540ccd7efd169a4313503b565bb0ce55.png" alt="4"> на <img class=tex src="../tex2png/cache/540ccd7efd169a4313503b565bb0ce55.png" alt="4">, на котором расположены <img class=tex src="../tex2png/cache/99fc1bbba634f15a20499582d8ef86fc.png" alt="15"> фишек, пронумерованных числами от <img class=tex src="../tex2png/cache/1737ac55fdbc871d8c7d14245b749ccd.png" alt="1"> до <img class=tex src="../tex2png/cache/99fc1bbba634f15a20499582d8ef86fc.png" alt="15">, а одно поле оставлено пустым. Требуется, передвигая на каждом шаге какую-либо фишку на свободную позицию, прийти в конце концов к следующей позиции:<p class=formula><img class=tex src="../tex2png/cache/a20a65d11dd5382b08465279d9bef0ca.png" alt=" \matrix{
1&2&3&4\cr
5&6&7&8\cr
9&10&11&12\cr
[...]"></p><p>Игру Пятнашки ("15 puzzle") изобрёл в 1880 г. Нойес Чэпман (Noyes Chapman).<p><h2 style="padding-top:40px;">Существование решения</h2><p>Здесь мы рассмотрим такую задачу: по данной позиции на доске сказать, существует ли последовательность ходов, приводящая к решению, или нет.<p>Пусть дана некоторая позиция на доске:<p><p class=formula><img class=tex src="../tex2png/cache/4bce648a6f89c9fc25289fa27fd7a107.png" alt=" \matrix{
a_1 & a_2 & a_3 & a_4 \cr 
a_5 & a_6 &[...]"></p>где один из элементов равен нулю и обозначает пустую клетку <img class=tex src="../tex2png/cache/628115cecad82adaf8a1423805f7e7bd.png" alt="a_z = 0">.<p>Рассмотрим перестановку:<p class=formula><img class=tex src="../tex2png/cache/37db640bfba4e1e8372e3098c8e0b1f1.png" alt=" a_1 a_2 \ldots a_{z-1} a_{z+1} \ldots a_{15} a_{1[...]"></p>(т.е. перестановка чисел, соответствующая позиции на доске, без нулевого элемента)<p>Обозначим через <img class=tex src="../tex2png/cache/e443c86ec0d26264771c7414985f9d24.png" alt="N"> количество инверсий в этой перестановке (т.е. количество таких элементов <img class=tex src="../tex2png/cache/ef875bf5bad8370d4f3bbe3c740d3dd3.png" alt="a_i"> и <img class=tex src="../tex2png/cache/987cc424e4f10b57f3070514c4314772.png" alt="a_j">, что <img class=tex src="../tex2png/cache/03d9ee6ff5dbf9f4d71c1efe94e10f6b.png" alt="i < j">, но <img class=tex src="../tex2png/cache/bf5a105037cfbcd4b28b799edd905cbb.png" alt="a_i > a_j">).<p>Далее, пусть <img class=tex src="../tex2png/cache/038649a055a585f6d85eab385e51429f.png" alt="K"> &mdash; номер строки, в которой находится пустой элемент (т.е. в наших обозначениях <img class=tex src="../tex2png/cache/7c3e3bb8b9e4c9779c39f9520eaa8c73.png" alt="K = (z-1)\ {\rm div}\ 4 + 1)">.<p>Тогда, <b>решение существует тогда и только тогда, когда <img class=tex src="../tex2png/cache/01dbdf37128b593c6b9896bd8bc566f2.png" alt="N+K"> чётно</b>.<p><h2 style="padding-top:40px;">Реализация</h2><p>Проиллюстрируем указанный выше алгоритм с помощью программного кода:<pre class="notranslate cpp"><span class="kw4">int</span> a<span class="br0">&#91;</span><span class="nu0">16</span><span class="br0">&#93;</span><span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;</span><span class="nu0">16</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	<span class="kw3">cin</span> <span class="sy1">&gt;&gt;</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">int</span> inv <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;</span><span class="nu0">16</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>
		<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> j<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> j<span class="sy1">&lt;</span>i<span class="sy4">;</span> <span class="sy2">++</span>j<span class="br0">&#41;</span>
			<span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy1">&gt;</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>
				<span class="sy2">++</span>inv<span class="sy4">;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> i<span class="sy1">=</span><span class="nu0">0</span><span class="sy4">;</span> i<span class="sy1">&lt;</span><span class="nu0">16</span><span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">&#41;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>
		inv <span class="sy2">+</span><span class="sy1">=</span> <span class="nu0">1</span> <span class="sy2">+</span> i <span class="sy2">/</span> <span class="nu0">4</span><span class="sy4">;</span>
&nbsp;
<span class="kw3">puts</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>inv <span class="sy3">&amp;</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy4">?</span> <span class="st0">&quot;No Solution&quot;</span> <span class="sy4">:</span> <span class="st0">&quot;Solution Exists&quot;</span><span class="br0">&#41;</span><span class="sy4">;</span></pre><p><h2 style="padding-top:40px;">Доказательство</h2>Джонсон (Johnson) в 1879 г. доказал, что если <img class=tex src="../tex2png/cache/01dbdf37128b593c6b9896bd8bc566f2.png" alt="N+K"> нечётно, то решения не существует, а Стори (Story) в том же году доказал, что все позиции, для которых <img class=tex src="../tex2png/cache/01dbdf37128b593c6b9896bd8bc566f2.png" alt="N+K"> чётно, имеют решение.<p>Однако оба эти доказательства были достаточно сложны.<p>В 1999 г. Арчер (Archer) предложил значительно более простое доказательство (скачать его статью можно <a href="http://www.cs.cmu.edu/afs/cs/academic/class/15859-f01/www/notes/15-puzzle.pdf">здесь</a>).<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr><p>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'e-maxx';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script></td></tr></table></body></html>